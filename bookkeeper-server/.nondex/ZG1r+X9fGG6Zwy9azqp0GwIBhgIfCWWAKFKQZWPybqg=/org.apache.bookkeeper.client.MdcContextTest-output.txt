18:13:45.948 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:46.415 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie2972692667108331678test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:46.802 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie2030432426221729958test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:47.102 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie9069388711185911329test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:47.389 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:48.196 [bookkeeper-io-37-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:43923 [id: 0x1a8de57c, L:/127.0.0.1:36026 - R:127.0.0.1/127.0.0.1:43923]
18:13:48.196 [bookkeeper-io-37-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:39901 [id: 0xf035923a, L:/127.0.0.1:47034 - R:127.0.0.1/127.0.0.1:39901]
18:13:48.204 [bookie-io-17-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:48.205 [bookie-io-8-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:48.205 [bookie-io-8-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x317d2cf4, L:/127.0.0.1:42939 - R:/127.0.0.1:44868]
18:13:48.191 [bookkeeper-io-37-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:42939 [id: 0x12a3d2e0, L:/127.0.0.1:44868 - R:127.0.0.1/127.0.0.1:42939]
18:13:48.207 [bookie-io-17-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x371792f6, L:/127.0.0.1:43923 - R:/127.0.0.1:36026]
18:13:48.215 [bookie-io-26-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:48.218 [bookie-io-26-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x05b404f4, L:/127.0.0.1:39901 - R:/127.0.0.1:47034]
18:13:48.224 [bookkeeper-io-37-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x1a8de57c, L:/127.0.0.1:36026 - R:127.0.0.1/127.0.0.1:43923] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:48.225 [bookkeeper-io-37-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x12a3d2e0, L:/127.0.0.1:44868 - R:127.0.0.1/127.0.0.1:42939] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:48.225 [bookkeeper-io-37-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xf035923a, L:/127.0.0.1:47034 - R:127.0.0.1/127.0.0.1:39901] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:48.250 [bookie-io-17-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:48.250 [bookie-io-26-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:48.251 [bookie-io-8-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:48.253 [bookie-io-8-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie2972692667108331678test/current/0.log for logId 0.
18:13:48.255 [bookie-io-26-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie9069388711185911329test/current/0.log for logId 0.
18:13:48.257 [bookie-io-17-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie2030432426221729958test/current/0.log for logId 0.
18:13:48.302 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:42939
18:13:48.306 [bookkeeper-io-37-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x12a3d2e0, L:/127.0.0.1:44868 ! R:127.0.0.1/127.0.0.1:42939]
18:13:48.306 [bookie-io-8-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x317d2cf4, L:/127.0.0.1:42939 ! R:/127.0.0.1:44868]
18:13:48.307 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:39901
18:13:48.307 [bookkeeper-io-37-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xf035923a, L:/127.0.0.1:47034 ! R:127.0.0.1/127.0.0.1:39901]
18:13:48.308 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:43923
18:13:48.308 [bookie-io-26-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x05b404f4, L:/127.0.0.1:39901 ! R:/127.0.0.1:47034]
18:13:48.309 [bookkeeper-io-37-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x1a8de57c, L:/127.0.0.1:36026 ! R:127.0.0.1/127.0.0.1:43923]
18:13:48.309 [bookie-io-17-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x371792f6, L:/127.0.0.1:43923 ! R:/127.0.0.1:36026]
18:13:48.326 [Time-limited test-SendThread(localhost:35727)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b90baf0005.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b90baf0005, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:48.428 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b90baf0005 closed
18:13:48.428 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b90baf0005
18:13:48.429 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
18:13:48.434 [Time-limited test-SendThread(localhost:35727)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b90baf0001.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b90baf0001, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:48.535 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b90baf0001 closed
18:13:48.535 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b90baf0001
18:13:48.535 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:48.535 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:48.539 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-42939 with exitCode 0
18:13:48.540 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:48.540 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:48.552 [SyncThread-13-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635894826493 , logFileOffset - 1536]}.
18:13:48.561 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:48.561 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:48.561 [BookieJournal-42939] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:48.561 [BookieJournal-42939] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:48.562 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:48.562 [Bookie-42939] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:48.562 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:48.562 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:48.562 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:48.562 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:48.562 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:48.563 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:48.564 [pool-12-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-12-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:48.570 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:48.570 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:48.673 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b90baf0002 closed
18:13:48.673 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b90baf0002
18:13:48.673 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:48.673 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:48.677 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-43923 with exitCode 0
18:13:48.677 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:48.677 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:48.688 [SyncThread-22-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635894826818 , logFileOffset - 1536]}.
18:13:48.697 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:48.697 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:48.698 [BookieJournal-43923] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:48.698 [BookieJournal-43923] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:48.698 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:48.698 [Bookie-43923] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:48.698 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:48.698 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:48.698 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:48.698 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:48.698 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:48.699 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:48.702 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:48.702 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:48.702 [pool-18-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-18-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:48.807 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b90baf0003
18:13:48.807 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b90baf0003 closed
18:13:48.808 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:48.808 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:48.809 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-39901 with exitCode 0
18:13:48.809 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:48.809 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:48.821 [SyncThread-31-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635894827118 , logFileOffset - 1024]}.
18:13:48.828 [BookieDeathWatcher-43923] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:48.828 [BookieDeathWatcher-43923] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-43923
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:48.828 [BookieDeathWatcher-43923] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:48.828 [BookieDeathWatcher-43923] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:48.830 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:48.830 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:48.830 [BookieJournal-39901] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:48.830 [BookieJournal-39901] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:48.830 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:48.831 [Bookie-39901] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:48.831 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:48.831 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:48.831 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:48.831 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:48.831 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:48.832 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:48.833 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:48.833 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:48.834 [pool-24-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-24-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:48.839 [Time-limited test-SendThread(localhost:35727)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b90baf0004.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b90baf0004, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:48.939 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b90baf0004 closed
18:13:48.940 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b90baf0004
18:13:49.042 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b90baf0000 closed
18:13:49.043 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
18:13:49.043 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b90baf0000
18:13:49.043 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
18:13:49.043 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
18:13:49.044 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
18:13:49.045 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
18:13:49.045 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
18:13:49.045 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
18:13:49.045 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
18:13:49.045 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
18:13:49.045 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
18:13:49.045 [ProcessThread(sid:0 cport:35727):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
18:13:49.046 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
18:13:49.046 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
18:13:49.048 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 35727
18:13:49.063 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testSimpleAdd in 633 ms.
18:13:49.065 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
18:13:49.077 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
18:13:49.077 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
18:13:49.077 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
18:13:49.078 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
18:13:49.079 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
18:13:49.079 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
18:13:49.079 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
18:13:49.079 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
18:13:49.080 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
18:13:49.080 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
18:13:49.080 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
18:13:49.081 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
18:13:49.081 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
18:13:49.081 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
18:13:49.081 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
18:13:49.082 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
18:13:49.082 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
18:13:49.084 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper6884227284128502672test/version-2 snapdir /tmp/zookeeper6884227284128502672test/version-2
18:13:49.084 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
18:13:49.084 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
18:13:49.084 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
18:13:49.090 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper6884227284128502672test/version-2/snapshot.0
18:13:49.091 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 1 ms, highest zxid is 0x0, digest is 1371985504
18:13:49.091 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper6884227284128502672test/version-2/snapshot.0
18:13:49.092 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 1 ms
18:13:49.094 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 37583
18:13:49.096 [ProcessThread(sid:0 cport:37583):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
18:13:49.097 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:55854
18:13:49.097 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
18:13:49.098 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:37583 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@77d0d166
18:13:49.098 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:49.098 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:49.103 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:37583.
18:13:49.103 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:49.104 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:55856, server: localhost/127.0.0.1:37583
18:13:49.105 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
18:13:49.108 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:37583, session id = 0x10000b9190b0000, negotiated timeout = 10000
18:13:49.108 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:49.118 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37583/ledgers : zkServers = localhost:37583, ledgersRootPath = /ledgers.
18:13:49.118 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:37583 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@1aac705c
18:13:49.118 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:49.118 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:49.121 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:37583.
18:13:49.121 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:49.121 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:55858, server: localhost/127.0.0.1:37583
18:13:49.125 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:37583, session id = 0x10000b9190b0001, negotiated timeout = 10000
18:13:49.125 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:49.127 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:49.127 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
18:13:49.128 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
18:13:49.128 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
18:13:49.134 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:49.135 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "diskUsageWarnThreshold" : "0.99",
  "gcWaitTime" : "1000",
  "numReadWorkerThreads" : "0",
  "metadataServiceUri" : "zk://localhost:37583/ledgers",
  "ledgerDirectories" : "/tmp/bookie8710690032301239327test",
  "listeningInterface" : "lo",
  "allowLoopback" : "true",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "numAddWorkerThreads" : "0",
  "preserveMdcForTaskExecution" : "true",
  "entryLogFilePreallocationEnabled" : "false",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "enableTaskExecutionStats" : "true",
  "journalFlushWhenQueueEmpty" : "true",
  "allowEphemeralPorts" : "true",
  "journalDirectories" : "/tmp/bookie8710690032301239327test",
  "bookiePort" : "0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "readOnlyModeEnabled" : "true",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "diskUsageThreshold" : "0.999",
  "journalFormatVersionToWrite" : "5"
}
18:13:49.136 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:49.138 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37583/ledgers : zkServers = localhost:37583, ledgersRootPath = /ledgers.
18:13:49.138 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:37583 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@3dec82
18:13:49.138 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:49.138 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:49.140 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:37583.
18:13:49.140 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:49.141 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:55860, server: localhost/127.0.0.1:37583
18:13:49.144 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:37583, session id = 0x10000b9190b0002, negotiated timeout = 10000
18:13:49.145 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:49.149 [BookieDeathWatcher-39901] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:49.149 [BookieDeathWatcher-39901] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-39901
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:49.149 [BookieDeathWatcher-39901] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:49.149 [BookieDeathWatcher-39901] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:49.149 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:49.155 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie8710690032301239327test/current] [/tmp/bookie8710690032301239327test/current]
18:13:49.162 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:49.163 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie8710690032301239327test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:49.163 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:49.164 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:49.164 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:49.165 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:49.165 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:49.165 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:49.173 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:33221 to become writable
18:13:49.175 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:49.175 [SyncThread-52-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:49.177 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:49.177 [BookieJournal-33221] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie8710690032301239327test/current
18:13:49.178 [BookieJournal-33221] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie8710690032301239327test/current/17ce2ee207b.txn
18:13:49.178 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:49.190 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:33221 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:33221, port=33221, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:49.191 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:33221
18:13:49.436 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:33221' has been created.
18:13:49.438 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:49.438 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "gcWaitTime" : "1000",
  "preserveMdcForTaskExecution" : "true",
  "readOnlyModeEnabled" : "true",
  "allowEphemeralPorts" : "true",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "journalFlushWhenQueueEmpty" : "true",
  "journalFormatVersionToWrite" : "5",
  "numReadWorkerThreads" : "0",
  "enableTaskExecutionStats" : "true",
  "numAddWorkerThreads" : "0",
  "diskUsageThreshold" : "0.999",
  "entryLogFilePreallocationEnabled" : "false",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "diskUsageWarnThreshold" : "0.99",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "ledgerDirectories" : "/tmp/bookie93346803654784036test",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "allowLoopback" : "true",
  "journalDirectories" : "/tmp/bookie93346803654784036test",
  "bookiePort" : "0",
  "metadataServiceUri" : "zk://localhost:37583/ledgers",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo"
}
18:13:49.440 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:49.441 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37583/ledgers : zkServers = localhost:37583, ledgersRootPath = /ledgers.
18:13:49.441 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:37583 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@11b455a9
18:13:49.441 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:49.441 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:49.448 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:37583.
18:13:49.448 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:49.449 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:55862, server: localhost/127.0.0.1:37583
18:13:49.450 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:37583, session id = 0x10000b9190b0003, negotiated timeout = 10000
18:13:49.451 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:49.453 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:49.460 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie93346803654784036test/current] [/tmp/bookie93346803654784036test/current]
18:13:49.464 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:49.464 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie93346803654784036test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:49.465 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:49.465 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:49.465 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:49.466 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:49.466 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:49.466 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:49.470 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:45567 to become writable
18:13:49.470 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:49.471 [SyncThread-61-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:49.472 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:49.477 [BookieJournal-45567] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie93346803654784036test/current
18:13:49.478 [BookieJournal-45567] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie93346803654784036test/current/17ce2ee21a7.txn
18:13:49.480 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:49.486 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:45567 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:45567, port=45567, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:49.489 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:45567
18:13:49.521 [BookieDeathWatcher-42939] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:49.521 [BookieDeathWatcher-42939] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-42939
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:49.521 [BookieDeathWatcher-42939] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:49.521 [BookieDeathWatcher-42939] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:49.737 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:45567' has been created.
18:13:49.738 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:49.739 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageWarnThreshold" : "0.99",
  "numAddWorkerThreads" : "0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "enableTaskExecutionStats" : "true",
  "bookiePort" : "0",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "gcWaitTime" : "1000",
  "journalFlushWhenQueueEmpty" : "true",
  "numReadWorkerThreads" : "0",
  "allowLoopback" : "true",
  "diskUsageThreshold" : "0.999",
  "readOnlyModeEnabled" : "true",
  "ledgerDirectories" : "/tmp/bookie4439193924772105214test",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "metadataServiceUri" : "zk://localhost:37583/ledgers",
  "journalDirectories" : "/tmp/bookie4439193924772105214test",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "listeningInterface" : "lo",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "preserveMdcForTaskExecution" : "true"
}
18:13:49.740 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:49.742 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37583/ledgers : zkServers = localhost:37583, ledgersRootPath = /ledgers.
18:13:49.742 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:37583 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@11c7e302
18:13:49.743 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:49.743 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:49.745 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:37583.
18:13:49.745 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:49.749 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:55864, server: localhost/127.0.0.1:37583
18:13:49.754 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:37583, session id = 0x10000b9190b0004, negotiated timeout = 10000
18:13:49.755 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:49.757 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:49.762 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie4439193924772105214test/current] [/tmp/bookie4439193924772105214test/current]
18:13:49.767 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:49.768 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie4439193924772105214test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:49.768 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:49.769 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:49.769 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:49.769 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:49.770 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:49.770 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:49.786 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:43121 to become writable
18:13:49.788 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 1 ms.
18:13:49.788 [SyncThread-70-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:49.790 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:49.790 [BookieJournal-43121] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie4439193924772105214test/current
18:13:49.791 [BookieJournal-43121] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie4439193924772105214test/current/17ce2ee22e0.txn
18:13:49.792 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:49.800 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:43121 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:43121, port=43121, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:49.801 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:43121
18:13:50.052 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:43121' has been created.
18:13:50.053 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testAddWithEnsembleChange @ metadata service zk://localhost:37583/ledgers in 976 ms.
18:13:50.055 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37583/ledgers : zkServers = localhost:37583, ledgersRootPath = /ledgers.
18:13:50.055 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:37583 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@55db1be
18:13:50.055 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:50.055 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:50.056 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:37583.
18:13:50.056 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:50.056 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:55866, server: localhost/127.0.0.1:37583
18:13:50.059 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:37583, session id = 0x10000b9190b0005, negotiated timeout = 10000
18:13:50.059 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:50.061 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:50.061 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
18:13:50.061 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
18:13:50.062 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
18:13:50.066 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:43121 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:43121, port=43121, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:50.067 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:45567 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:45567, port=45567, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:50.067 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:33221 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:33221, port=33221, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:50.067 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:43121
18:13:50.067 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:45567
18:13:50.067 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:33221
18:13:50.073 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
18:13:50.073 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:43121, 127.0.0.1:33221, 127.0.0.1:45567] is not adhering to Placement Policy. quarantinedBookies: []
18:13:50.085 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:43121, 127.0.0.1:33221, 127.0.0.1:45567] for ledger: 0
18:13:50.098 [bookkeeper-io-76-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:43121 [id: 0xd222002b, L:/127.0.0.1:32900 - R:127.0.0.1/127.0.0.1:43121]
18:13:50.101 [bookkeeper-io-76-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xd222002b, L:/127.0.0.1:32900 - R:127.0.0.1/127.0.0.1:43121] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:50.105 [bookie-io-65-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:50.109 [bookie-io-65-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x34c1956b, L:/127.0.0.1:43121 - R:/127.0.0.1:32900]
18:13:50.113 [bookkeeper-io-76-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:33221 [id: 0x42740ce7, L:/127.0.0.1:33000 - R:127.0.0.1/127.0.0.1:33221]
18:13:50.113 [bookie-io-65-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:50.113 [bookkeeper-io-76-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x42740ce7, L:/127.0.0.1:33000 - R:127.0.0.1/127.0.0.1:33221] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:50.120 [bookie-io-65-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie4439193924772105214test/current/0.log for logId 0.
18:13:50.125 [bookie-io-47-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:50.125 [bookie-io-56-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:50.125 [bookkeeper-io-76-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:45567 [id: 0xd079ce41, L:/127.0.0.1:35378 - R:127.0.0.1/127.0.0.1:45567]
18:13:50.126 [bookie-io-47-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x886eb27f, L:/127.0.0.1:33221 - R:/127.0.0.1:33000]
18:13:50.127 [bookie-io-56-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x3b4efdae, L:/127.0.0.1:45567 - R:/127.0.0.1:35378]
18:13:50.127 [bookie-io-47-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:50.131 [bookie-io-47-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie8710690032301239327test/current/0.log for logId 0.
18:13:50.133 [bookkeeper-io-76-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xd079ce41, L:/127.0.0.1:35378 - R:127.0.0.1/127.0.0.1:45567] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:50.135 [bookie-io-56-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:50.142 [bookie-io-56-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie93346803654784036test/current/0.log for logId 0.
18:13:50.154 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:50.155 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "numAddWorkerThreads" : "0",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "numReadWorkerThreads" : "0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "enableTaskExecutionStats" : "true",
  "allowLoopback" : "true",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "listeningInterface" : "lo",
  "journalFlushWhenQueueEmpty" : "true",
  "readOnlyModeEnabled" : "true",
  "allowEphemeralPorts" : "true",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "gcWaitTime" : "1000",
  "diskUsageWarnThreshold" : "0.99",
  "metadataServiceUri" : "zk://localhost:37583/ledgers",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "preserveMdcForTaskExecution" : "true",
  "entryLogFilePreallocationEnabled" : "false",
  "diskUsageThreshold" : "0.999",
  "journalFormatVersionToWrite" : "5",
  "ledgerDirectories" : "/tmp/bookie8660690387201969061test",
  "journalDirectories" : "/tmp/bookie8660690387201969061test"
}
18:13:50.157 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:50.158 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37583/ledgers : zkServers = localhost:37583, ledgersRootPath = /ledgers.
18:13:50.159 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:37583 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@74a043d5
18:13:50.159 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:50.160 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:50.163 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:37583.
18:13:50.164 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:50.164 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:55874, server: localhost/127.0.0.1:37583
18:13:50.166 [Time-limited test-SendThread(localhost:37583)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:37583, session id = 0x10000b9190b0006, negotiated timeout = 10000
18:13:50.166 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:50.169 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:50.177 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie8660690387201969061test/current] [/tmp/bookie8660690387201969061test/current]
18:13:50.182 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:50.183 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie8660690387201969061test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:50.183 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:50.184 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:50.184 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:50.185 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:50.185 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:50.186 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:50.201 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:46653 to become writable
18:13:50.202 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:50.203 [SyncThread-85-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:50.206 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:50.206 [BookieJournal-46653] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie8660690387201969061test/current
18:13:50.207 [BookieJournal-46653] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie8660690387201969061test/current/17ce2ee2480.txn
18:13:50.208 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:50.218 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:46653 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:46653, port=46653, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:50.219 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:46653 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:46653, port=46653, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:50.220 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:46653
18:13:50.220 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:46653
18:13:50.468 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:46653' has been created.
18:13:50.469 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:50.469 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:50.470 [bookie-io-47-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x886eb27f, L:/127.0.0.1:33221 ! R:/127.0.0.1:33000]
18:13:50.470 [bookkeeper-io-76-2] WARN  org.apache.bookkeeper.proto.PerChannelBookieClient - Exception caught on:[id: 0x42740ce7, L:/127.0.0.1:33000 - R:127.0.0.1/127.0.0.1:33221] cause: readAddress(..) failed: Connection reset by peer
18:13:50.471 [bookkeeper-io-76-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x42740ce7, L:/127.0.0.1:33000 ! R:127.0.0.1/127.0.0.1:33221]
18:13:50.490 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-33221 with exitCode 0
18:13:50.491 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:50.491 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:50.503 [SyncThread-52-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635894829179 , logFileOffset - 1024]}.
18:13:50.512 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:50.512 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:50.513 [BookieJournal-33221] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:50.514 [BookieJournal-33221] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:50.514 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:50.515 [Bookie-33221] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:50.515 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:50.515 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:50.516 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:50.516 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:50.516 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:50.518 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:50.520 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:50.520 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:50.520 [pool-39-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-39-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:50.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
18:13:50.532 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:33221
18:13:50.532 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:33221
18:13:50.532 [Time-limited test-SendThread(localhost:37583)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b9190b0002.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b9190b0002, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:50.533 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:33221
18:13:50.534 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:33221
18:13:50.636 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b9190b0002
18:13:50.636 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b9190b0002 closed
18:13:50.638 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.DefaultBookieAddressResolver - Cannot resolve 127.0.0.1:33221, bookie is unknown org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
18:13:50.639 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Cannot connect to 127.0.0.1:33221 as endpoint resolution failed (probably bookie is down) err org.apache.bookkeeper.proto.BookieAddressResolver$BookieIdNotResolvedException: Cannot resolve bookieId 127.0.0.1:33221, bookie does not exist or it is not running
18:13:50.640 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: null/127.0.0.1:33221, current state CONNECTING : 
org.apache.bookkeeper.proto.BookieAddressResolver$BookieIdNotResolvedException: Cannot resolve bookieId 127.0.0.1:33221, bookie does not exist or it is not running
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:63) ~[classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient.connect(PerChannelBookieClient.java:533) [classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient.connectIfNeededAndDoOp(PerChannelBookieClient.java:665) [classes/:?]
	at org.apache.bookkeeper.proto.DefaultPerChannelBookieClientPool.obtain(DefaultPerChannelBookieClientPool.java:121) [classes/:?]
	at org.apache.bookkeeper.proto.DefaultPerChannelBookieClientPool.obtain(DefaultPerChannelBookieClientPool.java:116) [classes/:?]
	at org.apache.bookkeeper.proto.BookieClientImpl.addEntry(BookieClientImpl.java:329) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.sendWriteRequest(PendingAddOp.java:152) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.safeRun(PendingAddOp.java:278) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
	at org.apache.bookkeeper.discover.ZKRegistrationClient.getBookieServiceInfo(ZKRegistrationClient.java:248) ~[classes/:?]
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:43) ~[classes/:?]
	... 13 more
18:13:50.642 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (0, 1): Bookie handle is not available
18:13:50.648 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.DefaultBookieAddressResolver - Cannot resolve 127.0.0.1:33221, bookie is unknown org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
18:13:50.648 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy - Cannot resolve bookieId 127.0.0.1:33221 to a network address, resolving as /default-region/default-rack
org.apache.bookkeeper.proto.BookieAddressResolver$BookieIdNotResolvedException: Cannot resolve bookieId 127.0.0.1:33221, bookie does not exist or it is not running
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:63) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.resolveNetworkLocation(TopologyAwareEnsemblePlacementPolicy.java:794) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.createBookieNode(TopologyAwareEnsemblePlacementPolicy.java:784) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:458) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:120) ~[classes/:?]
	at org.apache.bookkeeper.client.BookieWatcherImpl.replaceBookie(BookieWatcherImpl.java:317) ~[classes/:?]
	at org.apache.bookkeeper.client.EnsembleUtils.replaceBookiesInEnsemble(EnsembleUtils.java:71) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.lambda$ensembleChangeLoop$2(LedgerHandle.java:1935) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.writeLoop(MetadataUpdateLoop.java:134) [classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.run(MetadataUpdateLoop.java:123) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.ensembleChangeLoop(LedgerHandle.java:1954) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.handleBookieFailure(LedgerHandle.java:1903) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:378) [classes/:?]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:295) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
	at org.apache.bookkeeper.discover.ZKRegistrationClient.getBookieServiceInfo(ZKRegistrationClient.java:248) ~[classes/:?]
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:43) ~[classes/:?]
	... 19 more
18:13:50.649 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.DefaultBookieAddressResolver - Cannot resolve 127.0.0.1:33221, bookie is unknown org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
18:13:50.649 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy - Cannot resolve bookieId 127.0.0.1:33221 to a network address, resolving as /default-region/default-rack
org.apache.bookkeeper.proto.BookieAddressResolver$BookieIdNotResolvedException: Cannot resolve bookieId 127.0.0.1:33221, bookie does not exist or it is not running
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:63) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.resolveNetworkLocation(TopologyAwareEnsemblePlacementPolicy.java:794) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.createBookieNode(TopologyAwareEnsemblePlacementPolicy.java:784) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.convertBookiesToNodes(TopologyAwareEnsemblePlacementPolicy.java:807) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:461) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:120) ~[classes/:?]
	at org.apache.bookkeeper.client.BookieWatcherImpl.replaceBookie(BookieWatcherImpl.java:317) ~[classes/:?]
	at org.apache.bookkeeper.client.EnsembleUtils.replaceBookiesInEnsemble(EnsembleUtils.java:71) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.lambda$ensembleChangeLoop$2(LedgerHandle.java:1935) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.writeLoop(MetadataUpdateLoop.java:134) [classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.run(MetadataUpdateLoop.java:123) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.ensembleChangeLoop(LedgerHandle.java:1954) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.handleBookieFailure(LedgerHandle.java:1903) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:378) [classes/:?]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:295) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
	at org.apache.bookkeeper.discover.ZKRegistrationClient.getBookieServiceInfo(ZKRegistrationClient.java:248) ~[classes/:?]
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:43) ~[classes/:?]
	... 20 more
18:13:50.650 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.DefaultBookieAddressResolver - Cannot resolve 127.0.0.1:33221, bookie is unknown org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
18:13:50.650 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy - Cannot resolve bookieId 127.0.0.1:33221 to a network address, resolving as /default-region/default-rack
org.apache.bookkeeper.proto.BookieAddressResolver$BookieIdNotResolvedException: Cannot resolve bookieId 127.0.0.1:33221, bookie does not exist or it is not running
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:63) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.resolveNetworkLocation(TopologyAwareEnsemblePlacementPolicy.java:794) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.createBookieNode(TopologyAwareEnsemblePlacementPolicy.java:784) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.convertBookiesToNodes(TopologyAwareEnsemblePlacementPolicy.java:807) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:462) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:120) ~[classes/:?]
	at org.apache.bookkeeper.client.BookieWatcherImpl.replaceBookie(BookieWatcherImpl.java:317) ~[classes/:?]
	at org.apache.bookkeeper.client.EnsembleUtils.replaceBookiesInEnsemble(EnsembleUtils.java:71) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.lambda$ensembleChangeLoop$2(LedgerHandle.java:1935) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.writeLoop(MetadataUpdateLoop.java:134) [classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.run(MetadataUpdateLoop.java:123) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.ensembleChangeLoop(LedgerHandle.java:1954) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.handleBookieFailure(LedgerHandle.java:1903) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:378) [classes/:?]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:295) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
	at org.apache.bookkeeper.discover.ZKRegistrationClient.getBookieServiceInfo(ZKRegistrationClient.java:248) ~[classes/:?]
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:43) ~[classes/:?]
	... 20 more
18:13:50.651 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43121>, <Bookie:127.0.0.1:45567>, <Bookie:127.0.0.1:33221>, <Bookie:127.0.0.1:46653>], allBookies [<Bookie:127.0.0.1:46653>, <Bookie:127.0.0.1:43121>, <Bookie:127.0.0.1:45567>].
18:13:50.652 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43121>, <Bookie:127.0.0.1:33221>, <Bookie:127.0.0.1:45567>], fallback to choose bookie randomly from the cluster.
18:13:50.653 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - replaceBookie for bookie: 127.0.0.1:33221 in ensemble: [127.0.0.1:43121, 127.0.0.1:33221, 127.0.0.1:45567] is not adhering to placement policy and chose 127.0.0.1:46653. excludedBookies [127.0.0.1:33221] and quarantinedBookies []
18:13:50.661 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.LedgerHandle - New Ensemble: [127.0.0.1:43121, 127.0.0.1:46653, 127.0.0.1:45567] for ledger: 0
18:13:50.664 [bookkeeper-io-76-4] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:46653 [id: 0xfc611b38, L:/127.0.0.1:37140 - R:127.0.0.1/127.0.0.1:46653]
18:13:50.665 [bookkeeper-io-76-4] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xfc611b38, L:/127.0.0.1:37140 - R:127.0.0.1/127.0.0.1:46653] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:50.669 [bookie-io-80-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:50.669 [bookie-io-80-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x27300dfa, L:/127.0.0.1:46653 - R:/127.0.0.1:37140]
18:13:50.672 [bookie-io-80-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:50.672 [bookie-io-80-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie8660690387201969061test/current/0.log for logId 0.
18:13:50.685 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:45567
18:13:50.686 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:33221
18:13:50.686 [bookkeeper-io-76-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xd079ce41, L:/127.0.0.1:35378 ! R:127.0.0.1/127.0.0.1:45567]
18:13:50.687 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:46653
18:13:50.687 [bookie-io-56-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x3b4efdae, L:/127.0.0.1:45567 ! R:/127.0.0.1:35378]
18:13:50.688 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:43121
18:13:50.688 [bookkeeper-io-76-4] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xfc611b38, L:/127.0.0.1:37140 ! R:127.0.0.1/127.0.0.1:46653]
18:13:50.688 [bookie-io-80-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x27300dfa, L:/127.0.0.1:46653 ! R:/127.0.0.1:37140]
18:13:50.688 [bookkeeper-io-76-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xd222002b, L:/127.0.0.1:32900 ! R:127.0.0.1/127.0.0.1:43121]
18:13:50.688 [bookie-io-65-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x34c1956b, L:/127.0.0.1:43121 ! R:/127.0.0.1:32900]
18:13:50.694 [Time-limited test-SendThread(localhost:37583)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b9190b0005.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b9190b0005, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:50.796 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b9190b0005
18:13:50.796 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b9190b0005 closed
18:13:50.798 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
18:13:50.911 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b9190b0001
18:13:50.911 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b9190b0001 closed
18:13:50.912 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:50.912 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:50.918 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-45567 with exitCode 0
18:13:50.918 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:50.918 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:50.930 [SyncThread-61-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635894829479 , logFileOffset - 2048]}.
18:13:50.939 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:50.939 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:50.939 [BookieJournal-45567] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:50.939 [BookieJournal-45567] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:50.939 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:50.940 [Bookie-45567] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:50.940 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:50.940 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:50.940 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:50.940 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:50.940 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:50.941 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:50.941 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:50.941 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:50.940 [pool-45-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-45-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:51.049 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b9190b0003
18:13:51.049 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b9190b0003 closed
18:13:51.052 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:51.052 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:51.060 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-43121 with exitCode 0
18:13:51.060 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:51.060 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:51.072 [SyncThread-70-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635894829792 , logFileOffset - 1536]}.
18:13:51.081 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:51.081 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:51.081 [BookieJournal-43121] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:51.081 [BookieJournal-43121] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:51.082 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:51.082 [Bookie-43121] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:51.082 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:51.082 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:51.082 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:51.082 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:51.082 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:51.083 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:51.083 [pool-51-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-51-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:51.088 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:51.088 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:51.091 [Time-limited test-SendThread(localhost:37583)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b9190b0004.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b9190b0004, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:51.187 [BookieDeathWatcher-33221] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:51.187 [BookieDeathWatcher-33221] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-33221
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:51.187 [BookieDeathWatcher-33221] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:51.187 [BookieDeathWatcher-33221] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:51.191 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b9190b0004 closed
18:13:51.191 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b9190b0004
18:13:51.191 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:51.191 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:51.197 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-46653 with exitCode 0
18:13:51.197 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:51.197 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:51.209 [SyncThread-85-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635894830208 , logFileOffset - 1024]}.
18:13:51.218 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:51.219 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:51.219 [BookieJournal-46653] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:51.219 [BookieJournal-46653] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:51.219 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:51.219 [Bookie-46653] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:51.219 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:51.219 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:51.219 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:51.220 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:51.220 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:51.220 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:51.220 [pool-60-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-60-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:51.225 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:51.225 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:51.228 [Time-limited test-SendThread(localhost:37583)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b9190b0006.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b9190b0006, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:51.328 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b9190b0006 closed
18:13:51.328 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b9190b0006
18:13:51.331 [Time-limited test-SendThread(localhost:37583)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b9190b0000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b9190b0000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:51.431 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b9190b0000 closed
18:13:51.431 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b9190b0000
18:13:51.432 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
18:13:51.432 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
18:13:51.433 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
18:13:51.433 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
18:13:51.433 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
18:13:51.433 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
18:13:51.434 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
18:13:51.434 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
18:13:51.434 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
18:13:51.434 [ProcessThread(sid:0 cport:37583):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
18:13:51.434 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
18:13:51.434 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
18:13:51.434 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
18:13:51.435 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 37583
18:13:51.438 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testAddWithEnsembleChange in 640 ms.
18:13:51.439 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
18:13:51.440 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
18:13:51.440 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
18:13:51.440 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
18:13:51.440 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
18:13:51.440 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
18:13:51.440 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
18:13:51.440 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
18:13:51.440 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
18:13:51.441 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
18:13:51.441 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
18:13:51.441 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
18:13:51.441 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
18:13:51.441 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
18:13:51.441 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
18:13:51.441 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
18:13:51.441 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
18:13:51.441 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
18:13:51.441 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper8088364197593305288test/version-2 snapdir /tmp/zookeeper8088364197593305288test/version-2
18:13:51.441 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
18:13:51.441 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
18:13:51.441 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
18:13:51.442 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper8088364197593305288test/version-2/snapshot.0
18:13:51.447 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 5 ms, highest zxid is 0x0, digest is 1371985504
18:13:51.447 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper8088364197593305288test/version-2/snapshot.0
18:13:51.447 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 0 ms
18:13:51.448 [ProcessThread(sid:0 cport:42087):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
18:13:51.448 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 42087
18:13:51.452 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:52452
18:13:51.452 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
18:13:51.453 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42087 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@5b400827
18:13:51.453 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:51.453 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:51.454 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42087.
18:13:51.454 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:51.454 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52454, server: localhost/127.0.0.1:42087
18:13:51.455 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
18:13:51.458 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42087, session id = 0x10000b9223e0000, negotiated timeout = 10000
18:13:51.458 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:51.467 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42087/ledgers : zkServers = localhost:42087, ledgersRootPath = /ledgers.
18:13:51.467 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42087 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@786b7571
18:13:51.467 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:51.467 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:51.473 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42087.
18:13:51.473 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:51.473 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52456, server: localhost/127.0.0.1:42087
18:13:51.477 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42087, session id = 0x10000b9223e0001, negotiated timeout = 10000
18:13:51.477 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:51.479 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:51.480 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
18:13:51.480 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
18:13:51.480 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
18:13:51.485 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:51.485 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "preserveMdcForTaskExecution" : "true",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "listeningInterface" : "lo",
  "diskUsageWarnThreshold" : "0.99",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "numAddWorkerThreads" : "0",
  "journalFormatVersionToWrite" : "5",
  "enableTaskExecutionStats" : "true",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "diskUsageThreshold" : "0.999",
  "allowLoopback" : "true",
  "ledgerDirectories" : "/tmp/bookie3981683192333778524test",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "gcWaitTime" : "1000",
  "metadataServiceUri" : "zk://localhost:42087/ledgers",
  "journalDirectories" : "/tmp/bookie3981683192333778524test",
  "entryLogFilePreallocationEnabled" : "false",
  "bookiePort" : "0",
  "readOnlyModeEnabled" : "true",
  "allowEphemeralPorts" : "true",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "numReadWorkerThreads" : "0",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "journalFlushWhenQueueEmpty" : "true"
}
18:13:51.487 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:51.491 [BookieDeathWatcher-45567] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:51.491 [BookieDeathWatcher-45567] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45567
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:51.491 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42087/ledgers : zkServers = localhost:42087, ledgersRootPath = /ledgers.
18:13:51.492 [BookieDeathWatcher-45567] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:51.492 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42087 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@5e92d63e
18:13:51.492 [BookieDeathWatcher-45567] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:51.493 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:51.493 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:51.498 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42087.
18:13:51.498 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:51.498 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52458, server: localhost/127.0.0.1:42087
18:13:51.500 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42087, session id = 0x10000b9223e0002, negotiated timeout = 10000
18:13:51.500 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:51.502 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:51.508 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie3981683192333778524test/current] [/tmp/bookie3981683192333778524test/current]
18:13:51.513 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:51.514 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie3981683192333778524test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:51.514 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:51.514 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:51.514 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:51.515 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:51.515 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:51.515 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:51.523 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:42011 to become writable
18:13:51.523 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:51.524 [SyncThread-100-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:51.526 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:51.529 [BookieJournal-42011] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie3981683192333778524test/current
18:13:51.538 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:51.540 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:42011 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:42011, port=42011, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:51.541 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:42011
18:13:51.544 [BookieJournal-42011] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie3981683192333778524test/current/17ce2ee29b9.txn
18:13:51.788 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:42011' has been created.
18:13:51.789 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:51.790 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "gcWaitTime" : "1000",
  "enableTaskExecutionStats" : "true",
  "listeningInterface" : "lo",
  "ledgerDirectories" : "/tmp/bookie7325974726220850005test",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "allowEphemeralPorts" : "true",
  "entryLogFilePreallocationEnabled" : "false",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "numAddWorkerThreads" : "0",
  "allowLoopback" : "true",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "bookiePort" : "0",
  "diskUsageWarnThreshold" : "0.99",
  "preserveMdcForTaskExecution" : "true",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "journalDirectories" : "/tmp/bookie7325974726220850005test",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "journalFormatVersionToWrite" : "5",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "readOnlyModeEnabled" : "true",
  "diskUsageThreshold" : "0.999",
  "metadataServiceUri" : "zk://localhost:42087/ledgers",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]"
}
18:13:51.791 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:51.794 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42087/ledgers : zkServers = localhost:42087, ledgersRootPath = /ledgers.
18:13:51.794 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42087 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@5b178e8a
18:13:51.794 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:51.794 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:51.795 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42087.
18:13:51.795 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:51.796 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52460, server: localhost/127.0.0.1:42087
18:13:51.797 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42087, session id = 0x10000b9223e0003, negotiated timeout = 10000
18:13:51.797 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:51.801 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:51.802 [BookieDeathWatcher-43121] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:51.802 [BookieDeathWatcher-43121] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-43121
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:51.803 [BookieDeathWatcher-43121] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:51.803 [BookieDeathWatcher-43121] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:51.807 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie7325974726220850005test/current] [/tmp/bookie7325974726220850005test/current]
18:13:51.812 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:51.813 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie7325974726220850005test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:51.813 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:51.814 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:51.814 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:51.814 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:51.814 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:51.814 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:51.819 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:44167 to become writable
18:13:51.820 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 1 ms.
18:13:51.820 [SyncThread-109-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:51.821 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:51.832 [BookieJournal-44167] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie7325974726220850005test/current
18:13:51.834 [BookieJournal-44167] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie7325974726220850005test/current/17ce2ee2adb.txn
18:13:51.836 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:51.837 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:44167 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:44167, port=44167, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:51.837 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:44167
18:13:52.087 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:44167' has been created.
18:13:52.088 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:52.089 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageWarnThreshold" : "0.99",
  "numReadWorkerThreads" : "0",
  "enableTaskExecutionStats" : "true",
  "ledgerDirectories" : "/tmp/bookie3792785410634023047test",
  "numAddWorkerThreads" : "0",
  "entryLogFilePreallocationEnabled" : "false",
  "metadataServiceUri" : "zk://localhost:42087/ledgers",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "readOnlyModeEnabled" : "true",
  "listeningInterface" : "lo",
  "journalFormatVersionToWrite" : "5",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "preserveMdcForTaskExecution" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageThreshold" : "0.999",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "journalFlushWhenQueueEmpty" : "true",
  "gcWaitTime" : "1000",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "journalDirectories" : "/tmp/bookie3792785410634023047test"
}
18:13:52.090 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:52.093 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42087/ledgers : zkServers = localhost:42087, ledgersRootPath = /ledgers.
18:13:52.093 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42087 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@331fc588
18:13:52.093 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:52.093 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:52.095 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42087.
18:13:52.095 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:52.095 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52462, server: localhost/127.0.0.1:42087
18:13:52.096 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42087, session id = 0x10000b9223e0004, negotiated timeout = 10000
18:13:52.096 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:52.098 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:52.103 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie3792785410634023047test/current] [/tmp/bookie3792785410634023047test/current]
18:13:52.108 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:52.109 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie3792785410634023047test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:52.109 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:52.110 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:52.110 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:52.110 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:52.111 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:52.111 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:52.118 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:34477 to become writable
18:13:52.118 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:52.119 [SyncThread-118-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:52.120 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:52.125 [BookieJournal-34477] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie3792785410634023047test/current
18:13:52.125 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:52.125 [BookieJournal-34477] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie3792785410634023047test/current/17ce2ee2bfe.txn
18:13:52.130 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:34477 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:34477, port=34477, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:52.131 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:34477
18:13:52.218 [BookieDeathWatcher-46653] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:52.218 [BookieDeathWatcher-46653] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-46653
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:52.218 [BookieDeathWatcher-46653] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:52.218 [BookieDeathWatcher-46653] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:52.379 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:34477' has been created.
18:13:52.380 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testReadEntryBeyondLac @ metadata service zk://localhost:42087/ledgers in 940 ms.
18:13:52.382 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42087/ledgers : zkServers = localhost:42087, ledgersRootPath = /ledgers.
18:13:52.382 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42087 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@4c8efe75
18:13:52.382 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:52.382 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:52.383 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42087.
18:13:52.383 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:52.384 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52464, server: localhost/127.0.0.1:42087
18:13:52.385 [Time-limited test-SendThread(localhost:42087)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42087, session id = 0x10000b9223e0005, negotiated timeout = 10000
18:13:52.385 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:52.387 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:52.388 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
18:13:52.388 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
18:13:52.388 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
18:13:52.391 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:34477 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:34477, port=34477, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:52.391 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:44167 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:44167, port=44167, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:52.391 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:42011 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:42011, port=42011, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:52.391 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:42011
18:13:52.392 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:34477
18:13:52.392 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:44167
18:13:52.393 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
18:13:52.393 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:42011, 127.0.0.1:44167, 127.0.0.1:34477] is not adhering to Placement Policy. quarantinedBookies: []
18:13:52.415 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:42011, 127.0.0.1:44167, 127.0.0.1:34477] for ledger: 0
18:13:52.419 [Time-limited test] ERROR org.apache.bookkeeper.client.LedgerHandle - ReadEntries exception on ledgerId:0 firstEntry:100 lastEntry:100 lastAddConfirmed:-1
18:13:52.528 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b9223e0005 closed
18:13:52.528 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b9223e0005
18:13:52.529 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
18:13:52.638 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b9223e0001 closed
18:13:52.638 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:52.638 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:52.639 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b9223e0001
18:13:52.650 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-42011 with exitCode 0
18:13:52.650 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:52.651 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:52.651 [SyncThread-100-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:52.653 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:52.653 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:52.653 [BookieJournal-42011] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:52.653 [BookieJournal-42011] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:52.655 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:52.655 [Bookie-42011] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:52.655 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:52.656 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:52.656 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:52.656 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:52.656 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:52.656 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:52.656 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:52.656 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:52.762 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b9223e0002 closed
18:13:52.762 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b9223e0002
18:13:52.762 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:52.762 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:52.767 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-44167 with exitCode 0
18:13:52.767 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:52.767 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:52.767 [SyncThread-109-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:52.769 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:52.770 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:52.770 [BookieJournal-44167] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:52.770 [BookieJournal-44167] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:52.770 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:52.770 [Bookie-44167] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:52.770 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:52.770 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:52.770 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:52.770 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:52.770 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:52.770 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:52.771 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:52.771 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:52.879 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b9223e0003 closed
18:13:52.879 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b9223e0003
18:13:52.879 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:52.880 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:52.886 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-34477 with exitCode 0
18:13:52.886 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:52.886 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:52.886 [SyncThread-118-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:52.888 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:52.888 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:52.888 [BookieJournal-34477] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:52.888 [BookieJournal-34477] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:52.888 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:52.888 [Bookie-34477] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:52.888 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:52.888 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:52.888 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:52.888 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:52.889 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:52.889 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:52.889 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:52.889 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:52.897 [Time-limited test-SendThread(localhost:42087)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b9223e0004.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b9223e0004, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:52.997 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b9223e0004 closed
18:13:52.998 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b9223e0004
18:13:53.000 [Time-limited test-SendThread(localhost:42087)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b9223e0000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b9223e0000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:53.101 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b9223e0000 closed
18:13:53.101 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b9223e0000
18:13:53.101 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
18:13:53.101 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
18:13:53.102 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
18:13:53.102 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
18:13:53.102 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
18:13:53.102 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
18:13:53.102 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
18:13:53.102 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
18:13:53.102 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
18:13:53.102 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
18:13:53.102 [ProcessThread(sid:0 cport:42087):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
18:13:53.102 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
18:13:53.102 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
18:13:53.103 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 42087
18:13:53.105 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testReadEntryBeyondLac in 576 ms.
18:13:53.106 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
18:13:53.106 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
18:13:53.107 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
18:13:53.107 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
18:13:53.107 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
18:13:53.117 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
18:13:53.117 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
18:13:53.117 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
18:13:53.117 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
18:13:53.117 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
18:13:53.117 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
18:13:53.117 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
18:13:53.117 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
18:13:53.117 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
18:13:53.117 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
18:13:53.117 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
18:13:53.118 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
18:13:53.118 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
18:13:53.118 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper8604459489715927128test/version-2 snapdir /tmp/zookeeper8604459489715927128test/version-2
18:13:53.118 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
18:13:53.118 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
18:13:53.118 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
18:13:53.119 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper8604459489715927128test/version-2/snapshot.0
18:13:53.119 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 0 ms, highest zxid is 0x0, digest is 1371985504
18:13:53.119 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper8604459489715927128test/version-2/snapshot.0
18:13:53.119 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 0 ms
18:13:53.121 [ProcessThread(sid:0 cport:36951):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
18:13:53.121 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 36951
18:13:53.122 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:48430
18:13:53.122 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
18:13:53.123 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:36951 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@7b67a776
18:13:53.123 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:53.123 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:53.125 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:36951.
18:13:53.125 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:53.125 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:48432, server: localhost/127.0.0.1:36951
18:13:53.125 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
18:13:53.128 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:36951, session id = 0x10000b928c60000, negotiated timeout = 10000
18:13:53.128 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:53.129 [BookieDeathWatcher-34477] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:53.129 [BookieDeathWatcher-34477] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-34477
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:53.130 [BookieDeathWatcher-34477] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:53.130 [BookieDeathWatcher-34477] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:53.137 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36951/ledgers : zkServers = localhost:36951, ledgersRootPath = /ledgers.
18:13:53.137 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:36951 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@44b547b5
18:13:53.137 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:53.138 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:53.141 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:36951.
18:13:53.141 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:53.141 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:48434, server: localhost/127.0.0.1:36951
18:13:53.142 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:36951, session id = 0x10000b928c60001, negotiated timeout = 10000
18:13:53.142 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:53.145 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:53.146 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
18:13:53.146 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
18:13:53.146 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
18:13:53.155 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:53.156 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "gcWaitTime" : "1000",
  "readOnlyModeEnabled" : "true",
  "allowLoopback" : "true",
  "diskUsageWarnThreshold" : "0.99",
  "numReadWorkerThreads" : "0",
  "enableTaskExecutionStats" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "preserveMdcForTaskExecution" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "numAddWorkerThreads" : "0",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "bookiePort" : "0",
  "journalDirectories" : "/tmp/bookie4920590858592786762test",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "ledgerDirectories" : "/tmp/bookie4920590858592786762test",
  "allowEphemeralPorts" : "true",
  "journalFlushWhenQueueEmpty" : "true",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "metadataServiceUri" : "zk://localhost:36951/ledgers",
  "listeningInterface" : "lo",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "diskUsageThreshold" : "0.999"
}
18:13:53.157 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:53.161 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36951/ledgers : zkServers = localhost:36951, ledgersRootPath = /ledgers.
18:13:53.161 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:36951 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@1a52ae90
18:13:53.161 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:53.162 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:53.162 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:36951.
18:13:53.162 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:53.162 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:48436, server: localhost/127.0.0.1:36951
18:13:53.164 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:36951, session id = 0x10000b928c60002, negotiated timeout = 10000
18:13:53.164 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:53.165 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:53.171 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie4920590858592786762test/current] [/tmp/bookie4920590858592786762test/current]
18:13:53.176 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:53.177 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie4920590858592786762test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:53.177 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:53.177 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:53.177 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:53.178 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:53.178 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:53.178 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:53.192 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:43573 to become writable
18:13:53.192 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:53.194 [SyncThread-139-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:53.195 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:53.197 [BookieJournal-43573] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie4920590858592786762test/current
18:13:53.198 [BookieJournal-43573] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie4920590858592786762test/current/17ce2ee302e.txn
18:13:53.198 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:53.207 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:43573 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:43573, port=43573, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:53.207 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:43573
18:13:53.457 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:43573' has been created.
18:13:53.458 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:53.459 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "readOnlyModeEnabled" : "true",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "ledgerDirectories" : "/tmp/bookie7750850352214241387test",
  "journalDirectories" : "/tmp/bookie7750850352214241387test",
  "gcWaitTime" : "1000",
  "entryLogFilePreallocationEnabled" : "false",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "enableTaskExecutionStats" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "preserveMdcForTaskExecution" : "true",
  "allowEphemeralPorts" : "true",
  "metadataServiceUri" : "zk://localhost:36951/ledgers",
  "diskUsageThreshold" : "0.999",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "bookiePort" : "0",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "numReadWorkerThreads" : "0",
  "allowLoopback" : "true",
  "journalFormatVersionToWrite" : "5",
  "listeningInterface" : "lo",
  "numAddWorkerThreads" : "0"
}
18:13:53.463 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:53.464 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36951/ledgers : zkServers = localhost:36951, ledgersRootPath = /ledgers.
18:13:53.464 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:36951 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@6c7d0f84
18:13:53.464 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:53.465 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:53.469 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:36951.
18:13:53.469 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:53.469 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:48438, server: localhost/127.0.0.1:36951
18:13:53.471 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:36951, session id = 0x10000b928c60003, negotiated timeout = 10000
18:13:53.471 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:53.474 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:53.477 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie7750850352214241387test/current] [/tmp/bookie7750850352214241387test/current]
18:13:53.481 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:53.482 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie7750850352214241387test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:53.482 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:53.482 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:53.483 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:53.483 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:53.483 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:53.483 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:53.493 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:38333 to become writable
18:13:53.494 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:53.495 [SyncThread-148-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:53.496 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:53.502 [BookieJournal-38333] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie7750850352214241387test/current
18:13:53.509 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:38333 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:38333, port=38333, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:53.509 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:38333
18:13:53.511 [BookieJournal-38333] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie7750850352214241387test/current/17ce2ee3168.txn
18:13:53.511 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:53.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
18:13:53.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
18:13:53.538 [BookieDeathWatcher-42011] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:53.538 [BookieDeathWatcher-42011] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-42011
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:53.538 [BookieDeathWatcher-42011] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:53.538 [BookieDeathWatcher-42011] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:53.767 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:38333' has been created.
18:13:53.768 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:53.768 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "enableTaskExecutionStats" : "true",
  "readOnlyModeEnabled" : "true",
  "allowLoopback" : "true",
  "bookiePort" : "0",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "journalDirectories" : "/tmp/bookie3883202871050061651test",
  "journalFormatVersionToWrite" : "5",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0",
  "diskUsageThreshold" : "0.999",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "listeningInterface" : "lo",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "numReadWorkerThreads" : "0",
  "diskUsageWarnThreshold" : "0.99",
  "entryLogFilePreallocationEnabled" : "false",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "ledgerDirectories" : "/tmp/bookie3883202871050061651test",
  "metadataServiceUri" : "zk://localhost:36951/ledgers",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "journalFlushWhenQueueEmpty" : "true"
}
18:13:53.771 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:53.773 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36951/ledgers : zkServers = localhost:36951, ledgersRootPath = /ledgers.
18:13:53.773 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:36951 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@5128f14e
18:13:53.773 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:53.773 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:53.774 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:36951.
18:13:53.774 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:53.774 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:48440, server: localhost/127.0.0.1:36951
18:13:53.777 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:36951, session id = 0x10000b928c60004, negotiated timeout = 10000
18:13:53.777 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:53.779 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:53.784 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie3883202871050061651test/current] [/tmp/bookie3883202871050061651test/current]
18:13:53.810 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:53.811 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie3883202871050061651test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:53.811 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:53.811 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:53.811 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:53.812 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:53.812 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:53.812 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:53.820 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:45537 to become writable
18:13:53.820 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:53.820 [SyncThread-157-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:53.822 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:53.824 [BookieJournal-45537] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie3883202871050061651test/current
18:13:53.825 [BookieJournal-45537] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie3883202871050061651test/current/17ce2ee32a2.txn
18:13:53.825 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:53.833 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:45537 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:45537, port=45537, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:53.833 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:45537
18:13:53.837 [BookieDeathWatcher-44167] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:53.837 [BookieDeathWatcher-44167] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-44167
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:53.838 [BookieDeathWatcher-44167] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:53.838 [BookieDeathWatcher-44167] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:54.081 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:45537' has been created.
18:13:54.082 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testLedgerCreateFails @ metadata service zk://localhost:36951/ledgers in 975 ms.
18:13:54.083 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36951/ledgers : zkServers = localhost:36951, ledgersRootPath = /ledgers.
18:13:54.083 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:36951 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@3cc4fa50
18:13:54.084 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:54.084 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:54.085 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:36951.
18:13:54.085 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:54.085 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:48442, server: localhost/127.0.0.1:36951
18:13:54.087 [Time-limited test-SendThread(localhost:36951)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:36951, session id = 0x10000b928c60005, negotiated timeout = 10000
18:13:54.087 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:54.088 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:54.089 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
18:13:54.089 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
18:13:54.089 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
18:13:54.096 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:38333 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:38333, port=38333, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:54.096 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:45537 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:45537, port=45537, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:54.096 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:43573 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:43573, port=43573, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:54.097 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:38333
18:13:54.097 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:45537
18:13:54.097 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:43573
18:13:54.098 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
18:13:54.098 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:45537, 127.0.0.1:38333, 127.0.0.1:43573] is not adhering to Placement Policy. quarantinedBookies: []
18:13:54.107 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:45537, 127.0.0.1:38333, 127.0.0.1:43573] for ledger: 0
18:13:54.111 [Time-limited test] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 96 bookies : excludeBookies [<Bookie:127.0.0.1:38333>, <Bookie:127.0.0.1:43573>, <Bookie:127.0.0.1:45537>], allBookies [<Bookie:127.0.0.1:43573>, <Bookie:127.0.0.1:45537>, <Bookie:127.0.0.1:38333>].
18:13:54.112 [Time-limited test] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 96 bookies : excludeBookies [<Bookie:127.0.0.1:38333>, <Bookie:127.0.0.1:43573>, <Bookie:127.0.0.1:45537>], allBookies [<Bookie:127.0.0.1:45537>, <Bookie:127.0.0.1:43573>, <Bookie:127.0.0.1:38333>].
18:13:54.112 [Time-limited test] ERROR org.apache.bookkeeper.client.LedgerCreateOp - Not enough bookies to create ledger with ensembleSize=99, writeQuorumSize=3 and ackQuorumSize=2
18:13:54.142 [Time-limited test-SendThread(localhost:36951)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b928c60005.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b928c60005, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:54.243 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b928c60005 closed
18:13:54.244 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b928c60005
18:13:54.247 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
18:13:54.351 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b928c60001 closed
18:13:54.351 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:54.351 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:54.351 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b928c60001
18:13:54.352 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-43573 with exitCode 0
18:13:54.352 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:54.352 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:54.352 [SyncThread-139-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:54.354 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:54.354 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:54.354 [BookieJournal-43573] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:54.354 [BookieJournal-43573] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:54.354 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:54.354 [Bookie-43573] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:54.354 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:54.354 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:54.354 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:54.355 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:54.355 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:54.355 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:54.355 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:54.355 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:54.363 [Time-limited test-SendThread(localhost:36951)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b928c60002.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b928c60002, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:54.463 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b928c60002 closed
18:13:54.463 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b928c60002
18:13:54.463 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:54.463 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:54.465 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-38333 with exitCode 0
18:13:54.465 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:54.465 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:54.465 [SyncThread-148-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:54.467 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:54.467 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:54.467 [BookieJournal-38333] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:54.467 [BookieJournal-38333] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:54.467 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:54.467 [Bookie-38333] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:54.467 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:54.467 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:54.467 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:54.467 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:54.467 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:54.467 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:54.467 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:54.467 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:54.475 [Time-limited test-SendThread(localhost:36951)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b928c60003.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b928c60003, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:54.576 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b928c60003 closed
18:13:54.576 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:54.576 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:54.576 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b928c60003
18:13:54.582 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-45537 with exitCode 0
18:13:54.582 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:54.582 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:54.582 [SyncThread-157-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:54.584 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:54.584 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:54.584 [BookieJournal-45537] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:54.584 [BookieJournal-45537] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:54.584 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:54.584 [Bookie-45537] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:54.584 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:54.584 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:54.584 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:54.584 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:54.584 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:54.585 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:54.585 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:54.585 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:54.592 [Time-limited test-SendThread(localhost:36951)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b928c60004.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b928c60004, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:54.693 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b928c60004 closed
18:13:54.693 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b928c60004
18:13:54.695 [Time-limited test-SendThread(localhost:36951)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b928c60000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b928c60000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:54.796 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b928c60000 closed
18:13:54.796 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b928c60000
18:13:54.797 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
18:13:54.797 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
18:13:54.797 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
18:13:54.798 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
18:13:54.798 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
18:13:54.798 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
18:13:54.798 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
18:13:54.798 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
18:13:54.798 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
18:13:54.798 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
18:13:54.798 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
18:13:54.798 [ProcessThread(sid:0 cport:36951):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
18:13:54.798 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
18:13:54.804 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 36951
18:13:54.806 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testLedgerCreateFails in 558 ms.
18:13:54.813 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
18:13:54.813 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
18:13:54.813 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
18:13:54.813 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper5504948230132485042test/version-2 snapdir /tmp/zookeeper5504948230132485042test/version-2
18:13:54.814 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
18:13:54.814 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
18:13:54.825 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper5504948230132485042test/version-2/snapshot.0
18:13:54.825 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 4 ms, highest zxid is 0x0, digest is 1371985504
18:13:54.825 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper5504948230132485042test/version-2/snapshot.0
18:13:54.825 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 0 ms
18:13:54.826 [ProcessThread(sid:0 cport:37257):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
18:13:54.827 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 37257
18:13:54.829 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:44572
18:13:54.829 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
18:13:54.829 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:37257 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@7350d016
18:13:54.830 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:54.830 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:54.831 [BookieDeathWatcher-45537] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:54.831 [BookieDeathWatcher-45537] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45537
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:54.833 [BookieDeathWatcher-45537] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:54.833 [BookieDeathWatcher-45537] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:54.833 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:37257.
18:13:54.836 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:54.836 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:44574, server: localhost/127.0.0.1:37257
18:13:54.840 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
18:13:54.842 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:37257, session id = 0x10000b92f710000, negotiated timeout = 10000
18:13:54.842 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:54.851 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37257/ledgers : zkServers = localhost:37257, ledgersRootPath = /ledgers.
18:13:54.852 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:37257 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@3e875774
18:13:54.852 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:54.852 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:54.853 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:37257.
18:13:54.853 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:54.854 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:44576, server: localhost/127.0.0.1:37257
18:13:54.855 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:37257, session id = 0x10000b92f710001, negotiated timeout = 10000
18:13:54.855 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:54.856 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:54.857 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
18:13:54.857 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
18:13:54.857 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
18:13:54.862 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:54.862 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "journalFlushWhenQueueEmpty" : "true",
  "bookiePort" : "0",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "journalDirectories" : "/tmp/bookie4077483411679432590test",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "allowEphemeralPorts" : "true",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "numReadWorkerThreads" : "0",
  "entryLogFilePreallocationEnabled" : "false",
  "preserveMdcForTaskExecution" : "true",
  "diskUsageThreshold" : "0.999",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "gcWaitTime" : "1000",
  "readOnlyModeEnabled" : "true",
  "metadataServiceUri" : "zk://localhost:37257/ledgers",
  "enableTaskExecutionStats" : "true",
  "diskUsageWarnThreshold" : "0.99",
  "journalFormatVersionToWrite" : "5",
  "numAddWorkerThreads" : "0",
  "ledgerDirectories" : "/tmp/bookie4077483411679432590test",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "listeningInterface" : "lo",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]"
}
18:13:54.864 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:54.866 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37257/ledgers : zkServers = localhost:37257, ledgersRootPath = /ledgers.
18:13:54.866 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:37257 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@4902ab42
18:13:54.866 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:54.866 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:54.873 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:37257.
18:13:54.873 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:54.873 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:44578, server: localhost/127.0.0.1:37257
18:13:54.874 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:37257, session id = 0x10000b92f710002, negotiated timeout = 10000
18:13:54.874 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:54.875 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:54.878 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie4077483411679432590test/current] [/tmp/bookie4077483411679432590test/current]
18:13:54.885 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:54.886 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie4077483411679432590test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:54.886 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:54.886 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:54.886 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:54.887 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:54.887 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:54.887 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:54.895 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:37181 to become writable
18:13:54.896 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:54.897 [SyncThread-178-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:54.898 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:54.900 [BookieJournal-37181] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie4077483411679432590test/current
18:13:54.901 [BookieJournal-37181] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie4077483411679432590test/current/17ce2ee36d6.txn
18:13:54.901 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:54.908 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:37181 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:37181, port=37181, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:54.908 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:37181
18:13:55.157 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:37181' has been created.
18:13:55.158 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:55.159 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "allowLoopback" : "true",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "metadataServiceUri" : "zk://localhost:37257/ledgers",
  "journalDirectories" : "/tmp/bookie8244255768320518589test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "ledgerDirectories" : "/tmp/bookie8244255768320518589test",
  "diskUsageThreshold" : "0.999",
  "readOnlyModeEnabled" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "entryLogFilePreallocationEnabled" : "false",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "journalFormatVersionToWrite" : "5",
  "preserveMdcForTaskExecution" : "true",
  "enableTaskExecutionStats" : "true",
  "gcWaitTime" : "1000",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "numAddWorkerThreads" : "0"
}
18:13:55.162 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:55.163 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37257/ledgers : zkServers = localhost:37257, ledgersRootPath = /ledgers.
18:13:55.163 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:37257 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@737050f0
18:13:55.164 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:55.164 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:55.165 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:37257.
18:13:55.165 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:55.166 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:44580, server: localhost/127.0.0.1:37257
18:13:55.167 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:37257, session id = 0x10000b92f710003, negotiated timeout = 10000
18:13:55.167 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:55.168 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:55.173 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie8244255768320518589test/current] [/tmp/bookie8244255768320518589test/current]
18:13:55.183 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:55.184 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie8244255768320518589test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:55.184 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:55.184 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:55.185 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:55.186 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:55.186 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:55.186 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:55.189 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:45233 to become writable
18:13:55.191 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:55.191 [SyncThread-187-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:55.193 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:55.193 [BookieJournal-45233] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie8244255768320518589test/current
18:13:55.197 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:55.197 [BookieJournal-45233] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie8244255768320518589test/current/17ce2ee37fa.txn
18:13:55.207 [BookieDeathWatcher-43573] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:55.207 [BookieDeathWatcher-43573] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-43573
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:55.207 [BookieDeathWatcher-43573] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:55.208 [BookieDeathWatcher-43573] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:55.212 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:45233 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:45233, port=45233, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:55.212 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:45233
18:13:55.461 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:45233' has been created.
18:13:55.463 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:55.463 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "ledgerDirectories" : "/tmp/bookie2928113190862638004test",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "metadataServiceUri" : "zk://localhost:37257/ledgers",
  "allowEphemeralPorts" : "true",
  "numAddWorkerThreads" : "0",
  "enableTaskExecutionStats" : "true",
  "listeningInterface" : "lo",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "gcWaitTime" : "1000",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "entryLogFilePreallocationEnabled" : "false",
  "diskUsageWarnThreshold" : "0.99",
  "journalFlushWhenQueueEmpty" : "true",
  "journalFormatVersionToWrite" : "5",
  "readOnlyModeEnabled" : "true",
  "allowLoopback" : "true",
  "numReadWorkerThreads" : "0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "preserveMdcForTaskExecution" : "true",
  "diskUsageThreshold" : "0.999",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "journalDirectories" : "/tmp/bookie2928113190862638004test",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "bookiePort" : "0"
}
18:13:55.465 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:55.467 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37257/ledgers : zkServers = localhost:37257, ledgersRootPath = /ledgers.
18:13:55.467 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:37257 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@1f556ef8
18:13:55.467 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:55.467 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:55.469 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:37257.
18:13:55.469 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:55.469 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:44582, server: localhost/127.0.0.1:37257
18:13:55.470 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:37257, session id = 0x10000b92f710004, negotiated timeout = 10000
18:13:55.471 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:55.473 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:55.475 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie2928113190862638004test/current] [/tmp/bookie2928113190862638004test/current]
18:13:55.479 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:55.479 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie2928113190862638004test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:55.479 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:55.480 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:55.480 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:55.481 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:55.481 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:55.481 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:55.486 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:45849 to become writable
18:13:55.486 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:55.487 [SyncThread-196-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:55.488 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:55.493 [BookieJournal-45849] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie2928113190862638004test/current
18:13:55.494 [BookieJournal-45849] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie2928113190862638004test/current/17ce2ee3927.txn
18:13:55.495 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:55.498 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:45849 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:45849, port=45849, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:55.498 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:45849
18:13:55.517 [BookieDeathWatcher-38333] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:55.517 [BookieDeathWatcher-38333] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-38333
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:55.517 [BookieDeathWatcher-38333] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:55.517 [BookieDeathWatcher-38333] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:55.747 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:45849' has been created.
18:13:55.748 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testReadFromDeletedLedger @ metadata service zk://localhost:37257/ledgers in 935 ms.
18:13:55.750 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37257/ledgers : zkServers = localhost:37257, ledgersRootPath = /ledgers.
18:13:55.750 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:37257 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@257f4f07
18:13:55.751 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:55.751 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:55.751 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:37257.
18:13:55.751 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:55.751 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:44584, server: localhost/127.0.0.1:37257
18:13:55.753 [Time-limited test-SendThread(localhost:37257)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:37257, session id = 0x10000b92f710005, negotiated timeout = 10000
18:13:55.753 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:55.757 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:55.758 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
18:13:55.758 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
18:13:55.758 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
18:13:55.760 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:37181 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:37181, port=37181, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:55.760 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:45233 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:45233, port=45233, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:55.761 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:45849 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:45849, port=45849, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:55.761 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:45849
18:13:55.761 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:45233
18:13:55.761 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:37181
18:13:55.761 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
18:13:55.762 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:37181, 127.0.0.1:45233, 127.0.0.1:45849] is not adhering to Placement Policy. quarantinedBookies: []
18:13:55.773 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:37181, 127.0.0.1:45233, 127.0.0.1:45849] for ledger: 0
18:13:55.782 [bookkeeper-io-202-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:37181 [id: 0xa3067b8e, L:/127.0.0.1:44346 - R:127.0.0.1/127.0.0.1:37181]
18:13:55.785 [bookkeeper-io-202-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:45233 [id: 0xc138b971, L:/127.0.0.1:47542 - R:127.0.0.1/127.0.0.1:45233]
18:13:55.790 [bookie-io-182-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:55.791 [bookie-io-182-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x9f9781a3, L:/127.0.0.1:45233 - R:/127.0.0.1:47542]
18:13:55.792 [bookie-io-173-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:55.793 [bookkeeper-io-202-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xc138b971, L:/127.0.0.1:47542 - R:127.0.0.1/127.0.0.1:45233] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:55.793 [bookie-io-191-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:55.794 [bookkeeper-io-202-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xa3067b8e, L:/127.0.0.1:44346 - R:127.0.0.1/127.0.0.1:37181] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:55.794 [bookkeeper-io-202-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:45849 [id: 0xea9f8e58, L:/127.0.0.1:46736 - R:127.0.0.1/127.0.0.1:45849]
18:13:55.794 [bookie-io-173-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xf644daf4, L:/127.0.0.1:37181 - R:/127.0.0.1:44346]
18:13:55.798 [bookkeeper-io-202-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xea9f8e58, L:/127.0.0.1:46736 - R:127.0.0.1/127.0.0.1:45849] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:55.799 [bookie-io-191-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xda490380, L:/127.0.0.1:45849 - R:/127.0.0.1:46736]
18:13:55.799 [bookie-io-191-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:55.801 [bookie-io-191-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie2928113190862638004test/current/0.log for logId 0.
18:13:55.803 [bookie-io-173-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:55.804 [bookie-io-173-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie4077483411679432590test/current/0.log for logId 0.
18:13:55.810 [bookie-io-182-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:55.811 [bookie-io-182-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie8244255768320518589test/current/0.log for logId 0.
18:13:55.844 [Time-limited test] ERROR org.apache.bookkeeper.client.LedgerHandle - ReadEntries exception on ledgerId:0 firstEntry:100 lastEntry:100 lastAddConfirmed:0
18:13:55.845 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:45233
18:13:55.849 [bookkeeper-io-202-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xc138b971, L:/127.0.0.1:47542 ! R:127.0.0.1/127.0.0.1:45233]
18:13:55.849 [bookie-io-182-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x9f9781a3, L:/127.0.0.1:45233 ! R:/127.0.0.1:47542]
18:13:55.849 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:45849
18:13:55.852 [bookkeeper-io-202-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xea9f8e58, L:/127.0.0.1:46736 ! R:127.0.0.1/127.0.0.1:45849]
18:13:55.852 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:37181
18:13:55.853 [bookie-io-191-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xda490380, L:/127.0.0.1:45849 ! R:/127.0.0.1:46736]
18:13:55.853 [bookkeeper-io-202-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xa3067b8e, L:/127.0.0.1:44346 ! R:127.0.0.1/127.0.0.1:37181]
18:13:55.853 [bookie-io-173-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xf644daf4, L:/127.0.0.1:37181 ! R:/127.0.0.1:44346]
18:13:55.959 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b92f710005 closed
18:13:55.959 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b92f710005
18:13:55.960 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
18:13:56.063 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b92f710001 closed
18:13:56.064 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:56.064 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:56.064 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b92f710001
18:13:56.065 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-37181 with exitCode 0
18:13:56.065 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:56.065 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:56.067 [SyncThread-178-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635894834902 , logFileOffset - 1024]}.
18:13:56.076 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:56.076 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:56.076 [BookieJournal-37181] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:56.076 [BookieJournal-37181] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:56.076 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:56.076 [Bookie-37181] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:56.076 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:56.076 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:56.076 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:56.076 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:56.076 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:56.077 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:56.077 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:56.077 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:56.079 [pool-126-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-126-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:56.084 [Time-limited test-SendThread(localhost:37257)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b92f710002.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b92f710002, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:56.185 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b92f710002 closed
18:13:56.185 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b92f710002
18:13:56.185 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:56.185 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:56.189 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-45233 with exitCode 0
18:13:56.189 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:56.189 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:56.201 [SyncThread-187-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635894835194 , logFileOffset - 1536]}.
18:13:56.210 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:56.210 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:56.210 [BookieJournal-45233] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:56.210 [BookieJournal-45233] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:56.210 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:56.211 [Bookie-45233] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:56.211 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:56.211 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:56.211 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:56.211 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:56.211 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:56.213 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:56.213 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:56.213 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:56.213 [pool-132-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-132-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:56.319 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b92f710003 closed
18:13:56.319 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:56.319 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:56.319 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b92f710003
18:13:56.321 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-45849 with exitCode 0
18:13:56.321 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:56.321 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:56.337 [SyncThread-196-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635894835495 , logFileOffset - 1024]}.
18:13:56.346 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:56.346 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:56.346 [BookieJournal-45849] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:56.346 [BookieJournal-45849] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:56.346 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:56.347 [Bookie-45849] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:56.351 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:56.351 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:56.351 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:56.351 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:56.351 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:56.351 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:56.352 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:56.352 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:56.355 [Time-limited test-SendThread(localhost:37257)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b92f710004.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b92f710004, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:56.351 [pool-138-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-138-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:56.455 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b92f710004 closed
18:13:56.455 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b92f710004
18:13:56.457 [Time-limited test-SendThread(localhost:37257)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b92f710000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b92f710000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:56.497 [BookieDeathWatcher-45849] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:56.497 [BookieDeathWatcher-45849] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45849
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:56.498 [BookieDeathWatcher-45849] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:56.498 [BookieDeathWatcher-45849] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:56.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
18:13:56.558 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b92f710000 closed
18:13:56.558 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b92f710000
18:13:56.558 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
18:13:56.558 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
18:13:56.559 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
18:13:56.559 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
18:13:56.559 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
18:13:56.559 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
18:13:56.559 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
18:13:56.559 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
18:13:56.559 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
18:13:56.559 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
18:13:56.559 [ProcessThread(sid:0 cport:37257):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
18:13:56.559 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
18:13:56.559 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
18:13:56.560 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 37257
18:13:56.562 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testReadFromDeletedLedger in 602 ms.
18:13:56.564 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
18:13:56.564 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
18:13:56.564 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
18:13:56.564 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
18:13:56.564 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
18:13:56.564 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
18:13:56.564 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
18:13:56.564 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
18:13:56.564 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
18:13:56.564 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
18:13:56.564 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
18:13:56.564 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
18:13:56.564 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
18:13:56.564 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
18:13:56.564 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
18:13:56.564 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
18:13:56.565 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
18:13:56.565 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
18:13:56.565 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper4096376209644184851test/version-2 snapdir /tmp/zookeeper4096376209644184851test/version-2
18:13:56.565 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
18:13:56.569 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
18:13:56.569 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
18:13:56.573 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper4096376209644184851test/version-2/snapshot.0
18:13:56.573 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 4 ms, highest zxid is 0x0, digest is 1371985504
18:13:56.573 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper4096376209644184851test/version-2/snapshot.0
18:13:56.574 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 1 ms
18:13:56.574 [ProcessThread(sid:0 cport:39919):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
18:13:56.574 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 39919
18:13:56.575 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:59026
18:13:56.575 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
18:13:56.577 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39919 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@409ecb35
18:13:56.577 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:56.577 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:56.581 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39919.
18:13:56.581 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:56.581 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:59028, server: localhost/127.0.0.1:39919
18:13:56.582 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
18:13:56.585 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39919, session id = 0x10000b936450000, negotiated timeout = 10000
18:13:56.586 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:56.594 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39919/ledgers : zkServers = localhost:39919, ledgersRootPath = /ledgers.
18:13:56.594 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39919 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@503294f2
18:13:56.595 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:56.595 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:56.595 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39919.
18:13:56.595 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:56.595 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:59030, server: localhost/127.0.0.1:39919
18:13:56.596 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39919, session id = 0x10000b936450001, negotiated timeout = 10000
18:13:56.596 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:56.597 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:56.598 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
18:13:56.598 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
18:13:56.598 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
18:13:56.605 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:56.605 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "allowLoopback" : "true",
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "journalDirectories" : "/tmp/bookie4747195191540266463test",
  "gcWaitTime" : "1000",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "ledgerDirectories" : "/tmp/bookie4747195191540266463test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:39919/ledgers",
  "journalFormatVersionToWrite" : "5",
  "numAddWorkerThreads" : "0",
  "diskUsageThreshold" : "0.999",
  "journalFlushWhenQueueEmpty" : "true",
  "numReadWorkerThreads" : "0",
  "preserveMdcForTaskExecution" : "true",
  "allowEphemeralPorts" : "true",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "readOnlyModeEnabled" : "true",
  "entryLogFilePreallocationEnabled" : "false",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "bookiePort" : "0",
  "enableTaskExecutionStats" : "true"
}
18:13:56.607 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:56.612 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39919/ledgers : zkServers = localhost:39919, ledgersRootPath = /ledgers.
18:13:56.612 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39919 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@3017ce45
18:13:56.612 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:56.612 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:56.616 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39919.
18:13:56.616 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:56.617 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:59032, server: localhost/127.0.0.1:39919
18:13:56.622 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39919, session id = 0x10000b936450002, negotiated timeout = 10000
18:13:56.622 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:56.624 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:56.629 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie4747195191540266463test/current] [/tmp/bookie4747195191540266463test/current]
18:13:56.633 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:56.634 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie4747195191540266463test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:56.634 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:56.634 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:56.634 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:56.635 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:56.635 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:56.635 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:56.646 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:34421 to become writable
18:13:56.647 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:56.647 [SyncThread-217-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:56.648 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:56.649 [BookieJournal-34421] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie4747195191540266463test/current
18:13:56.653 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:56.653 [BookieJournal-34421] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie4747195191540266463test/current/17ce2ee3daa.txn
18:13:56.661 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:34421 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:34421, port=34421, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:56.661 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:34421
18:13:56.907 [BookieDeathWatcher-37181] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:56.907 [BookieDeathWatcher-37181] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37181
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:56.908 [BookieDeathWatcher-37181] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:56.908 [BookieDeathWatcher-37181] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:56.911 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:34421' has been created.
18:13:56.912 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:56.912 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "metadataServiceUri" : "zk://localhost:39919/ledgers",
  "gcWaitTime" : "1000",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "preserveMdcForTaskExecution" : "true",
  "allowLoopback" : "true",
  "bookiePort" : "0",
  "journalDirectories" : "/tmp/bookie2983625454338713071test",
  "journalFormatVersionToWrite" : "5",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "numReadWorkerThreads" : "0",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "allowEphemeralPorts" : "true",
  "journalFlushWhenQueueEmpty" : "true",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerDirectories" : "/tmp/bookie2983625454338713071test",
  "diskUsageThreshold" : "0.999",
  "numAddWorkerThreads" : "0",
  "enableTaskExecutionStats" : "true",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "entryLogFilePreallocationEnabled" : "false",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "listeningInterface" : "lo",
  "readOnlyModeEnabled" : "true",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage"
}
18:13:56.913 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:56.914 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39919/ledgers : zkServers = localhost:39919, ledgersRootPath = /ledgers.
18:13:56.914 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39919 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@7310747a
18:13:56.915 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:56.915 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:56.915 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39919.
18:13:56.915 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:56.916 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:59034, server: localhost/127.0.0.1:39919
18:13:56.918 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39919, session id = 0x10000b936450003, negotiated timeout = 10000
18:13:56.918 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:56.920 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:56.927 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie2983625454338713071test/current] [/tmp/bookie2983625454338713071test/current]
18:13:56.930 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:56.930 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie2983625454338713071test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:56.930 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:56.931 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:56.931 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:56.931 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:56.931 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:56.931 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:56.935 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:46015 to become writable
18:13:56.935 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:56.935 [SyncThread-226-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:56.937 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:56.937 [BookieJournal-46015] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie2983625454338713071test/current
18:13:56.938 [BookieJournal-46015] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie2983625454338713071test/current/17ce2ee3ecb.txn
18:13:56.938 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:56.947 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:46015 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:46015, port=46015, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:56.948 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:46015
18:13:57.197 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:46015' has been created.
18:13:57.198 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:57.198 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "journalDirectories" : "/tmp/bookie1284931840352315756test",
  "allowLoopback" : "true",
  "preserveMdcForTaskExecution" : "true",
  "listeningInterface" : "lo",
  "journalFormatVersionToWrite" : "5",
  "allowEphemeralPorts" : "true",
  "entryLogFilePreallocationEnabled" : "false",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "readOnlyModeEnabled" : "true",
  "bookiePort" : "0",
  "diskUsageThreshold" : "0.999",
  "ledgerDirectories" : "/tmp/bookie1284931840352315756test",
  "enableTaskExecutionStats" : "true",
  "numReadWorkerThreads" : "0",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "diskUsageWarnThreshold" : "0.99",
  "journalFlushWhenQueueEmpty" : "true",
  "numAddWorkerThreads" : "0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "metadataServiceUri" : "zk://localhost:39919/ledgers",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807"
}
18:13:57.199 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:57.200 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39919/ledgers : zkServers = localhost:39919, ledgersRootPath = /ledgers.
18:13:57.200 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39919 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@68cc3954
18:13:57.201 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:57.201 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:57.201 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39919.
18:13:57.201 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:57.202 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:59036, server: localhost/127.0.0.1:39919
18:13:57.203 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39919, session id = 0x10000b936450004, negotiated timeout = 10000
18:13:57.203 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:57.204 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:57.209 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie1284931840352315756test/current] [/tmp/bookie1284931840352315756test/current]
18:13:57.211 [BookieDeathWatcher-45233] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:57.211 [BookieDeathWatcher-45233] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45233
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:57.211 [BookieDeathWatcher-45233] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:57.211 [BookieDeathWatcher-45233] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:57.213 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:57.214 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie1284931840352315756test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:57.214 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:57.214 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:57.214 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:57.215 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:57.215 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:57.215 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:57.220 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:35297 to become writable
18:13:57.221 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:57.222 [SyncThread-235-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:57.223 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:57.229 [BookieJournal-35297] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie1284931840352315756test/current
18:13:57.233 [BookieJournal-35297] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie1284931840352315756test/current/17ce2ee3ff2.txn
18:13:57.234 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:57.236 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:35297 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:35297, port=35297, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:57.236 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:35297
18:13:57.488 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:35297' has been created.
18:13:57.489 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testAddFailsWithReadOnlyBookie @ metadata service zk://localhost:39919/ledgers in 925 ms.
18:13:57.490 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39919/ledgers : zkServers = localhost:39919, ledgersRootPath = /ledgers.
18:13:57.490 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39919 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@48fc294
18:13:57.490 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:57.491 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:57.493 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39919.
18:13:57.493 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:57.493 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:59038, server: localhost/127.0.0.1:39919
18:13:57.495 [Time-limited test-SendThread(localhost:39919)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39919, session id = 0x10000b936450005, negotiated timeout = 10000
18:13:57.495 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:57.497 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:57.497 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
18:13:57.497 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
18:13:57.497 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
18:13:57.499 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:35297 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:35297, port=35297, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:57.499 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:34421 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:34421, port=34421, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:57.500 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:46015 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:46015, port=46015, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:57.500 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:35297
18:13:57.500 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:46015
18:13:57.500 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:34421
18:13:57.501 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
18:13:57.501 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:34421, 127.0.0.1:35297, 127.0.0.1:46015] is not adhering to Placement Policy. quarantinedBookies: []
18:13:57.512 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:34421, 127.0.0.1:35297, 127.0.0.1:46015] for ledger: 0
18:13:57.516 [Time-limited test] WARN  org.apache.bookkeeper.bookie.LedgerDirsManager - /tmp/bookie4747195191540266463test/current is out of space. Adding it to filled dirs list
18:13:57.516 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Major Compaction triggered by thread: Time-limited test
18:13:57.516 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Minor Compaction triggered by thread: Time-limited test
18:13:57.516 [Time-limited test] WARN  org.apache.bookkeeper.bookie.LedgerDirsManager - /tmp/bookie2983625454338713071test/current is out of space. Adding it to filled dirs list
18:13:57.517 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Major Compaction triggered by thread: Time-limited test
18:13:57.517 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Minor Compaction triggered by thread: Time-limited test
18:13:57.517 [Time-limited test] WARN  org.apache.bookkeeper.bookie.LedgerDirsManager - /tmp/bookie1284931840352315756test/current is out of space. Adding it to filled dirs list
18:13:57.517 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Major Compaction triggered by thread: Time-limited test
18:13:57.517 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Minor Compaction triggered by thread: Time-limited test
18:13:57.522 [bookkeeper-io-241-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:35297 [id: 0xe69696f8, L:/127.0.0.1:42388 - R:127.0.0.1/127.0.0.1:35297]
18:13:57.524 [bookkeeper-io-241-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xe69696f8, L:/127.0.0.1:42388 - R:127.0.0.1/127.0.0.1:35297] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:57.533 [bookkeeper-io-241-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:46015 [id: 0xa984f4e4, L:/127.0.0.1:50732 - R:127.0.0.1/127.0.0.1:46015]
18:13:57.533 [bookie-io-212-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:57.534 [bookie-io-230-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:57.535 [bookie-io-230-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x2362dd94, L:/127.0.0.1:35297 - R:/127.0.0.1:42388]
18:13:57.534 [bookkeeper-io-241-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xa984f4e4, L:/127.0.0.1:50732 - R:127.0.0.1/127.0.0.1:46015] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:57.540 [bookie-io-212-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xe2a2e7a1, L:/127.0.0.1:34421 - R:/127.0.0.1:59472]
18:13:57.542 [bookie-io-230-2] INFO  org.apache.bookkeeper.bookie.LedgerDirsManager - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/bookie1284931840352315756test/current]
18:13:57.542 [bookie-io-230-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:57.543 [bookie-io-230-2] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:57.544 [BookieStateManagerService-0] INFO  org.apache.bookkeeper.bookie.BookieStateManager - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
18:13:57.544 [bookie-io-230-2] ERROR org.apache.bookkeeper.proto.WriteEntryProcessorV3 - Error writing entry:0 to ledger:0
java.io.IOException: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1419) ~[classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) ~[classes/:?]
	... 34 more
18:13:57.545 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Add for failed on bookie 127.0.0.1:35297 code EIO
18:13:57.546 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (0, 0): Write failed on bookie
18:13:57.547 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:35297>, <Bookie:127.0.0.1:46015>, <Bookie:127.0.0.1:34421>], allBookies [<Bookie:127.0.0.1:34421>, <Bookie:127.0.0.1:35297>, <Bookie:127.0.0.1:46015>].
18:13:57.547 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:34421>, <Bookie:127.0.0.1:35297>, <Bookie:127.0.0.1:46015>], fallback to choose bookie randomly from the cluster.
18:13:57.547 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:34421>, <Bookie:127.0.0.1:35297>, <Bookie:127.0.0.1:46015>], allBookies [<Bookie:127.0.0.1:34421>, <Bookie:127.0.0.1:46015>, <Bookie:127.0.0.1:35297>].
18:13:57.548 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:35297>, <Bookie:127.0.0.1:46015>, <Bookie:127.0.0.1:34421>], allBookies [<Bookie:127.0.0.1:46015>, <Bookie:127.0.0.1:35297>, <Bookie:127.0.0.1:34421>].
18:13:57.549 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:34421>, <Bookie:127.0.0.1:46015>, <Bookie:127.0.0.1:35297>], fallback to choose bookie randomly from the cluster.
18:13:57.549 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:35297>, <Bookie:127.0.0.1:46015>, <Bookie:127.0.0.1:34421>], allBookies [<Bookie:127.0.0.1:34421>, <Bookie:127.0.0.1:46015>, <Bookie:127.0.0.1:35297>].
18:13:57.550 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.MetadataUpdateLoop - UpdateLoop(ledgerId=0,loopId=24f2a516) Exception updating
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:780) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:698) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:587) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:206) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:547) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:227) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:475) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:120) ~[classes/:?]
	at org.apache.bookkeeper.client.BookieWatcherImpl.replaceBookie(BookieWatcherImpl.java:334) ~[classes/:?]
	at org.apache.bookkeeper.client.EnsembleUtils.replaceBookiesInEnsemble(EnsembleUtils.java:71) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.lambda$ensembleChangeLoop$2(LedgerHandle.java:1935) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.writeLoop(MetadataUpdateLoop.java:134) [classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.run(MetadataUpdateLoop.java:123) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.ensembleChangeLoop(LedgerHandle.java:1954) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.handleBookieFailure(LedgerHandle.java:1903) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:378) [classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.writeComplete(PerChannelBookieClient.java:2159) [classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.handleResponse(PerChannelBookieClient.java:2216) [classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.handleV3Response(PerChannelBookieClient.java:2205) [classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$3.safeRun(PerChannelBookieClient.java:1473) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:57.550 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.LedgerHandle - [EnsembleChange(ledger:0, change-id:0000000001)][attempt:1] Exception changing ensemble
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:780) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:698) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:587) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:206) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:547) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:227) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:475) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:120) ~[classes/:?]
	at org.apache.bookkeeper.client.BookieWatcherImpl.replaceBookie(BookieWatcherImpl.java:334) ~[classes/:?]
	at org.apache.bookkeeper.client.EnsembleUtils.replaceBookiesInEnsemble(EnsembleUtils.java:71) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.lambda$ensembleChangeLoop$2(LedgerHandle.java:1935) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.writeLoop(MetadataUpdateLoop.java:134) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.run(MetadataUpdateLoop.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.ensembleChangeLoop(LedgerHandle.java:1954) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.handleBookieFailure(LedgerHandle.java:1903) ~[classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:378) ~[classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.writeComplete(PerChannelBookieClient.java:2159) ~[classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.handleResponse(PerChannelBookieClient.java:2216) ~[classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.handleV3Response(PerChannelBookieClient.java:2205) ~[classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$3.safeRun(PerChannelBookieClient.java:1473) ~[classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:57.551 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.LedgerHandle - Closing ledger 0 due to NotEnoughBookiesException: Not enough non-faulty bookies available
18:13:57.552 [bookkeeper-io-241-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:34421 [id: 0x09eb1031, L:/127.0.0.1:59472 - R:127.0.0.1/127.0.0.1:34421]
18:13:57.553 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L0 E0
18:13:57.555 [bookkeeper-io-241-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x09eb1031, L:/127.0.0.1:59472 - R:127.0.0.1/127.0.0.1:34421] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:57.555 [bookie-io-221-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:57.555 [bookie-io-221-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xf6e7809c, L:/127.0.0.1:46015 - R:/127.0.0.1:50732]
18:13:57.556 [bookie-io-212-2] INFO  org.apache.bookkeeper.bookie.LedgerDirsManager - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/bookie4747195191540266463test/current]
18:13:57.556 [bookie-io-221-2] INFO  org.apache.bookkeeper.bookie.LedgerDirsManager - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/bookie2983625454338713071test/current]
18:13:57.556 [bookie-io-212-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:57.556 [bookie-io-212-2] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:57.558 [BookieStateManagerService-0] INFO  org.apache.bookkeeper.bookie.BookieStateManager - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
18:13:57.558 [bookie-io-221-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:57.559 [bookie-io-221-2] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:57.559 [BookieStateManagerService-0] INFO  org.apache.bookkeeper.bookie.BookieStateManager - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
18:13:57.559 [bookie-io-212-2] ERROR org.apache.bookkeeper.proto.WriteEntryProcessorV3 - Error writing entry:0 to ledger:0
java.io.IOException: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1419) ~[classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) ~[classes/:?]
	... 34 more
18:13:57.560 [bookie-io-221-2] ERROR org.apache.bookkeeper.proto.WriteEntryProcessorV3 - Error writing entry:0 to ledger:0
java.io.IOException: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1419) ~[classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) ~[classes/:?]
	... 34 more
18:13:57.563 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:34421
18:13:57.565 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:35297
18:13:57.565 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:35297
18:13:57.566 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:46015
18:13:57.566 [bookkeeper-io-241-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x09eb1031, L:/127.0.0.1:59472 ! R:127.0.0.1/127.0.0.1:34421]
18:13:57.562 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Add for failed on bookie 127.0.0.1:34421 code EIO
18:13:57.567 [bookkeeper-io-241-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xa984f4e4, L:/127.0.0.1:50732 ! R:127.0.0.1/127.0.0.1:46015]
18:13:57.569 [bookie-io-212-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xe2a2e7a1, L:/127.0.0.1:34421 ! R:/127.0.0.1:59472]
18:13:57.569 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:35297
18:13:57.571 [bookie-io-221-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xf6e7809c, L:/127.0.0.1:46015 ! R:/127.0.0.1:50732]
18:13:57.572 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:35297
18:13:57.572 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:35297
18:13:57.575 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:46015
18:13:57.575 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:46015
18:13:57.575 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (0, 0): Write failed on bookie
18:13:57.575 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Add for failed on bookie 127.0.0.1:46015 code EIO
18:13:57.576 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (0, 0): Write failed on bookie
18:13:57.577 [bookkeeper-io-241-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xe69696f8, L:/127.0.0.1:42388 ! R:127.0.0.1/127.0.0.1:35297]
18:13:57.577 [bookie-io-230-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x2362dd94, L:/127.0.0.1:35297 ! R:/127.0.0.1:42388]
18:13:57.583 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:34421
18:13:57.583 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:34421
18:13:57.585 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:34421
18:13:57.586 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:46015
18:13:57.586 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (readonly bookie) 127.0.0.1:35297 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:35297, port=35297, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:57.651 [GarbageCollectorThread-218-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Disk almost full, suspend major compaction to slow down filling disk.
18:13:57.652 [GarbageCollectorThread-218-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Disk full, suspend minor compaction to slow down filling disk.
18:13:57.687 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b936450005 closed
18:13:57.687 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b936450005
18:13:57.688 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
18:13:57.691 [Time-limited test-SendThread(localhost:39919)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b936450001.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b936450001, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:57.791 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b936450001 closed
18:13:57.791 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:57.791 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:57.791 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b936450001
18:13:57.792 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-34421 with exitCode 0
18:13:57.792 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:57.792 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:57.793 [SyncThread-217-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:57.793 [SyncThread-217-1] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:57.793 [SyncThread-217-1] ERROR org.apache.bookkeeper.bookie.SyncThread - Exception marking checkpoint as complete
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:57.793 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:57.794 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:57.798 [BookieJournal-34421] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:57.798 [BookieJournal-34421] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:57.798 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:57.798 [Bookie-34421] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:57.799 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:57.799 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:57.799 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:57.799 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:57.799 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:57.799 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:57.799 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:57.799 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:57.901 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b936450002 closed
18:13:57.901 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:57.901 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:57.902 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b936450002
18:13:57.903 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-46015 with exitCode 0
18:13:57.903 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:57.903 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:57.904 [SyncThread-226-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:57.904 [SyncThread-226-1] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:57.904 [SyncThread-226-1] ERROR org.apache.bookkeeper.bookie.SyncThread - Exception marking checkpoint as complete
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:57.904 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:57.904 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:57.905 [BookieJournal-46015] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:57.905 [BookieJournal-46015] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:57.905 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:57.905 [Bookie-46015] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:57.905 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:57.905 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:57.905 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:57.905 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:57.905 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:57.905 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:57.906 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:57.906 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:57.907 [Time-limited test-SendThread(localhost:39919)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b936450003.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b936450003, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:58.008 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b936450003 closed
18:13:58.008 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b936450003
18:13:58.008 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:58.008 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:58.015 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-35297 with exitCode 0
18:13:58.015 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:58.015 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:58.016 [SyncThread-235-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:58.016 [SyncThread-235-1] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:58.016 [SyncThread-235-1] ERROR org.apache.bookkeeper.bookie.SyncThread - Exception marking checkpoint as complete
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:58.016 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:58.016 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:58.016 [BookieJournal-35297] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:58.016 [BookieJournal-35297] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:58.016 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:58.016 [Bookie-35297] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:58.016 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:58.017 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:58.017 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:58.017 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:58.017 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:58.017 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:58.017 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:58.017 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:58.019 [Time-limited test-SendThread(localhost:39919)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b936450004.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b936450004, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:58.120 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b936450004 closed
18:13:58.120 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b936450004
18:13:58.122 [Time-limited test-SendThread(localhost:39919)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b936450000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b936450000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:58.223 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b936450000 closed
18:13:58.223 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b936450000
18:13:58.223 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
18:13:58.224 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
18:13:58.224 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
18:13:58.224 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
18:13:58.224 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
18:13:58.224 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
18:13:58.224 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
18:13:58.224 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
18:13:58.225 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
18:13:58.225 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
18:13:58.225 [ProcessThread(sid:0 cport:39919):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
18:13:58.225 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
18:13:58.225 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
18:13:58.225 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 39919
18:13:58.227 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testAddFailsWithReadOnlyBookie in 539 ms.
18:13:58.229 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
18:13:58.230 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper3614081233476043578test/version-2 snapdir /tmp/zookeeper3614081233476043578test/version-2
18:13:58.230 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
18:13:58.231 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
18:13:58.231 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
18:13:58.238 [BookieDeathWatcher-35297] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:58.238 [BookieDeathWatcher-35297] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-35297
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:58.241 [BookieDeathWatcher-35297] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:58.241 [BookieDeathWatcher-35297] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:58.249 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper3614081233476043578test/version-2/snapshot.0
18:13:58.249 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 0 ms, highest zxid is 0x0, digest is 1371985504
18:13:58.249 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper3614081233476043578test/version-2/snapshot.0
18:13:58.249 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 0 ms
18:13:58.250 [ProcessThread(sid:0 cport:43007):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
18:13:58.251 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 43007
18:13:58.253 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:55596
18:13:58.253 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
18:13:58.254 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:43007 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@8d08aad
18:13:58.254 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:58.254 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:58.257 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:43007.
18:13:58.257 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:58.257 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:55598, server: localhost/127.0.0.1:43007
18:13:58.261 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
18:13:58.265 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:43007, session id = 0x10000b93cd10000, negotiated timeout = 10000
18:13:58.265 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:58.277 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43007/ledgers : zkServers = localhost:43007, ledgersRootPath = /ledgers.
18:13:58.277 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:43007 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@60366833
18:13:58.277 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:58.277 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:58.281 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:43007.
18:13:58.281 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:58.281 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:55600, server: localhost/127.0.0.1:43007
18:13:58.282 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:43007, session id = 0x10000b93cd10001, negotiated timeout = 10000
18:13:58.282 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:58.283 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:58.283 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
18:13:58.283 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
18:13:58.283 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
18:13:58.289 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:58.289 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "journalFlushWhenQueueEmpty" : "true",
  "journalFormatVersionToWrite" : "5",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "numAddWorkerThreads" : "0",
  "readOnlyModeEnabled" : "true",
  "entryLogFilePreallocationEnabled" : "false",
  "bookiePort" : "0",
  "allowLoopback" : "true",
  "journalDirectories" : "/tmp/bookie248821608748966372test",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "metadataServiceUri" : "zk://localhost:43007/ledgers",
  "diskUsageWarnThreshold" : "0.99",
  "diskUsageThreshold" : "0.999",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "enableTaskExecutionStats" : "true",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "gcWaitTime" : "1000",
  "preserveMdcForTaskExecution" : "true",
  "ledgerDirectories" : "/tmp/bookie248821608748966372test"
}
18:13:58.290 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:58.292 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43007/ledgers : zkServers = localhost:43007, ledgersRootPath = /ledgers.
18:13:58.292 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:43007 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@15ffdad1
18:13:58.292 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:58.292 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:58.292 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:43007.
18:13:58.292 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:58.292 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:55602, server: localhost/127.0.0.1:43007
18:13:58.294 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:43007, session id = 0x10000b93cd10002, negotiated timeout = 10000
18:13:58.294 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:58.295 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:58.298 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie248821608748966372test/current] [/tmp/bookie248821608748966372test/current]
18:13:58.303 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:58.304 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie248821608748966372test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:58.304 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:58.306 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:58.306 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:58.307 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:58.307 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:58.307 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:58.311 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:36469 to become writable
18:13:58.311 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:58.312 [SyncThread-256-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:58.313 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:58.313 [BookieJournal-36469] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie248821608748966372test/current
18:13:58.314 [BookieJournal-36469] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie248821608748966372test/current/17ce2ee442b.txn
18:13:58.314 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:58.323 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:36469 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:36469, port=36469, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:58.323 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:36469
18:13:58.572 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:36469' has been created.
18:13:58.573 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:58.574 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "journalDirectories" : "/tmp/bookie5320215138519302848test",
  "metadataServiceUri" : "zk://localhost:43007/ledgers",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "numAddWorkerThreads" : "0",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "diskUsageWarnThreshold" : "0.99",
  "diskUsageThreshold" : "0.999",
  "journalFormatVersionToWrite" : "5",
  "journalFlushWhenQueueEmpty" : "true",
  "numReadWorkerThreads" : "0",
  "readOnlyModeEnabled" : "true",
  "ledgerDirectories" : "/tmp/bookie5320215138519302848test",
  "gcWaitTime" : "1000",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "enableTaskExecutionStats" : "true",
  "allowLoopback" : "true",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "preserveMdcForTaskExecution" : "true",
  "bookiePort" : "0"
}
18:13:58.576 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:58.577 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43007/ledgers : zkServers = localhost:43007, ledgersRootPath = /ledgers.
18:13:58.577 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:43007 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@6df34dbd
18:13:58.577 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:58.577 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:58.578 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:43007.
18:13:58.578 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:58.578 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:55604, server: localhost/127.0.0.1:43007
18:13:58.580 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:43007, session id = 0x10000b93cd10003, negotiated timeout = 10000
18:13:58.580 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:58.581 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:58.583 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie5320215138519302848test/current] [/tmp/bookie5320215138519302848test/current]
18:13:58.588 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:58.589 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie5320215138519302848test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:58.589 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:58.589 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:58.589 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:58.590 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:58.590 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:58.590 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:58.592 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:34529 to become writable
18:13:58.593 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:58.593 [SyncThread-265-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:58.594 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:58.595 [BookieJournal-34529] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie5320215138519302848test/current
18:13:58.595 [BookieJournal-34529] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie5320215138519302848test/current/17ce2ee4544.txn
18:13:58.596 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:58.604 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:34529 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:34529, port=34529, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:58.604 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:34529
18:13:58.662 [BookieDeathWatcher-34421] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:58.662 [BookieDeathWatcher-34421] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-34421
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:58.662 [BookieDeathWatcher-34421] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:58.662 [BookieDeathWatcher-34421] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:58.853 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:34529' has been created.
18:13:58.854 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
18:13:58.855 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "preserveMdcForTaskExecution" : "true",
  "ledgerDirectories" : "/tmp/bookie5340026276911382565test",
  "diskUsageThreshold" : "0.999",
  "diskUsageWarnThreshold" : "0.99",
  "gcWaitTime" : "1000",
  "readOnlyModeEnabled" : "true",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "journalDirectories" : "/tmp/bookie5340026276911382565test",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "enableTaskExecutionStats" : "true",
  "journalFormatVersionToWrite" : "5",
  "bookiePort" : "0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "journalFlushWhenQueueEmpty" : "true",
  "listeningInterface" : "lo",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "allowEphemeralPorts" : "true",
  "numReadWorkerThreads" : "0",
  "metadataServiceUri" : "zk://localhost:43007/ledgers",
  "numAddWorkerThreads" : "0",
  "entryLogFilePreallocationEnabled" : "false"
}
18:13:58.856 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
18:13:58.857 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43007/ledgers : zkServers = localhost:43007, ledgersRootPath = /ledgers.
18:13:58.857 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:43007 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@5378e7d6
18:13:58.857 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:58.857 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:58.863 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:43007.
18:13:58.863 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:58.863 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:55606, server: localhost/127.0.0.1:43007
18:13:58.865 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:43007, session id = 0x10000b93cd10004, negotiated timeout = 10000
18:13:58.865 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:58.866 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
18:13:58.869 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie5340026276911382565test/current] [/tmp/bookie5340026276911382565test/current]
18:13:58.873 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
18:13:58.873 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie5340026276911382565test/current/lastMark (this is okay if it is the first time starting this bookie
18:13:58.873 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
18:13:58.873 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
18:13:58.874 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
18:13:58.874 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
18:13:58.874 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
18:13:58.874 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
18:13:58.883 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:39875 to become writable
18:13:58.883 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
18:13:58.884 [SyncThread-274-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
18:13:58.885 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
18:13:58.886 [BookieJournal-39875] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie5340026276911382565test/current
18:13:58.887 [BookieJournal-39875] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie5340026276911382565test/current/17ce2ee4668.txn
18:13:58.887 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
18:13:58.895 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:39875 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:39875, port=39875, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:58.896 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:39875
18:13:58.947 [BookieDeathWatcher-46015] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:58.947 [BookieDeathWatcher-46015] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-46015
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:58.947 [BookieDeathWatcher-46015] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:58.947 [BookieDeathWatcher-46015] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:59.144 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:39875' has been created.
18:13:59.145 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testAddFailsDuplicateEntry @ metadata service zk://localhost:43007/ledgers in 915 ms.
18:13:59.146 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43007/ledgers : zkServers = localhost:43007, ledgersRootPath = /ledgers.
18:13:59.147 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:43007 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@746b6f2f
18:13:59.147 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
18:13:59.147 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
18:13:59.149 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:43007.
18:13:59.149 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
18:13:59.149 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:55608, server: localhost/127.0.0.1:43007
18:13:59.153 [Time-limited test-SendThread(localhost:43007)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:43007, session id = 0x10000b93cd10005, negotiated timeout = 10000
18:13:59.153 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
18:13:59.154 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:59.154 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
18:13:59.154 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
18:13:59.155 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
18:13:59.157 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:36469 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:36469, port=36469, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:59.157 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:34529 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:34529, port=34529, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:59.157 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:39875 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:39875, port=39875, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
18:13:59.157 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:39875
18:13:59.157 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:34529
18:13:59.157 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:36469
18:13:59.158 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
18:13:59.158 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:34529, 127.0.0.1:36469, 127.0.0.1:39875] is not adhering to Placement Policy. quarantinedBookies: []
18:13:59.170 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:34529, 127.0.0.1:36469, 127.0.0.1:39875] for ledger: 0
18:13:59.181 [bookkeeper-io-280-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:34529 [id: 0x0e632267, L:/127.0.0.1:35654 - R:127.0.0.1/127.0.0.1:34529]
18:13:59.185 [bookie-io-260-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:59.186 [bookie-io-260-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x8e6c4fca, L:/127.0.0.1:34529 - R:/127.0.0.1:35654]
18:13:59.186 [bookkeeper-io-280-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:39875 [id: 0xd7d85d45, L:/127.0.0.1:49342 - R:127.0.0.1/127.0.0.1:39875]
18:13:59.185 [bookkeeper-io-280-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:36469 [id: 0xdd8bb89a, L:/127.0.0.1:45416 - R:127.0.0.1/127.0.0.1:36469]
18:13:59.187 [bookkeeper-io-280-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xdd8bb89a, L:/127.0.0.1:45416 - R:127.0.0.1/127.0.0.1:36469] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:59.188 [bookie-io-251-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:59.188 [bookie-io-251-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xbd6d46f1, L:/127.0.0.1:36469 - R:/127.0.0.1:45416]
18:13:59.189 [bookkeeper-io-280-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x0e632267, L:/127.0.0.1:35654 - R:127.0.0.1/127.0.0.1:34529] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:59.190 [bookie-io-260-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:59.193 [bookie-io-260-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie5320215138519302848test/current/0.log for logId 0.
18:13:59.192 [bookkeeper-io-280-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xd7d85d45, L:/127.0.0.1:49342 - R:127.0.0.1/127.0.0.1:39875] authenticated as BookKeeperPrincipal{ANONYMOUS}
18:13:59.194 [bookie-io-269-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
18:13:59.195 [bookie-io-269-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x45d23f9b, L:/127.0.0.1:39875 - R:/127.0.0.1:49342]
18:13:59.201 [bookie-io-269-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:59.201 [bookie-io-269-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie5340026276911382565test/current/0.log for logId 0.
18:13:59.203 [bookie-io-251-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
18:13:59.204 [bookie-io-251-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie248821608748966372test/current/0.log for logId 0.
18:13:59.220 [Time-limited test] ERROR org.apache.bookkeeper.client.LedgerHandleAdv - Trying to re-add duplicate entryid:0
18:13:59.220 [Time-limited test] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L0 E0
18:13:59.228 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:34529
18:13:59.228 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:36469
18:13:59.228 [bookkeeper-io-280-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x0e632267, L:/127.0.0.1:35654 ! R:127.0.0.1/127.0.0.1:34529]
18:13:59.228 [bookie-io-260-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x8e6c4fca, L:/127.0.0.1:34529 ! R:/127.0.0.1:35654]
18:13:59.228 [bookkeeper-io-280-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xdd8bb89a, L:/127.0.0.1:45416 ! R:127.0.0.1/127.0.0.1:36469]
18:13:59.229 [bookie-io-251-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xbd6d46f1, L:/127.0.0.1:36469 ! R:/127.0.0.1:45416]
18:13:59.229 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:39875
18:13:59.230 [bookkeeper-io-280-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xd7d85d45, L:/127.0.0.1:49342 ! R:127.0.0.1/127.0.0.1:39875]
18:13:59.230 [bookie-io-269-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x45d23f9b, L:/127.0.0.1:39875 ! R:/127.0.0.1:49342]
18:13:59.233 [Time-limited test-SendThread(localhost:43007)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b93cd10005.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b93cd10005, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:59.333 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b93cd10005 closed
18:13:59.334 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b93cd10005
18:13:59.334 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
18:13:59.337 [Time-limited test-SendThread(localhost:43007)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b93cd10001.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b93cd10001, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:59.438 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b93cd10001 closed
18:13:59.438 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:59.438 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:59.438 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b93cd10001
18:13:59.443 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-36469 with exitCode 0
18:13:59.443 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:59.443 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:59.454 [SyncThread-256-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635894838315 , logFileOffset - 1024]}.
18:13:59.463 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:59.463 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:59.464 [BookieJournal-36469] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:59.464 [BookieJournal-36469] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:59.464 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:59.464 [Bookie-36469] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:59.464 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:59.464 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:59.464 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:59.464 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:59.464 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:59.465 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:59.469 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:59.469 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:59.465 [pool-180-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-180-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:59.472 [Time-limited test-SendThread(localhost:43007)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b93cd10002.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b93cd10002, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:59.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
18:13:59.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
18:13:59.573 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b93cd10002 closed
18:13:59.573 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:59.573 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:59.573 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b93cd10002
18:13:59.576 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-34529 with exitCode 0
18:13:59.576 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:59.576 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:59.587 [SyncThread-265-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635894838596 , logFileOffset - 1536]}.
18:13:59.596 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:59.596 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:59.596 [BookieJournal-34529] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:59.597 [BookieJournal-34529] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:59.597 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:59.597 [Bookie-34529] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:59.597 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:59.597 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:59.597 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:59.597 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:59.597 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:59.598 [GarbageCollectorThread-266-1] WARN  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Exception when iterating over the metadata
java.io.IOException: Error on getting children from node /ledgers
	at org.apache.bookkeeper.util.ZkUtils.getChildrenInSingleNode(ZkUtils.java:270) ~[classes/:?]
	at org.apache.bookkeeper.meta.LongHierarchicalLedgerManager$LongHierarchicalLedgerRangeIterator.getChildrenAt(LongHierarchicalLedgerManager.java:166) ~[classes/:?]
	at org.apache.bookkeeper.meta.LongHierarchicalLedgerManager$LongHierarchicalLedgerRangeIterator$InnerIterator.<init>(LongHierarchicalLedgerManager.java:244) ~[classes/:?]
	at org.apache.bookkeeper.meta.LongHierarchicalLedgerManager$LongHierarchicalLedgerRangeIterator.bootstrap(LongHierarchicalLedgerManager.java:294) ~[classes/:?]
	at org.apache.bookkeeper.meta.LongHierarchicalLedgerManager$LongHierarchicalLedgerRangeIterator.hasNext(LongHierarchicalLedgerManager.java:300) ~[classes/:?]
	at org.apache.bookkeeper.meta.HierarchicalLedgerManager$HierarchicalLedgerRangeIterator.hasNext(HierarchicalLedgerManager.java:109) ~[classes/:?]
	at org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector.gc(ScanAndCompareGarbageCollector.java:154) [classes/:?]
	at org.apache.bookkeeper.bookie.GarbageCollectorThread.doGcLedgers(GarbageCollectorThread.java:403) [classes/:?]
	at org.apache.bookkeeper.bookie.GarbageCollectorThread.runWithFlags(GarbageCollectorThread.java:352) [classes/:?]
	at org.apache.bookkeeper.bookie.GarbageCollectorThread.safeRun(GarbageCollectorThread.java:330) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:59.599 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:59.599 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:59.599 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:59.599 [pool-186-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-186-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:59.705 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b93cd10003 closed
18:13:59.705 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:59.705 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:59.706 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b93cd10003
18:13:59.709 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-39875 with exitCode 0
18:13:59.709 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
18:13:59.709 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
18:13:59.722 [SyncThread-274-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635894838888 , logFileOffset - 1536]}.
18:13:59.731 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
18:13:59.731 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
18:13:59.731 [BookieJournal-39875] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
18:13:59.731 [BookieJournal-39875] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
18:13:59.732 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
18:13:59.732 [Bookie-39875] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
18:13:59.732 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
18:13:59.732 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
18:13:59.732 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
18:13:59.732 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
18:13:59.732 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
18:13:59.733 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
18:13:59.736 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
18:13:59.736 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
18:13:59.733 [pool-192-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-192-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
18:13:59.840 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b93cd10004 closed
18:13:59.841 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b93cd10004
18:13:59.843 [Time-limited test-SendThread(localhost:43007)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000b93cd10000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000b93cd10000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
18:13:59.895 [BookieDeathWatcher-39875] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
18:13:59.895 [BookieDeathWatcher-39875] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-39875
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
18:13:59.895 [BookieDeathWatcher-39875] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
18:13:59.895 [BookieDeathWatcher-39875] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
18:13:59.943 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000b93cd10000 closed
18:13:59.944 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000b93cd10000
18:13:59.944 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
18:13:59.944 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
18:13:59.944 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
18:13:59.945 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
18:13:59.945 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
18:13:59.945 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
18:13:59.945 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
18:13:59.945 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
18:13:59.945 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
18:13:59.945 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
18:13:59.945 [ProcessThread(sid:0 cport:43007):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
18:13:59.945 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
18:13:59.945 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
18:13:59.946 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 43007
18:13:59.948 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testAddFailsDuplicateEntry in 613 ms.
