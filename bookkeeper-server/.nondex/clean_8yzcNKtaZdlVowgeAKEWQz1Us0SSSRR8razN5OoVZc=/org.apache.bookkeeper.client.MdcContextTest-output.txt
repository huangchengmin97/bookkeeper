16:44:09.984 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:10.448 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie8723644313719585225test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:10.864 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie1205912635379831727test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:11.161 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie3747958402547522456test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:11.447 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:12.243 [bookie-io-17-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:12.248 [bookie-io-17-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x4a0b05fd, L:/127.0.0.1:46547 - R:/127.0.0.1:36620]
16:44:12.249 [bookkeeper-io-37-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:34037 [id: 0x9352193b, L:/127.0.0.1:47558 - R:127.0.0.1/127.0.0.1:34037]
16:44:12.251 [bookie-io-26-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:12.252 [bookie-io-26-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x3d0a4617, L:/127.0.0.1:34037 - R:/127.0.0.1:47558]
16:44:12.257 [bookie-io-8-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:12.224 [bookkeeper-io-37-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:46547 [id: 0xe5ace667, L:/127.0.0.1:36620 - R:127.0.0.1/127.0.0.1:46547]
16:44:12.229 [bookkeeper-io-37-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:37355 [id: 0xa9ebe915, L:/127.0.0.1:54860 - R:127.0.0.1/127.0.0.1:37355]
16:44:12.258 [bookie-io-8-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x24050a1e, L:/127.0.0.1:37355 - R:/127.0.0.1:54860]
16:44:12.275 [bookkeeper-io-37-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xe5ace667, L:/127.0.0.1:36620 - R:127.0.0.1/127.0.0.1:46547] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:12.276 [bookkeeper-io-37-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x9352193b, L:/127.0.0.1:47558 - R:127.0.0.1/127.0.0.1:34037] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:12.277 [bookkeeper-io-37-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xa9ebe915, L:/127.0.0.1:54860 - R:127.0.0.1/127.0.0.1:37355] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:12.301 [bookie-io-17-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:12.304 [bookie-io-17-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie1205912635379831727test/current/0.log for logId 0.
16:44:12.304 [bookie-io-26-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:12.304 [bookie-io-8-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:12.321 [bookie-io-26-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie3747958402547522456test/current/0.log for logId 0.
16:44:12.321 [bookie-io-8-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie8723644313719585225test/current/0.log for logId 0.
16:44:12.367 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:34037
16:44:12.375 [bookkeeper-io-37-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x9352193b, L:/127.0.0.1:47558 ! R:127.0.0.1/127.0.0.1:34037]
16:44:12.376 [bookie-io-26-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x3d0a4617, L:/127.0.0.1:34037 ! R:/127.0.0.1:47558]
16:44:12.376 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:37355
16:44:12.377 [bookkeeper-io-37-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xa9ebe915, L:/127.0.0.1:54860 ! R:127.0.0.1/127.0.0.1:37355]
16:44:12.377 [bookie-io-8-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x24050a1e, L:/127.0.0.1:37355 ! R:/127.0.0.1:54860]
16:44:12.378 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:46547
16:44:12.378 [bookkeeper-io-37-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xe5ace667, L:/127.0.0.1:36620 ! R:127.0.0.1/127.0.0.1:46547]
16:44:12.379 [bookie-io-17-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x4a0b05fd, L:/127.0.0.1:46547 ! R:/127.0.0.1:36620]
16:44:12.391 [Time-limited test-SendThread(localhost:38737)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100006703da0005.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100006703da0005, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:12.493 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006703da0005 closed
16:44:12.494 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
16:44:12.494 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006703da0005
16:44:12.499 [Time-limited test-SendThread(localhost:38737)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100006703da0001.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100006703da0001, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:12.599 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006703da0001 closed
16:44:12.599 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006703da0001
16:44:12.600 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:12.600 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:12.611 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-37355 with exitCode 0
16:44:12.611 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:12.612 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:12.623 [SyncThread-13-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635889450536 , logFileOffset - 1536]}.
16:44:12.632 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:12.632 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:12.632 [BookieJournal-37355] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:12.633 [BookieJournal-37355] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:12.633 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:12.633 [Bookie-37355] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:12.633 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:12.633 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:12.633 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:12.634 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:12.634 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:12.634 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:12.635 [pool-12-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-12-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:12.641 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:12.641 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:12.643 [Time-limited test-SendThread(localhost:38737)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100006703da0002.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100006703da0002, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:12.744 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006703da0002 closed
16:44:12.744 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006703da0002
16:44:12.745 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:12.745 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:12.747 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-46547 with exitCode 0
16:44:12.747 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:12.747 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:12.758 [SyncThread-22-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635889450878 , logFileOffset - 1024]}.
16:44:12.767 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:12.768 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:12.768 [BookieJournal-46547] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:12.768 [BookieJournal-46547] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:12.768 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:12.768 [Bookie-46547] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:12.768 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:12.769 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:12.769 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:12.769 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:12.769 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:12.769 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:12.772 [pool-18-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-18-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:12.772 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:12.773 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:12.776 [Time-limited test-SendThread(localhost:38737)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100006703da0003.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100006703da0003, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:12.877 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006703da0003 closed
16:44:12.877 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006703da0003
16:44:12.878 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:12.878 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:12.880 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-34037 with exitCode 0
16:44:12.880 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:12.880 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:12.891 [BookieDeathWatcher-46547] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:12.891 [SyncThread-31-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635889451177 , logFileOffset - 1024]}.
16:44:12.891 [BookieDeathWatcher-46547] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-46547
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:12.891 [BookieDeathWatcher-46547] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:12.891 [BookieDeathWatcher-46547] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:12.900 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:12.900 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:12.900 [BookieJournal-34037] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:12.900 [BookieJournal-34037] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:12.900 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:12.901 [Bookie-34037] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:12.901 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:12.901 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:12.901 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:12.901 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:12.901 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:12.902 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:12.902 [pool-24-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-24-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:12.903 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:12.903 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:12.909 [Time-limited test-SendThread(localhost:38737)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100006703da0004.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100006703da0004, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:13.009 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006703da0004 closed
16:44:13.010 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006703da0004
16:44:13.012 [Time-limited test-SendThread(localhost:38737)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100006703da0000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100006703da0000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:13.113 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006703da0000 closed
16:44:13.113 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006703da0000
16:44:13.113 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
16:44:13.113 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
16:44:13.114 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
16:44:13.114 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
16:44:13.114 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
16:44:13.114 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
16:44:13.114 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
16:44:13.115 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
16:44:13.115 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
16:44:13.115 [ProcessThread(sid:0 cport:38737):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
16:44:13.115 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
16:44:13.115 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
16:44:13.115 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
16:44:13.117 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 38737
16:44:13.129 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testSimpleAdd in 635 ms.
16:44:13.136 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
16:44:13.137 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
16:44:13.137 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
16:44:13.137 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
16:44:13.140 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
16:44:13.140 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
16:44:13.140 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
16:44:13.140 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
16:44:13.140 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
16:44:13.140 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
16:44:13.141 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
16:44:13.141 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
16:44:13.141 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
16:44:13.141 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
16:44:13.141 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
16:44:13.142 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
16:44:13.142 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
16:44:13.142 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
16:44:13.142 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper7965980725513706443test/version-2 snapdir /tmp/zookeeper7965980725513706443test/version-2
16:44:13.142 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
16:44:13.142 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
16:44:13.143 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
16:44:13.144 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper7965980725513706443test/version-2/snapshot.0
16:44:13.144 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 1 ms, highest zxid is 0x0, digest is 1371985504
16:44:13.144 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper7965980725513706443test/version-2/snapshot.0
16:44:13.145 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 1 ms
16:44:13.147 [ProcessThread(sid:0 cport:44929):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
16:44:13.147 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 44929
16:44:13.149 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:35172
16:44:13.149 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
16:44:13.151 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:44929 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@4f2bbac8
16:44:13.151 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:13.151 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:13.155 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:44929.
16:44:13.155 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:13.155 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:35174, server: localhost/127.0.0.1:44929
16:44:13.156 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
16:44:13.159 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:44929, session id = 0x100006711400000, negotiated timeout = 10000
16:44:13.159 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:13.171 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44929/ledgers : zkServers = localhost:44929, ledgersRootPath = /ledgers.
16:44:13.171 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:44929 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@68b4343
16:44:13.171 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:13.171 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:13.177 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:44929.
16:44:13.177 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:13.177 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:35176, server: localhost/127.0.0.1:44929
16:44:13.179 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:44929, session id = 0x100006711400001, negotiated timeout = 10000
16:44:13.181 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:13.182 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:13.183 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
16:44:13.183 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
16:44:13.183 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
16:44:13.190 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:13.190 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie5039289996602898943test",
  "metadataServiceUri" : "zk://localhost:44929/ledgers",
  "journalDirectories" : "/tmp/bookie5039289996602898943test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:13.193 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:13.195 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44929/ledgers : zkServers = localhost:44929, ledgersRootPath = /ledgers.
16:44:13.195 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:44929 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@65189fd8
16:44:13.195 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:13.195 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:13.198 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:44929.
16:44:13.198 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:13.199 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:35178, server: localhost/127.0.0.1:44929
16:44:13.203 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:44929, session id = 0x100006711400002, negotiated timeout = 10000
16:44:13.203 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:13.208 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:13.212 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie5039289996602898943test/current] [/tmp/bookie5039289996602898943test/current]
16:44:13.219 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:13.220 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie5039289996602898943test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:13.220 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:13.220 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:13.221 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:13.221 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:13.221 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:13.221 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:13.225 [BookieDeathWatcher-34037] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:13.225 [BookieDeathWatcher-34037] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-34037
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:13.225 [BookieDeathWatcher-34037] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:13.225 [BookieDeathWatcher-34037] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:13.230 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:37495 to become writable
16:44:13.233 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
16:44:13.234 [SyncThread-52-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:13.235 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:13.235 [BookieJournal-37495] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie5039289996602898943test/current
16:44:13.241 [BookieJournal-37495] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie5039289996602898943test/current/17ce29c18b5.txn
16:44:13.241 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:13.246 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:37495 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:37495, port=37495, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:13.247 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:37495
16:44:13.497 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:37495' has been created.
16:44:13.498 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:13.499 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie5588780907979927796test",
  "metadataServiceUri" : "zk://localhost:44929/ledgers",
  "journalDirectories" : "/tmp/bookie5588780907979927796test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:13.502 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:13.503 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44929/ledgers : zkServers = localhost:44929, ledgersRootPath = /ledgers.
16:44:13.504 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:44929 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@674e5815
16:44:13.504 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:13.504 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:13.506 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:44929.
16:44:13.507 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:13.507 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:35180, server: localhost/127.0.0.1:44929
16:44:13.510 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:44929, session id = 0x100006711400003, negotiated timeout = 10000
16:44:13.510 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:13.513 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:13.516 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie5588780907979927796test/current] [/tmp/bookie5588780907979927796test/current]
16:44:13.520 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:13.521 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie5588780907979927796test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:13.522 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:13.522 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:13.522 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:13.523 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:13.523 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:13.523 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:13.529 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:43385 to become writable
16:44:13.533 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 1 ms.
16:44:13.533 [SyncThread-61-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:13.536 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:13.537 [BookieJournal-43385] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie5588780907979927796test/current
16:44:13.545 [BookieJournal-43385] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie5588780907979927796test/current/17ce29c19ea.txn
16:44:13.545 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:13.559 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:43385 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:43385, port=43385, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:13.559 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:43385
16:44:13.591 [BookieDeathWatcher-37355] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:13.591 [BookieDeathWatcher-37355] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37355
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:13.591 [BookieDeathWatcher-37355] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:13.591 [BookieDeathWatcher-37355] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:13.807 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:43385' has been created.
16:44:13.809 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:13.809 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie2289116230356569781test",
  "metadataServiceUri" : "zk://localhost:44929/ledgers",
  "journalDirectories" : "/tmp/bookie2289116230356569781test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:13.811 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:13.817 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44929/ledgers : zkServers = localhost:44929, ledgersRootPath = /ledgers.
16:44:13.817 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:44929 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@33241a4c
16:44:13.818 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:13.818 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:13.821 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:44929.
16:44:13.821 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:13.821 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:35182, server: localhost/127.0.0.1:44929
16:44:13.824 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:44929, session id = 0x100006711400004, negotiated timeout = 10000
16:44:13.825 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:13.827 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:13.830 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie2289116230356569781test/current] [/tmp/bookie2289116230356569781test/current]
16:44:13.835 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:13.836 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie2289116230356569781test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:13.836 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:13.836 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:13.837 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:13.837 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:13.837 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:13.837 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:13.846 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:41171 to become writable
16:44:13.846 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
16:44:13.847 [SyncThread-70-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:13.849 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:13.853 [BookieJournal-41171] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie2289116230356569781test/current
16:44:13.854 [BookieJournal-41171] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie2289116230356569781test/current/17ce29c1b1f.txn
16:44:13.854 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:13.861 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:41171 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:41171, port=41171, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:13.861 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:41171
16:44:14.110 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:41171' has been created.
16:44:14.111 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testAddWithEnsembleChange @ metadata service zk://localhost:44929/ledgers in 974 ms.
16:44:14.113 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44929/ledgers : zkServers = localhost:44929, ledgersRootPath = /ledgers.
16:44:14.113 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:44929 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@74da6520
16:44:14.113 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:14.113 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:14.117 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:44929.
16:44:14.117 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:14.117 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:35184, server: localhost/127.0.0.1:44929
16:44:14.119 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:44929, session id = 0x100006711400005, negotiated timeout = 10000
16:44:14.119 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:14.121 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:14.122 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
16:44:14.122 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
16:44:14.122 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
16:44:14.130 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:43385 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:43385, port=43385, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:14.131 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:37495 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:37495, port=37495, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:14.131 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:41171 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:41171, port=41171, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:14.131 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:43385
16:44:14.132 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:37495
16:44:14.132 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:41171
16:44:14.132 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
16:44:14.132 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:41171, 127.0.0.1:37495, 127.0.0.1:43385] is not adhering to Placement Policy. quarantinedBookies: []
16:44:14.143 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:41171, 127.0.0.1:37495, 127.0.0.1:43385] for ledger: 0
16:44:14.166 [bookkeeper-io-76-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:43385 [id: 0xe1c1e47a, L:/127.0.0.1:41014 - R:127.0.0.1/127.0.0.1:43385]
16:44:14.167 [bookkeeper-io-76-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:41171 [id: 0x5c294566, L:/127.0.0.1:39098 - R:127.0.0.1/127.0.0.1:41171]
16:44:14.168 [bookie-io-56-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:14.170 [bookie-io-65-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:14.170 [bookkeeper-io-76-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xe1c1e47a, L:/127.0.0.1:41014 - R:127.0.0.1/127.0.0.1:43385] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:14.171 [bookkeeper-io-76-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:37495 [id: 0x25fe454d, L:/127.0.0.1:56660 - R:127.0.0.1/127.0.0.1:37495]
16:44:14.172 [bookie-io-47-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:14.176 [bookie-io-65-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xd54f75ba, L:/127.0.0.1:41171 - R:/127.0.0.1:39098]
16:44:14.176 [bookkeeper-io-76-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x25fe454d, L:/127.0.0.1:56660 - R:127.0.0.1/127.0.0.1:37495] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:14.177 [bookie-io-56-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x9df96aaf, L:/127.0.0.1:43385 - R:/127.0.0.1:41014]
16:44:14.177 [bookie-io-56-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:14.178 [bookie-io-56-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie5588780907979927796test/current/0.log for logId 0.
16:44:14.178 [bookie-io-47-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x3435a111, L:/127.0.0.1:37495 - R:/127.0.0.1:56660]
16:44:14.178 [bookkeeper-io-76-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x5c294566, L:/127.0.0.1:39098 - R:127.0.0.1/127.0.0.1:41171] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:14.179 [bookie-io-47-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:14.179 [bookie-io-65-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:14.180 [bookie-io-65-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie2289116230356569781test/current/0.log for logId 0.
16:44:14.180 [bookie-io-47-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie5039289996602898943test/current/0.log for logId 0.
16:44:14.190 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:14.190 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie7644829686544862070test",
  "metadataServiceUri" : "zk://localhost:44929/ledgers",
  "journalDirectories" : "/tmp/bookie7644829686544862070test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:14.192 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:14.193 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44929/ledgers : zkServers = localhost:44929, ledgersRootPath = /ledgers.
16:44:14.193 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:44929 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@35203bdd
16:44:14.194 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:14.194 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:14.196 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:44929.
16:44:14.197 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:14.197 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:35192, server: localhost/127.0.0.1:44929
16:44:14.200 [Time-limited test-SendThread(localhost:44929)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:44929, session id = 0x100006711400006, negotiated timeout = 10000
16:44:14.200 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:14.202 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:14.212 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie7644829686544862070test/current] [/tmp/bookie7644829686544862070test/current]
16:44:14.218 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:14.219 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie7644829686544862070test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:14.219 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:14.219 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:14.220 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:14.220 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:14.221 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:14.221 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:14.232 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:43053 to become writable
16:44:14.232 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
16:44:14.233 [SyncThread-85-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:14.235 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:14.235 [BookieJournal-43053] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie7644829686544862070test/current
16:44:14.241 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:14.243 [BookieJournal-43053] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie7644829686544862070test/current/17ce29c1ca2.txn
16:44:14.256 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:43053 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:43053, port=43053, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:14.257 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:43053
16:44:14.257 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:43053 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:43053, port=43053, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:14.258 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:43053
16:44:14.511 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:43053' has been created.
16:44:14.513 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:14.513 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:14.514 [bookie-io-47-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x3435a111, L:/127.0.0.1:37495 ! R:/127.0.0.1:56660]
16:44:14.514 [bookkeeper-io-76-2] WARN  org.apache.bookkeeper.proto.PerChannelBookieClient - Exception caught on:[id: 0x25fe454d, L:/127.0.0.1:56660 - R:127.0.0.1/127.0.0.1:37495] cause: readAddress(..) failed: Connection reset by peer
16:44:14.515 [bookkeeper-io-76-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x25fe454d, L:/127.0.0.1:56660 ! R:127.0.0.1/127.0.0.1:37495]
16:44:14.518 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-37495 with exitCode 0
16:44:14.518 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:14.518 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:14.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
16:44:14.530 [SyncThread-52-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635889453237 , logFileOffset - 1024]}.
16:44:14.539 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:14.540 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:14.541 [BookieJournal-37495] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:14.541 [BookieJournal-37495] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:14.542 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:14.542 [Bookie-37495] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:14.544 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:14.544 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:14.545 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:14.545 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:14.545 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:14.551 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:14.552 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:14.552 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:14.553 [pool-39-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-39-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:14.555 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:37495
16:44:14.555 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:37495
16:44:14.557 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:37495
16:44:14.557 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:37495
16:44:14.656 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006711400002 closed
16:44:14.656 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006711400002
16:44:14.658 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.DefaultBookieAddressResolver - Cannot resolve 127.0.0.1:37495, bookie is unknown org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
16:44:14.658 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Cannot connect to 127.0.0.1:37495 as endpoint resolution failed (probably bookie is down) err org.apache.bookkeeper.proto.BookieAddressResolver$BookieIdNotResolvedException: Cannot resolve bookieId 127.0.0.1:37495, bookie does not exist or it is not running
16:44:14.659 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: null/127.0.0.1:37495, current state CONNECTING : 
org.apache.bookkeeper.proto.BookieAddressResolver$BookieIdNotResolvedException: Cannot resolve bookieId 127.0.0.1:37495, bookie does not exist or it is not running
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:63) ~[classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient.connect(PerChannelBookieClient.java:533) [classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient.connectIfNeededAndDoOp(PerChannelBookieClient.java:665) [classes/:?]
	at org.apache.bookkeeper.proto.DefaultPerChannelBookieClientPool.obtain(DefaultPerChannelBookieClientPool.java:121) [classes/:?]
	at org.apache.bookkeeper.proto.DefaultPerChannelBookieClientPool.obtain(DefaultPerChannelBookieClientPool.java:116) [classes/:?]
	at org.apache.bookkeeper.proto.BookieClientImpl.addEntry(BookieClientImpl.java:329) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.sendWriteRequest(PendingAddOp.java:152) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.safeRun(PendingAddOp.java:278) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
	at org.apache.bookkeeper.discover.ZKRegistrationClient.getBookieServiceInfo(ZKRegistrationClient.java:248) ~[classes/:?]
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:43) ~[classes/:?]
	... 13 more
16:44:14.661 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (0, 1): Bookie handle is not available
16:44:14.667 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.DefaultBookieAddressResolver - Cannot resolve 127.0.0.1:37495, bookie is unknown org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
16:44:14.667 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy - Cannot resolve bookieId 127.0.0.1:37495 to a network address, resolving as /default-region/default-rack
org.apache.bookkeeper.proto.BookieAddressResolver$BookieIdNotResolvedException: Cannot resolve bookieId 127.0.0.1:37495, bookie does not exist or it is not running
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:63) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.resolveNetworkLocation(TopologyAwareEnsemblePlacementPolicy.java:794) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.createBookieNode(TopologyAwareEnsemblePlacementPolicy.java:784) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:458) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:120) ~[classes/:?]
	at org.apache.bookkeeper.client.BookieWatcherImpl.replaceBookie(BookieWatcherImpl.java:317) ~[classes/:?]
	at org.apache.bookkeeper.client.EnsembleUtils.replaceBookiesInEnsemble(EnsembleUtils.java:71) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.lambda$ensembleChangeLoop$2(LedgerHandle.java:1935) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.writeLoop(MetadataUpdateLoop.java:134) [classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.run(MetadataUpdateLoop.java:123) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.ensembleChangeLoop(LedgerHandle.java:1954) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.handleBookieFailure(LedgerHandle.java:1903) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:378) [classes/:?]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:295) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
	at org.apache.bookkeeper.discover.ZKRegistrationClient.getBookieServiceInfo(ZKRegistrationClient.java:248) ~[classes/:?]
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:43) ~[classes/:?]
	... 19 more
16:44:14.670 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.DefaultBookieAddressResolver - Cannot resolve 127.0.0.1:37495, bookie is unknown org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
16:44:14.670 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy - Cannot resolve bookieId 127.0.0.1:37495 to a network address, resolving as /default-region/default-rack
org.apache.bookkeeper.proto.BookieAddressResolver$BookieIdNotResolvedException: Cannot resolve bookieId 127.0.0.1:37495, bookie does not exist or it is not running
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:63) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.resolveNetworkLocation(TopologyAwareEnsemblePlacementPolicy.java:794) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.createBookieNode(TopologyAwareEnsemblePlacementPolicy.java:784) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.convertBookiesToNodes(TopologyAwareEnsemblePlacementPolicy.java:807) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:461) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:120) ~[classes/:?]
	at org.apache.bookkeeper.client.BookieWatcherImpl.replaceBookie(BookieWatcherImpl.java:317) ~[classes/:?]
	at org.apache.bookkeeper.client.EnsembleUtils.replaceBookiesInEnsemble(EnsembleUtils.java:71) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.lambda$ensembleChangeLoop$2(LedgerHandle.java:1935) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.writeLoop(MetadataUpdateLoop.java:134) [classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.run(MetadataUpdateLoop.java:123) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.ensembleChangeLoop(LedgerHandle.java:1954) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.handleBookieFailure(LedgerHandle.java:1903) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:378) [classes/:?]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:295) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
	at org.apache.bookkeeper.discover.ZKRegistrationClient.getBookieServiceInfo(ZKRegistrationClient.java:248) ~[classes/:?]
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:43) ~[classes/:?]
	... 20 more
16:44:14.670 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.DefaultBookieAddressResolver - Cannot resolve 127.0.0.1:37495, bookie is unknown org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
16:44:14.670 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy - Cannot resolve bookieId 127.0.0.1:37495 to a network address, resolving as /default-region/default-rack
org.apache.bookkeeper.proto.BookieAddressResolver$BookieIdNotResolvedException: Cannot resolve bookieId 127.0.0.1:37495, bookie does not exist or it is not running
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:63) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.resolveNetworkLocation(TopologyAwareEnsemblePlacementPolicy.java:794) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.createBookieNode(TopologyAwareEnsemblePlacementPolicy.java:784) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.convertBookiesToNodes(TopologyAwareEnsemblePlacementPolicy.java:807) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:462) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:120) ~[classes/:?]
	at org.apache.bookkeeper.client.BookieWatcherImpl.replaceBookie(BookieWatcherImpl.java:317) ~[classes/:?]
	at org.apache.bookkeeper.client.EnsembleUtils.replaceBookiesInEnsemble(EnsembleUtils.java:71) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.lambda$ensembleChangeLoop$2(LedgerHandle.java:1935) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.writeLoop(MetadataUpdateLoop.java:134) [classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.run(MetadataUpdateLoop.java:123) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.ensembleChangeLoop(LedgerHandle.java:1954) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.handleBookieFailure(LedgerHandle.java:1903) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:378) [classes/:?]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:295) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
	at org.apache.bookkeeper.discover.ZKRegistrationClient.getBookieServiceInfo(ZKRegistrationClient.java:248) ~[classes/:?]
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:43) ~[classes/:?]
	... 20 more
16:44:14.672 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43053>, <Bookie:127.0.0.1:43385>, <Bookie:127.0.0.1:37495>, <Bookie:127.0.0.1:41171>], allBookies [<Bookie:127.0.0.1:43385>, <Bookie:127.0.0.1:43053>, <Bookie:127.0.0.1:41171>].
16:44:14.672 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43385>, <Bookie:127.0.0.1:37495>, <Bookie:127.0.0.1:41171>], fallback to choose bookie randomly from the cluster.
16:44:14.672 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - replaceBookie for bookie: 127.0.0.1:37495 in ensemble: [127.0.0.1:41171, 127.0.0.1:37495, 127.0.0.1:43385] is not adhering to placement policy and chose 127.0.0.1:43053. excludedBookies [127.0.0.1:37495] and quarantinedBookies []
16:44:14.680 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.LedgerHandle - New Ensemble: [127.0.0.1:41171, 127.0.0.1:43053, 127.0.0.1:43385] for ledger: 0
16:44:14.683 [bookkeeper-io-76-4] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:43053 [id: 0x168616c2, L:/127.0.0.1:53936 - R:127.0.0.1/127.0.0.1:43053]
16:44:14.684 [bookkeeper-io-76-4] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x168616c2, L:/127.0.0.1:53936 - R:127.0.0.1/127.0.0.1:43053] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:14.686 [bookie-io-80-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:14.686 [bookie-io-80-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x7f21d7f9, L:/127.0.0.1:43053 - R:/127.0.0.1:53936]
16:44:14.687 [bookie-io-80-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:14.687 [bookie-io-80-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie7644829686544862070test/current/0.log for logId 0.
16:44:14.700 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:43053
16:44:14.701 [bookkeeper-io-76-4] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x168616c2, L:/127.0.0.1:53936 ! R:127.0.0.1/127.0.0.1:43053]
16:44:14.701 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:43385
16:44:14.702 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:37495
16:44:14.702 [bookie-io-80-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x7f21d7f9, L:/127.0.0.1:43053 ! R:/127.0.0.1:53936]
16:44:14.702 [bookkeeper-io-76-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xe1c1e47a, L:/127.0.0.1:41014 ! R:127.0.0.1/127.0.0.1:43385]
16:44:14.703 [bookie-io-56-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x9df96aaf, L:/127.0.0.1:43385 ! R:/127.0.0.1:41014]
16:44:14.704 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:41171
16:44:14.704 [bookkeeper-io-76-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x5c294566, L:/127.0.0.1:39098 ! R:127.0.0.1/127.0.0.1:41171]
16:44:14.704 [bookie-io-65-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xd54f75ba, L:/127.0.0.1:41171 ! R:/127.0.0.1:39098]
16:44:14.709 [Time-limited test-SendThread(localhost:44929)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100006711400005.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100006711400005, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:14.810 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006711400005
16:44:14.810 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006711400005 closed
16:44:14.811 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
16:44:14.914 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006711400001 closed
16:44:14.914 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006711400001
16:44:14.914 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:14.914 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:14.921 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-43385 with exitCode 0
16:44:14.921 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:14.921 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:14.934 [SyncThread-61-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635889453546 , logFileOffset - 1536]}.
16:44:14.943 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:14.943 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:14.943 [BookieJournal-43385] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:14.943 [BookieJournal-43385] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:14.943 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:14.943 [Bookie-43385] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:14.944 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:14.944 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:14.944 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:14.944 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:14.944 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:14.944 [pool-45-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-45-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:14.945 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:14.946 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:14.946 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:15.052 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006711400003
16:44:15.053 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006711400003 closed
16:44:15.054 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:15.054 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:15.059 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-41171 with exitCode 0
16:44:15.059 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:15.059 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:15.070 [SyncThread-70-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635889453855 , logFileOffset - 1536]}.
16:44:15.079 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:15.079 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:15.079 [BookieJournal-41171] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:15.080 [BookieJournal-41171] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:15.080 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:15.080 [Bookie-41171] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:15.080 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:15.080 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:15.080 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:15.080 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:15.080 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:15.081 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:15.082 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:15.082 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:15.082 [pool-51-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-51-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:15.189 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006711400004 closed
16:44:15.189 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:15.189 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:15.189 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006711400004
16:44:15.195 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-43053 with exitCode 0
16:44:15.195 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:15.195 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:15.206 [SyncThread-85-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635889454242 , logFileOffset - 1024]}.
16:44:15.215 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:15.215 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:15.216 [BookieJournal-43053] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:15.216 [BookieJournal-43053] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:15.216 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:15.216 [Bookie-43053] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:15.216 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:15.216 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:15.216 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:15.216 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:15.216 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:15.217 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:15.217 [pool-60-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-60-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:15.218 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:15.218 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:15.224 [Time-limited test-SendThread(localhost:44929)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100006711400006.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100006711400006, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:15.248 [BookieDeathWatcher-37495] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:15.248 [BookieDeathWatcher-37495] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37495
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:15.248 [BookieDeathWatcher-37495] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:15.248 [BookieDeathWatcher-37495] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:15.324 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006711400006 closed
16:44:15.326 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006711400006
16:44:15.327 [Time-limited test-SendThread(localhost:44929)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100006711400000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100006711400000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:15.428 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006711400000 closed
16:44:15.428 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006711400000
16:44:15.428 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
16:44:15.428 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
16:44:15.429 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
16:44:15.429 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
16:44:15.429 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
16:44:15.429 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
16:44:15.429 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
16:44:15.429 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
16:44:15.429 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
16:44:15.429 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
16:44:15.430 [ProcessThread(sid:0 cport:44929):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
16:44:15.430 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
16:44:15.430 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
16:44:15.431 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 44929
16:44:15.434 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testAddWithEnsembleChange in 622 ms.
16:44:15.439 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
16:44:15.439 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper3758502830472300160test/version-2 snapdir /tmp/zookeeper3758502830472300160test/version-2
16:44:15.440 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
16:44:15.440 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
16:44:15.441 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
16:44:15.441 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper3758502830472300160test/version-2/snapshot.0
16:44:15.441 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 0 ms, highest zxid is 0x0, digest is 1371985504
16:44:15.441 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper3758502830472300160test/version-2/snapshot.0
16:44:15.442 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 0 ms
16:44:15.443 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 46479
16:44:15.445 [ProcessThread(sid:0 cport:46479):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
16:44:15.446 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:52122
16:44:15.446 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
16:44:15.446 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:46479 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@57e51793
16:44:15.447 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:15.447 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:15.447 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:46479.
16:44:15.447 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:15.448 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52124, server: localhost/127.0.0.1:46479
16:44:15.449 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
16:44:15.451 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:46479, session id = 0x10000671a390000, negotiated timeout = 10000
16:44:15.451 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:15.460 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:46479/ledgers : zkServers = localhost:46479, ledgersRootPath = /ledgers.
16:44:15.461 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:46479 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@353bf0f0
16:44:15.461 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:15.461 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:15.465 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:46479.
16:44:15.465 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:15.465 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52126, server: localhost/127.0.0.1:46479
16:44:15.466 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:46479, session id = 0x10000671a390001, negotiated timeout = 10000
16:44:15.466 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:15.468 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:15.468 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
16:44:15.468 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
16:44:15.468 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
16:44:15.475 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:15.475 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie2003014288501795545test",
  "metadataServiceUri" : "zk://localhost:46479/ledgers",
  "journalDirectories" : "/tmp/bookie2003014288501795545test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:15.477 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:15.478 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:46479/ledgers : zkServers = localhost:46479, ledgersRootPath = /ledgers.
16:44:15.478 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:46479 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@43d958db
16:44:15.478 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:15.478 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:15.485 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:46479.
16:44:15.485 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:15.486 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52128, server: localhost/127.0.0.1:46479
16:44:15.487 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:46479, session id = 0x10000671a390002, negotiated timeout = 10000
16:44:15.487 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:15.489 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:15.492 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie2003014288501795545test/current] [/tmp/bookie2003014288501795545test/current]
16:44:15.496 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:15.497 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie2003014288501795545test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:15.497 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:15.498 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:15.498 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:15.498 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:15.499 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:15.499 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:15.506 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:36967 to become writable
16:44:15.507 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 1 ms.
16:44:15.508 [SyncThread-100-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:15.510 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:15.510 [BookieJournal-36967] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie2003014288501795545test/current
16:44:15.511 [BookieJournal-36967] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie2003014288501795545test/current/17ce29c2198.txn
16:44:15.511 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:15.520 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:36967 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:36967, port=36967, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:15.520 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:36967
16:44:15.558 [BookieDeathWatcher-43385] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:15.558 [BookieDeathWatcher-43385] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-43385
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:15.558 [BookieDeathWatcher-43385] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:15.558 [BookieDeathWatcher-43385] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:15.769 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:36967' has been created.
16:44:15.771 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:15.771 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie9144292009413733051test",
  "metadataServiceUri" : "zk://localhost:46479/ledgers",
  "journalDirectories" : "/tmp/bookie9144292009413733051test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:15.773 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:15.776 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:46479/ledgers : zkServers = localhost:46479, ledgersRootPath = /ledgers.
16:44:15.776 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:46479 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@48e7a965
16:44:15.776 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:15.776 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:15.789 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:46479.
16:44:15.789 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:15.789 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52130, server: localhost/127.0.0.1:46479
16:44:15.791 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:46479, session id = 0x10000671a390003, negotiated timeout = 10000
16:44:15.791 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:15.793 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:15.796 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie9144292009413733051test/current] [/tmp/bookie9144292009413733051test/current]
16:44:15.799 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:15.800 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie9144292009413733051test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:15.800 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:15.801 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:15.801 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:15.801 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:15.801 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:15.802 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:15.807 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:38929 to become writable
16:44:15.807 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
16:44:15.808 [SyncThread-109-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:15.809 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:15.810 [BookieJournal-38929] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie9144292009413733051test/current
16:44:15.811 [BookieJournal-38929] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie9144292009413733051test/current/17ce29c22c3.txn
16:44:15.817 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:15.820 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:38929 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:38929, port=38929, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:15.820 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:38929
16:44:15.861 [BookieDeathWatcher-41171] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:15.861 [BookieDeathWatcher-41171] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-41171
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:15.861 [BookieDeathWatcher-41171] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:15.861 [BookieDeathWatcher-41171] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:16.071 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:38929' has been created.
16:44:16.072 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:16.072 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie7580659012546246890test",
  "metadataServiceUri" : "zk://localhost:46479/ledgers",
  "journalDirectories" : "/tmp/bookie7580659012546246890test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:16.074 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:16.079 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:46479/ledgers : zkServers = localhost:46479, ledgersRootPath = /ledgers.
16:44:16.079 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:46479 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@77fd83a7
16:44:16.079 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:16.079 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:16.080 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:46479.
16:44:16.080 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:16.080 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52132, server: localhost/127.0.0.1:46479
16:44:16.081 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:46479, session id = 0x10000671a390004, negotiated timeout = 10000
16:44:16.081 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:16.085 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:16.092 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie7580659012546246890test/current] [/tmp/bookie7580659012546246890test/current]
16:44:16.095 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:16.096 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie7580659012546246890test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:16.096 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:16.096 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:16.096 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:16.097 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:16.097 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:16.097 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:16.104 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:37769 to become writable
16:44:16.105 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
16:44:16.105 [SyncThread-118-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:16.106 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:16.111 [BookieJournal-37769] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie7580659012546246890test/current
16:44:16.113 [BookieJournal-37769] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie7580659012546246890test/current/17ce29c23f1.txn
16:44:16.113 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:16.116 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:37769 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:37769, port=37769, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:16.117 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:37769
16:44:16.262 [BookieDeathWatcher-43053] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:16.262 [BookieDeathWatcher-43053] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-43053
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:16.262 [BookieDeathWatcher-43053] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:16.262 [BookieDeathWatcher-43053] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:16.366 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:37769' has been created.
16:44:16.367 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testReadEntryBeyondLac @ metadata service zk://localhost:46479/ledgers in 927 ms.
16:44:16.368 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:46479/ledgers : zkServers = localhost:46479, ledgersRootPath = /ledgers.
16:44:16.368 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:46479 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@5725698e
16:44:16.368 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:16.368 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:16.374 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:46479.
16:44:16.375 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:16.375 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52134, server: localhost/127.0.0.1:46479
16:44:16.376 [Time-limited test-SendThread(localhost:46479)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:46479, session id = 0x10000671a390005, negotiated timeout = 10000
16:44:16.376 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:16.378 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:16.378 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
16:44:16.378 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
16:44:16.379 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
16:44:16.382 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:38929 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:38929, port=38929, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:16.382 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:37769 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:37769, port=37769, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:16.382 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:36967 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:36967, port=36967, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:16.382 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:38929
16:44:16.382 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:37769
16:44:16.382 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:36967
16:44:16.383 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
16:44:16.383 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:37769, 127.0.0.1:38929, 127.0.0.1:36967] is not adhering to Placement Policy. quarantinedBookies: []
16:44:16.400 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:37769, 127.0.0.1:38929, 127.0.0.1:36967] for ledger: 0
16:44:16.403 [Time-limited test] ERROR org.apache.bookkeeper.client.LedgerHandle - ReadEntries exception on ledgerId:0 firstEntry:100 lastEntry:100 lastAddConfirmed:-1
16:44:16.511 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000671a390005 closed
16:44:16.512 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
16:44:16.512 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000671a390005
16:44:16.623 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000671a390001 closed
16:44:16.623 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:16.623 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000671a390001
16:44:16.623 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:16.630 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-36967 with exitCode 0
16:44:16.631 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:16.631 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:16.631 [SyncThread-100-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:16.633 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:16.635 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:16.635 [BookieJournal-36967] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:16.635 [BookieJournal-36967] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:16.636 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:16.636 [Bookie-36967] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:16.636 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:16.636 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:16.636 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:16.636 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:16.636 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:16.636 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:16.636 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:16.637 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:16.642 [Time-limited test-SendThread(localhost:46479)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000671a390002.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000671a390002, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:16.743 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000671a390002
16:44:16.743 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000671a390002 closed
16:44:16.743 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:16.743 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:16.754 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-38929 with exitCode 0
16:44:16.754 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:16.754 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:16.754 [SyncThread-109-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:16.756 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:16.756 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:16.756 [BookieJournal-38929] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:16.756 [BookieJournal-38929] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:16.756 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:16.757 [Bookie-38929] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:16.757 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:16.757 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:16.757 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:16.757 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:16.757 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:16.757 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:16.757 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:16.757 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:16.865 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000671a390003 closed
16:44:16.866 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:16.866 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:16.867 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000671a390003
16:44:16.871 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-37769 with exitCode 0
16:44:16.872 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:16.872 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:16.872 [SyncThread-118-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:16.873 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:16.873 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:16.873 [BookieJournal-37769] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:16.873 [BookieJournal-37769] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:16.873 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:16.873 [Bookie-37769] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:16.876 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:16.877 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:16.877 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:16.877 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:16.877 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:16.877 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:16.877 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:16.877 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:16.886 [Time-limited test-SendThread(localhost:46479)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000671a390004.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000671a390004, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:16.986 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000671a390004 closed
16:44:16.987 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000671a390004
16:44:16.988 [Time-limited test-SendThread(localhost:46479)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000671a390000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000671a390000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:17.089 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000671a390000 closed
16:44:17.089 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000671a390000
16:44:17.090 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
16:44:17.090 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
16:44:17.090 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
16:44:17.090 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
16:44:17.090 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
16:44:17.091 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
16:44:17.091 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
16:44:17.091 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
16:44:17.091 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
16:44:17.091 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
16:44:17.091 [ProcessThread(sid:0 cport:46479):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
16:44:17.091 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
16:44:17.091 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
16:44:17.092 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 46479
16:44:17.094 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testReadEntryBeyondLac in 581 ms.
16:44:17.095 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
16:44:17.095 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
16:44:17.095 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
16:44:17.095 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
16:44:17.095 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
16:44:17.095 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
16:44:17.095 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
16:44:17.095 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
16:44:17.095 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
16:44:17.095 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
16:44:17.095 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
16:44:17.095 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
16:44:17.095 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
16:44:17.095 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
16:44:17.095 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
16:44:17.095 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
16:44:17.096 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
16:44:17.096 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
16:44:17.096 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper3029005034295950020test/version-2 snapdir /tmp/zookeeper3029005034295950020test/version-2
16:44:17.096 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
16:44:17.096 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
16:44:17.096 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
16:44:17.097 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper3029005034295950020test/version-2/snapshot.0
16:44:17.097 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 0 ms, highest zxid is 0x0, digest is 1371985504
16:44:17.097 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper3029005034295950020test/version-2/snapshot.0
16:44:17.097 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 0 ms
16:44:17.098 [ProcessThread(sid:0 cport:40225):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
16:44:17.101 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 40225
16:44:17.102 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:52988
16:44:17.102 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
16:44:17.102 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40225 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@25675623
16:44:17.102 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:17.102 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:17.105 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40225.
16:44:17.105 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:17.105 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52990, server: localhost/127.0.0.1:40225
16:44:17.106 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
16:44:17.109 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40225, session id = 0x100006720b00000, negotiated timeout = 10000
16:44:17.109 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:17.117 [BookieDeathWatcher-37769] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:17.117 [BookieDeathWatcher-37769] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37769
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:17.118 [BookieDeathWatcher-37769] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:17.118 [BookieDeathWatcher-37769] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:17.119 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40225/ledgers : zkServers = localhost:40225, ledgersRootPath = /ledgers.
16:44:17.119 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40225 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@33d70266
16:44:17.119 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:17.120 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:17.120 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40225.
16:44:17.120 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:17.120 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52992, server: localhost/127.0.0.1:40225
16:44:17.122 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40225, session id = 0x100006720b00001, negotiated timeout = 10000
16:44:17.122 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:17.123 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:17.123 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
16:44:17.124 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
16:44:17.124 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
16:44:17.133 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:17.133 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie8750632565473084945test",
  "metadataServiceUri" : "zk://localhost:40225/ledgers",
  "journalDirectories" : "/tmp/bookie8750632565473084945test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:17.135 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:17.136 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40225/ledgers : zkServers = localhost:40225, ledgersRootPath = /ledgers.
16:44:17.137 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40225 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@6547649f
16:44:17.137 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:17.137 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:17.141 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40225.
16:44:17.141 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:17.141 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52994, server: localhost/127.0.0.1:40225
16:44:17.142 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40225, session id = 0x100006720b00002, negotiated timeout = 10000
16:44:17.142 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:17.143 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:17.146 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie8750632565473084945test/current] [/tmp/bookie8750632565473084945test/current]
16:44:17.151 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:17.152 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie8750632565473084945test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:17.152 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:17.152 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:17.153 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:17.156 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:17.157 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:17.157 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:17.163 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:44487 to become writable
16:44:17.165 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
16:44:17.167 [SyncThread-139-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:17.168 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:17.169 [BookieJournal-44487] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie8750632565473084945test/current
16:44:17.169 [BookieJournal-44487] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie8750632565473084945test/current/17ce29c2812.txn
16:44:17.170 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:17.182 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:44487 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:44487, port=44487, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:17.182 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:44487
16:44:17.428 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:44487' has been created.
16:44:17.429 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:17.429 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie6748216628709568705test",
  "metadataServiceUri" : "zk://localhost:40225/ledgers",
  "journalDirectories" : "/tmp/bookie6748216628709568705test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:17.430 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:17.435 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40225/ledgers : zkServers = localhost:40225, ledgersRootPath = /ledgers.
16:44:17.435 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40225 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@6e4c7b86
16:44:17.435 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:17.435 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:17.440 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40225.
16:44:17.440 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:17.441 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52996, server: localhost/127.0.0.1:40225
16:44:17.447 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40225, session id = 0x100006720b00003, negotiated timeout = 10000
16:44:17.447 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:17.448 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:17.453 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie6748216628709568705test/current] [/tmp/bookie6748216628709568705test/current]
16:44:17.456 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:17.457 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie6748216628709568705test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:17.457 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:17.457 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:17.457 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:17.458 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:17.458 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:17.458 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:17.462 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:40897 to become writable
16:44:17.463 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
16:44:17.464 [SyncThread-148-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:17.465 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:17.466 [BookieJournal-40897] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie6748216628709568705test/current
16:44:17.469 [BookieJournal-40897] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie6748216628709568705test/current/17ce29c293e.txn
16:44:17.470 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:17.475 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:40897 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:40897, port=40897, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:17.475 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:40897
16:44:17.519 [BookieDeathWatcher-36967] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:17.519 [BookieDeathWatcher-36967] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-36967
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:17.520 [BookieDeathWatcher-36967] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:17.520 [BookieDeathWatcher-36967] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:17.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
16:44:17.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
16:44:17.724 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:40897' has been created.
16:44:17.726 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:17.726 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie5233087069508514434test",
  "metadataServiceUri" : "zk://localhost:40225/ledgers",
  "journalDirectories" : "/tmp/bookie5233087069508514434test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:17.727 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:17.729 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40225/ledgers : zkServers = localhost:40225, ledgersRootPath = /ledgers.
16:44:17.729 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40225 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@629af51d
16:44:17.729 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:17.729 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:17.732 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40225.
16:44:17.732 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:17.732 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52998, server: localhost/127.0.0.1:40225
16:44:17.734 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40225, session id = 0x100006720b00004, negotiated timeout = 10000
16:44:17.734 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:17.735 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:17.741 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie5233087069508514434test/current] [/tmp/bookie5233087069508514434test/current]
16:44:17.745 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:17.746 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie5233087069508514434test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:17.746 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:17.746 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:17.747 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:17.747 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:17.747 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:17.747 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:17.755 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:40053 to become writable
16:44:17.755 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
16:44:17.757 [SyncThread-157-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:17.758 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:17.764 [BookieJournal-40053] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie5233087069508514434test/current
16:44:17.764 [BookieJournal-40053] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie5233087069508514434test/current/17ce29c2a65.txn
16:44:17.765 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:17.769 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:40053 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:40053, port=40053, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:17.769 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:40053
16:44:17.821 [BookieDeathWatcher-38929] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:17.821 [BookieDeathWatcher-38929] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-38929
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:17.821 [BookieDeathWatcher-38929] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:17.821 [BookieDeathWatcher-38929] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:18.020 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:40053' has been created.
16:44:18.021 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testLedgerCreateFails @ metadata service zk://localhost:40225/ledgers in 925 ms.
16:44:18.022 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40225/ledgers : zkServers = localhost:40225, ledgersRootPath = /ledgers.
16:44:18.022 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40225 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@7384a5b1
16:44:18.022 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:18.022 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:18.025 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40225.
16:44:18.025 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:18.025 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:53000, server: localhost/127.0.0.1:40225
16:44:18.027 [Time-limited test-SendThread(localhost:40225)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40225, session id = 0x100006720b00005, negotiated timeout = 10000
16:44:18.027 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:18.028 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:18.028 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
16:44:18.028 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
16:44:18.029 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
16:44:18.033 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:40897 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:40897, port=40897, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:18.033 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:44487 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:44487, port=44487, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:18.033 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:40053 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:40053, port=40053, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:18.033 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:40897
16:44:18.033 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:44487
16:44:18.033 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:40053
16:44:18.034 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
16:44:18.034 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:40897, 127.0.0.1:40053, 127.0.0.1:44487] is not adhering to Placement Policy. quarantinedBookies: []
16:44:18.048 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:40897, 127.0.0.1:40053, 127.0.0.1:44487] for ledger: 0
16:44:18.052 [Time-limited test] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 96 bookies : excludeBookies [<Bookie:127.0.0.1:40897>, <Bookie:127.0.0.1:44487>, <Bookie:127.0.0.1:40053>], allBookies [<Bookie:127.0.0.1:40897>, <Bookie:127.0.0.1:44487>, <Bookie:127.0.0.1:40053>].
16:44:18.052 [Time-limited test] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 96 bookies : excludeBookies [<Bookie:127.0.0.1:40897>, <Bookie:127.0.0.1:44487>, <Bookie:127.0.0.1:40053>], allBookies [<Bookie:127.0.0.1:40897>, <Bookie:127.0.0.1:44487>, <Bookie:127.0.0.1:40053>].
16:44:18.053 [Time-limited test] ERROR org.apache.bookkeeper.client.LedgerCreateOp - Not enough bookies to create ledger with ensembleSize=99, writeQuorumSize=3 and ackQuorumSize=2
16:44:18.058 [Time-limited test-SendThread(localhost:40225)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100006720b00005.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100006720b00005, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:18.160 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006720b00005 closed
16:44:18.160 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
16:44:18.161 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006720b00005
16:44:18.164 [Time-limited test-SendThread(localhost:40225)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100006720b00001.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100006720b00001, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:18.264 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006720b00001 closed
16:44:18.264 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:18.264 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:18.265 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006720b00001
16:44:18.271 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-44487 with exitCode 0
16:44:18.271 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:18.271 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:18.271 [SyncThread-139-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:18.272 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:18.272 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:18.272 [BookieJournal-44487] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:18.272 [BookieJournal-44487] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:18.273 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:18.273 [Bookie-44487] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:18.273 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:18.273 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:18.273 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:18.273 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:18.273 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:18.273 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:18.273 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:18.273 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:18.281 [Time-limited test-SendThread(localhost:40225)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100006720b00002.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100006720b00002, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:18.381 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006720b00002 closed
16:44:18.381 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006720b00002
16:44:18.382 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:18.382 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:18.384 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-40897 with exitCode 0
16:44:18.384 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:18.384 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:18.384 [SyncThread-148-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:18.386 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:18.386 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:18.386 [BookieJournal-40897] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:18.386 [BookieJournal-40897] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:18.386 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:18.386 [Bookie-40897] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:18.386 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:18.386 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:18.386 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:18.386 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:18.386 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:18.387 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:18.387 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:18.387 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:18.395 [Time-limited test-SendThread(localhost:40225)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100006720b00003.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100006720b00003, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:18.495 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006720b00003 closed
16:44:18.495 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006720b00003
16:44:18.495 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:18.495 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:18.498 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-40053 with exitCode 0
16:44:18.498 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:18.498 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:18.498 [SyncThread-157-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:18.500 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:18.500 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:18.500 [BookieJournal-40053] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:18.500 [BookieJournal-40053] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:18.500 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:18.500 [Bookie-40053] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:18.500 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:18.500 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:18.500 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:18.500 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:18.500 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:18.501 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:18.501 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:18.501 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:18.609 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006720b00004 closed
16:44:18.610 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006720b00004
16:44:18.612 [Time-limited test-SendThread(localhost:40225)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100006720b00000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100006720b00000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:18.712 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100006720b00000 closed
16:44:18.712 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100006720b00000
16:44:18.713 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
16:44:18.713 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
16:44:18.713 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
16:44:18.713 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
16:44:18.713 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
16:44:18.717 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
16:44:18.717 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
16:44:18.717 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
16:44:18.717 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
16:44:18.717 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
16:44:18.717 [ProcessThread(sid:0 cport:40225):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
16:44:18.717 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
16:44:18.717 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
16:44:18.718 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 40225
16:44:18.720 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testLedgerCreateFails in 559 ms.
16:44:18.725 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper4658411555025734175test/version-2 snapdir /tmp/zookeeper4658411555025734175test/version-2
16:44:18.726 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
16:44:18.726 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
16:44:18.727 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
16:44:18.727 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper4658411555025734175test/version-2/snapshot.0
16:44:18.727 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 0 ms, highest zxid is 0x0, digest is 1371985504
16:44:18.727 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper4658411555025734175test/version-2/snapshot.0
16:44:18.728 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 1 ms
16:44:18.749 [ProcessThread(sid:0 cport:41891):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
16:44:18.749 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 41891
16:44:18.752 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:33544
16:44:18.752 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
16:44:18.753 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:41891 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@31fecd73
16:44:18.753 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:18.754 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:18.757 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:41891.
16:44:18.757 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:18.757 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:33546, server: localhost/127.0.0.1:41891
16:44:18.769 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
16:44:18.770 [BookieDeathWatcher-40053] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:18.770 [BookieDeathWatcher-40053] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-40053
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:18.770 [BookieDeathWatcher-40053] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:18.770 [BookieDeathWatcher-40053] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:18.773 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:41891, session id = 0x1000067270f0000, negotiated timeout = 10000
16:44:18.773 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:18.781 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:41891/ledgers : zkServers = localhost:41891, ledgersRootPath = /ledgers.
16:44:18.781 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:41891 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@5b79bc04
16:44:18.781 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:18.781 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:18.782 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:41891.
16:44:18.782 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:18.782 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:33548, server: localhost/127.0.0.1:41891
16:44:18.783 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:41891, session id = 0x1000067270f0001, negotiated timeout = 10000
16:44:18.783 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:18.784 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:18.785 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
16:44:18.785 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
16:44:18.785 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
16:44:18.793 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:18.793 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie8634879487015625525test",
  "metadataServiceUri" : "zk://localhost:41891/ledgers",
  "journalDirectories" : "/tmp/bookie8634879487015625525test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:18.794 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:18.796 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:41891/ledgers : zkServers = localhost:41891, ledgersRootPath = /ledgers.
16:44:18.796 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:41891 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@4d5e26de
16:44:18.796 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:18.796 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:18.800 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:41891.
16:44:18.801 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:18.801 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:33550, server: localhost/127.0.0.1:41891
16:44:18.802 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:41891, session id = 0x1000067270f0002, negotiated timeout = 10000
16:44:18.802 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:18.803 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:18.806 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie8634879487015625525test/current] [/tmp/bookie8634879487015625525test/current]
16:44:18.811 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:18.811 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie8634879487015625525test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:18.811 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:18.812 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:18.812 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:18.813 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:18.813 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:18.813 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:18.819 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:45725 to become writable
16:44:18.821 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 1 ms.
16:44:18.821 [SyncThread-178-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:18.822 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:18.827 [BookieJournal-45725] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie8634879487015625525test/current
16:44:18.829 [BookieJournal-45725] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie8634879487015625525test/current/17ce29c2e8e.txn
16:44:18.829 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:18.832 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:45725 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:45725, port=45725, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:18.832 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:45725
16:44:19.082 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:45725' has been created.
16:44:19.083 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:19.083 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie7012385932164524315test",
  "metadataServiceUri" : "zk://localhost:41891/ledgers",
  "journalDirectories" : "/tmp/bookie7012385932164524315test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:19.084 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:19.086 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:41891/ledgers : zkServers = localhost:41891, ledgersRootPath = /ledgers.
16:44:19.086 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:41891 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@78733d4e
16:44:19.086 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:19.086 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:19.087 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:41891.
16:44:19.087 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:19.088 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:33552, server: localhost/127.0.0.1:41891
16:44:19.089 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:41891, session id = 0x1000067270f0003, negotiated timeout = 10000
16:44:19.089 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:19.090 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:19.094 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie7012385932164524315test/current] [/tmp/bookie7012385932164524315test/current]
16:44:19.101 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:19.104 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie7012385932164524315test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:19.104 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:19.104 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:19.105 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:19.105 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:19.105 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:19.105 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:19.109 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:45501 to become writable
16:44:19.113 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 1 ms.
16:44:19.113 [SyncThread-187-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:19.115 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:19.116 [BookieJournal-45501] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie7012385932164524315test/current
16:44:19.120 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:19.120 [BookieJournal-45501] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie7012385932164524315test/current/17ce29c2fb1.txn
16:44:19.124 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:45501 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:45501, port=45501, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:19.124 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:45501
16:44:19.178 [BookieDeathWatcher-44487] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:19.178 [BookieDeathWatcher-44487] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-44487
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:19.178 [BookieDeathWatcher-44487] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:19.178 [BookieDeathWatcher-44487] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:19.375 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:45501' has been created.
16:44:19.377 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:19.377 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie7273413602165874177test",
  "metadataServiceUri" : "zk://localhost:41891/ledgers",
  "journalDirectories" : "/tmp/bookie7273413602165874177test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:19.381 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:19.384 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:41891/ledgers : zkServers = localhost:41891, ledgersRootPath = /ledgers.
16:44:19.384 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:41891 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@23a8a66c
16:44:19.389 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:19.389 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:19.389 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:41891.
16:44:19.389 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:19.390 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:33554, server: localhost/127.0.0.1:41891
16:44:19.392 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:41891, session id = 0x1000067270f0004, negotiated timeout = 10000
16:44:19.392 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:19.393 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:19.398 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie7273413602165874177test/current] [/tmp/bookie7273413602165874177test/current]
16:44:19.401 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:19.402 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie7273413602165874177test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:19.402 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:19.403 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:19.403 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:19.404 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:19.404 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:19.404 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:19.408 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:41571 to become writable
16:44:19.408 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
16:44:19.408 [SyncThread-196-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:19.410 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:19.411 [BookieJournal-41571] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie7273413602165874177test/current
16:44:19.413 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:19.414 [BookieJournal-41571] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie7273413602165874177test/current/17ce29c30d6.txn
16:44:19.420 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:41571 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:41571, port=41571, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:19.420 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:41571
16:44:19.475 [BookieDeathWatcher-40897] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:19.475 [BookieDeathWatcher-40897] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-40897
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:19.475 [BookieDeathWatcher-40897] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:19.475 [BookieDeathWatcher-40897] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:19.669 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:41571' has been created.
16:44:19.672 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testReadFromDeletedLedger @ metadata service zk://localhost:41891/ledgers in 946 ms.
16:44:19.676 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:41891/ledgers : zkServers = localhost:41891, ledgersRootPath = /ledgers.
16:44:19.677 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:41891 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@55045079
16:44:19.677 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:19.677 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:19.677 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:41891.
16:44:19.677 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:19.678 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:33556, server: localhost/127.0.0.1:41891
16:44:19.679 [Time-limited test-SendThread(localhost:41891)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:41891, session id = 0x1000067270f0005, negotiated timeout = 10000
16:44:19.679 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:19.680 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:19.683 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
16:44:19.683 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
16:44:19.684 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
16:44:19.685 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:45501 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:45501, port=45501, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:19.685 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:41571 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:41571, port=41571, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:19.688 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:45725 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:45725, port=45725, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:19.688 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:45501
16:44:19.688 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:41571
16:44:19.688 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:45725
16:44:19.689 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
16:44:19.689 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:45501, 127.0.0.1:41571, 127.0.0.1:45725] is not adhering to Placement Policy. quarantinedBookies: []
16:44:19.696 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:45501, 127.0.0.1:41571, 127.0.0.1:45725] for ledger: 0
16:44:19.707 [bookkeeper-io-202-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:45501 [id: 0xe4fa006e, L:/127.0.0.1:41560 - R:127.0.0.1/127.0.0.1:45501]
16:44:19.710 [bookkeeper-io-202-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xe4fa006e, L:/127.0.0.1:41560 - R:127.0.0.1/127.0.0.1:45501] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:19.714 [bookkeeper-io-202-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:41571 [id: 0x8bedbd3b, L:/127.0.0.1:51278 - R:127.0.0.1/127.0.0.1:41571]
16:44:19.714 [bookie-io-182-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:19.715 [bookkeeper-io-202-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:45725 [id: 0x2571bc15, L:/127.0.0.1:35352 - R:127.0.0.1/127.0.0.1:45725]
16:44:19.715 [bookkeeper-io-202-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x2571bc15, L:/127.0.0.1:35352 - R:127.0.0.1/127.0.0.1:45725] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:19.717 [bookkeeper-io-202-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x8bedbd3b, L:/127.0.0.1:51278 - R:127.0.0.1/127.0.0.1:41571] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:19.718 [bookie-io-182-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xb66974f0, L:/127.0.0.1:45501 - R:/127.0.0.1:41560]
16:44:19.719 [bookie-io-182-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:19.722 [bookie-io-182-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie7012385932164524315test/current/0.log for logId 0.
16:44:19.723 [bookie-io-191-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:19.723 [bookie-io-191-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x5f09f765, L:/127.0.0.1:41571 - R:/127.0.0.1:51278]
16:44:19.724 [bookie-io-191-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:19.727 [bookie-io-191-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie7273413602165874177test/current/0.log for logId 0.
16:44:19.729 [bookie-io-173-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:19.729 [bookie-io-173-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xc071fa56, L:/127.0.0.1:45725 - R:/127.0.0.1:35352]
16:44:19.730 [bookie-io-173-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:19.730 [bookie-io-173-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie8634879487015625525test/current/0.log for logId 0.
16:44:19.766 [Time-limited test] ERROR org.apache.bookkeeper.client.LedgerHandle - ReadEntries exception on ledgerId:0 firstEntry:100 lastEntry:100 lastAddConfirmed:0
16:44:19.766 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:45501
16:44:19.766 [bookkeeper-io-202-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xe4fa006e, L:/127.0.0.1:41560 ! R:127.0.0.1/127.0.0.1:45501]
16:44:19.767 [bookie-io-182-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xb66974f0, L:/127.0.0.1:45501 ! R:/127.0.0.1:41560]
16:44:19.767 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:41571
16:44:19.767 [bookkeeper-io-202-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x8bedbd3b, L:/127.0.0.1:51278 ! R:127.0.0.1/127.0.0.1:41571]
16:44:19.768 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:45725
16:44:19.768 [bookkeeper-io-202-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x2571bc15, L:/127.0.0.1:35352 ! R:127.0.0.1/127.0.0.1:45725]
16:44:19.769 [bookie-io-191-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x5f09f765, L:/127.0.0.1:41571 ! R:/127.0.0.1:51278]
16:44:19.769 [bookie-io-173-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xc071fa56, L:/127.0.0.1:45725 ! R:/127.0.0.1:35352]
16:44:19.871 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x1000067270f0005 closed
16:44:19.872 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
16:44:19.872 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x1000067270f0005
16:44:19.974 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x1000067270f0001 closed
16:44:19.974 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:19.974 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:19.975 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x1000067270f0001
16:44:19.976 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-45725 with exitCode 0
16:44:19.976 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:19.976 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:19.978 [SyncThread-178-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635889458830 , logFileOffset - 1024]}.
16:44:19.987 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:19.987 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:19.987 [BookieJournal-45725] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:19.987 [BookieJournal-45725] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:19.987 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:19.987 [Bookie-45725] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:19.987 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:19.987 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:19.987 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:19.987 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:19.987 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:19.988 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:19.988 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:19.988 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:19.988 [pool-126-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-126-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:19.995 [Time-limited test-SendThread(localhost:41891)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x1000067270f0002.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x1000067270f0002, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:20.096 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x1000067270f0002 closed
16:44:20.096 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x1000067270f0002
16:44:20.096 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:20.096 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:20.101 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-45501 with exitCode 0
16:44:20.101 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:20.101 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:20.112 [SyncThread-187-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635889459121 , logFileOffset - 1024]}.
16:44:20.121 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:20.121 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:20.121 [BookieJournal-45501] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:20.121 [BookieJournal-45501] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:20.122 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:20.122 [Bookie-45501] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:20.122 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:20.122 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:20.122 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:20.122 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:20.122 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:20.122 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:20.123 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:20.123 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:20.123 [pool-132-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-132-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:20.131 [Time-limited test-SendThread(localhost:41891)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x1000067270f0003.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x1000067270f0003, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:20.231 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x1000067270f0003 closed
16:44:20.232 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:20.232 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:20.232 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x1000067270f0003
16:44:20.233 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-41571 with exitCode 0
16:44:20.233 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:20.233 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:20.245 [SyncThread-196-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635889459414 , logFileOffset - 1536]}.
16:44:20.253 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:20.253 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:20.254 [BookieJournal-41571] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:20.254 [BookieJournal-41571] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:20.254 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:20.254 [Bookie-41571] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:20.254 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:20.254 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:20.254 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:20.254 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:20.254 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:20.255 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:20.255 [pool-138-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-138-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:20.256 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:20.256 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:20.362 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x1000067270f0004 closed
16:44:20.363 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x1000067270f0004
16:44:20.364 [Time-limited test-SendThread(localhost:41891)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x1000067270f0000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x1000067270f0000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:20.419 [BookieDeathWatcher-41571] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:20.419 [BookieDeathWatcher-41571] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-41571
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:20.420 [BookieDeathWatcher-41571] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:20.420 [BookieDeathWatcher-41571] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:20.464 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x1000067270f0000 closed
16:44:20.465 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x1000067270f0000
16:44:20.465 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
16:44:20.465 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
16:44:20.465 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
16:44:20.466 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
16:44:20.466 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
16:44:20.466 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
16:44:20.466 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
16:44:20.466 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
16:44:20.466 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
16:44:20.466 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
16:44:20.466 [ProcessThread(sid:0 cport:41891):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
16:44:20.466 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
16:44:20.466 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
16:44:20.467 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 41891
16:44:20.469 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testReadFromDeletedLedger in 596 ms.
16:44:20.470 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
16:44:20.470 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
16:44:20.470 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
16:44:20.470 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
16:44:20.470 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
16:44:20.470 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
16:44:20.470 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
16:44:20.470 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
16:44:20.470 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
16:44:20.470 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
16:44:20.470 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
16:44:20.470 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
16:44:20.470 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
16:44:20.470 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
16:44:20.470 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
16:44:20.470 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
16:44:20.471 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
16:44:20.471 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
16:44:20.472 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper3730287128506666568test/version-2 snapdir /tmp/zookeeper3730287128506666568test/version-2
16:44:20.472 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
16:44:20.472 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
16:44:20.472 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
16:44:20.476 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper3730287128506666568test/version-2/snapshot.0
16:44:20.476 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 0 ms, highest zxid is 0x0, digest is 1371985504
16:44:20.476 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper3730287128506666568test/version-2/snapshot.0
16:44:20.476 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 0 ms
16:44:20.477 [ProcessThread(sid:0 cport:39461):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
16:44:20.477 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 39461
16:44:20.478 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:52242
16:44:20.478 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
16:44:20.479 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39461 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@1730faca
16:44:20.479 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:20.480 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:20.485 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39461.
16:44:20.485 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:20.485 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52244, server: localhost/127.0.0.1:39461
16:44:20.489 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
16:44:20.492 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39461, session id = 0x10000672de30000, negotiated timeout = 10000
16:44:20.492 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:20.500 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39461/ledgers : zkServers = localhost:39461, ledgersRootPath = /ledgers.
16:44:20.500 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39461 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@1c111398
16:44:20.500 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:20.500 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:20.505 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39461.
16:44:20.505 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:20.505 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52246, server: localhost/127.0.0.1:39461
16:44:20.506 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39461, session id = 0x10000672de30001, negotiated timeout = 10000
16:44:20.506 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:20.507 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:20.507 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
16:44:20.507 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
16:44:20.508 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
16:44:20.514 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:20.514 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie8600652819046697801test",
  "metadataServiceUri" : "zk://localhost:39461/ledgers",
  "journalDirectories" : "/tmp/bookie8600652819046697801test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:20.516 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:20.517 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39461/ledgers : zkServers = localhost:39461, ledgersRootPath = /ledgers.
16:44:20.517 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39461 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@3e6187d2
16:44:20.517 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:20.517 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:20.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
16:44:20.525 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
16:44:20.525 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39461.
16:44:20.525 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:20.525 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52248, server: localhost/127.0.0.1:39461
16:44:20.526 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39461, session id = 0x10000672de30002, negotiated timeout = 10000
16:44:20.528 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:20.531 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:20.537 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie8600652819046697801test/current] [/tmp/bookie8600652819046697801test/current]
16:44:20.541 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:20.542 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie8600652819046697801test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:20.542 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:20.542 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:20.542 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:20.543 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:20.543 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:20.543 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:20.553 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:44445 to become writable
16:44:20.553 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
16:44:20.553 [SyncThread-217-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:20.555 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:20.555 [BookieJournal-44445] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie8600652819046697801test/current
16:44:20.556 [BookieJournal-44445] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie8600652819046697801test/current/17ce29c354d.txn
16:44:20.557 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:20.568 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:44445 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:44445, port=44445, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:20.569 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:44445
16:44:20.814 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:44445' has been created.
16:44:20.815 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:20.815 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie5271999140882510819test",
  "metadataServiceUri" : "zk://localhost:39461/ledgers",
  "journalDirectories" : "/tmp/bookie5271999140882510819test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:20.817 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:20.818 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39461/ledgers : zkServers = localhost:39461, ledgersRootPath = /ledgers.
16:44:20.818 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39461 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@165339ce
16:44:20.818 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:20.818 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:20.821 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39461.
16:44:20.821 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:20.821 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52250, server: localhost/127.0.0.1:39461
16:44:20.825 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39461, session id = 0x10000672de30003, negotiated timeout = 10000
16:44:20.825 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:20.826 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:20.828 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie5271999140882510819test/current] [/tmp/bookie5271999140882510819test/current]
16:44:20.832 [BookieDeathWatcher-45725] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:20.832 [BookieDeathWatcher-45725] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45725
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:20.832 [BookieDeathWatcher-45725] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:20.832 [BookieDeathWatcher-45725] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:20.834 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:20.835 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie5271999140882510819test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:20.835 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:20.835 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:20.835 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:20.836 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:20.836 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:20.836 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:20.841 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:33783 to become writable
16:44:20.842 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
16:44:20.842 [SyncThread-226-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:20.843 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:20.845 [BookieJournal-33783] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie5271999140882510819test/current
16:44:20.845 [BookieJournal-33783] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie5271999140882510819test/current/17ce29c366e.txn
16:44:20.846 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:20.853 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:33783 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:33783, port=33783, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:20.853 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:33783
16:44:21.103 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:33783' has been created.
16:44:21.104 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:21.104 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie8603582384244354842test",
  "metadataServiceUri" : "zk://localhost:39461/ledgers",
  "journalDirectories" : "/tmp/bookie8603582384244354842test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:21.105 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:21.107 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39461/ledgers : zkServers = localhost:39461, ledgersRootPath = /ledgers.
16:44:21.107 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39461 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@2014656
16:44:21.107 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:21.107 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:21.108 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39461.
16:44:21.108 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:21.108 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52252, server: localhost/127.0.0.1:39461
16:44:21.109 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39461, session id = 0x10000672de30004, negotiated timeout = 10000
16:44:21.109 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:21.111 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:21.115 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie8603582384244354842test/current] [/tmp/bookie8603582384244354842test/current]
16:44:21.118 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:21.119 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie8603582384244354842test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:21.119 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:21.119 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:21.119 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:21.120 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:21.120 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:21.120 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:21.123 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:37963 to become writable
16:44:21.124 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
16:44:21.125 [SyncThread-235-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:21.126 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:21.127 [BookieJournal-37963] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie8603582384244354842test/current
16:44:21.127 [BookieDeathWatcher-45501] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:21.128 [BookieDeathWatcher-45501] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45501
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:21.132 [BookieDeathWatcher-45501] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:21.132 [BookieDeathWatcher-45501] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:21.134 [BookieJournal-37963] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie8603582384244354842test/current/17ce29c378f.txn
16:44:21.137 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:21.137 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:37963 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:37963, port=37963, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:21.137 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:37963
16:44:21.386 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:37963' has been created.
16:44:21.386 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testAddFailsWithReadOnlyBookie @ metadata service zk://localhost:39461/ledgers in 916 ms.
16:44:21.387 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39461/ledgers : zkServers = localhost:39461, ledgersRootPath = /ledgers.
16:44:21.388 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39461 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@5eb12ccb
16:44:21.388 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:21.388 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:21.388 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39461.
16:44:21.388 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:21.389 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:52254, server: localhost/127.0.0.1:39461
16:44:21.390 [Time-limited test-SendThread(localhost:39461)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39461, session id = 0x10000672de30005, negotiated timeout = 10000
16:44:21.390 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:21.392 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:21.392 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
16:44:21.392 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
16:44:21.392 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
16:44:21.394 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:37963 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:37963, port=37963, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:21.394 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:33783 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:33783, port=33783, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:21.394 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:44445 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:44445, port=44445, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:21.394 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:37963
16:44:21.394 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:33783
16:44:21.394 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:44445
16:44:21.395 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
16:44:21.395 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:33783, 127.0.0.1:37963, 127.0.0.1:44445] is not adhering to Placement Policy. quarantinedBookies: []
16:44:21.405 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:33783, 127.0.0.1:37963, 127.0.0.1:44445] for ledger: 0
16:44:21.409 [Time-limited test] WARN  org.apache.bookkeeper.bookie.LedgerDirsManager - /tmp/bookie8600652819046697801test/current is out of space. Adding it to filled dirs list
16:44:21.409 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Major Compaction triggered by thread: Time-limited test
16:44:21.409 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Minor Compaction triggered by thread: Time-limited test
16:44:21.409 [Time-limited test] WARN  org.apache.bookkeeper.bookie.LedgerDirsManager - /tmp/bookie5271999140882510819test/current is out of space. Adding it to filled dirs list
16:44:21.409 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Major Compaction triggered by thread: Time-limited test
16:44:21.409 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Minor Compaction triggered by thread: Time-limited test
16:44:21.409 [Time-limited test] WARN  org.apache.bookkeeper.bookie.LedgerDirsManager - /tmp/bookie8603582384244354842test/current is out of space. Adding it to filled dirs list
16:44:21.409 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Major Compaction triggered by thread: Time-limited test
16:44:21.409 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Minor Compaction triggered by thread: Time-limited test
16:44:21.417 [bookkeeper-io-241-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:33783 [id: 0xe779edd7, L:/127.0.0.1:49914 - R:127.0.0.1/127.0.0.1:33783]
16:44:21.418 [bookie-io-221-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:21.428 [bookie-io-221-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x4bbc7053, L:/127.0.0.1:33783 - R:/127.0.0.1:49914]
16:44:21.429 [bookkeeper-io-241-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xe779edd7, L:/127.0.0.1:49914 - R:127.0.0.1/127.0.0.1:33783] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:21.430 [bookie-io-221-2] INFO  org.apache.bookkeeper.bookie.LedgerDirsManager - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/bookie5271999140882510819test/current]
16:44:21.431 [bookie-io-221-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:21.432 [bookie-io-221-2] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:21.433 [bookkeeper-io-241-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:37963 [id: 0xfcc5c8af, L:/127.0.0.1:59042 - R:127.0.0.1/127.0.0.1:37963]
16:44:21.433 [bookkeeper-io-241-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xfcc5c8af, L:/127.0.0.1:59042 - R:127.0.0.1/127.0.0.1:37963] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:21.434 [bookie-io-230-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:21.434 [bookie-io-230-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x9d43d140, L:/127.0.0.1:37963 - R:/127.0.0.1:59042]
16:44:21.435 [bookie-io-230-2] INFO  org.apache.bookkeeper.bookie.LedgerDirsManager - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/bookie8603582384244354842test/current]
16:44:21.435 [bookie-io-230-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:21.435 [bookie-io-230-2] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:21.437 [BookieStateManagerService-0] INFO  org.apache.bookkeeper.bookie.BookieStateManager - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
16:44:21.437 [bookie-io-221-2] ERROR org.apache.bookkeeper.proto.WriteEntryProcessorV3 - Error writing entry:0 to ledger:0
java.io.IOException: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1419) ~[classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) ~[classes/:?]
	... 34 more
16:44:21.440 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Add for failed on bookie 127.0.0.1:33783 code EIO
16:44:21.441 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (0, 0): Write failed on bookie
16:44:21.441 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:37963>, <Bookie:127.0.0.1:33783>, <Bookie:127.0.0.1:44445>], allBookies [<Bookie:127.0.0.1:37963>, <Bookie:127.0.0.1:44445>, <Bookie:127.0.0.1:33783>].
16:44:21.442 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:37963>, <Bookie:127.0.0.1:33783>, <Bookie:127.0.0.1:44445>], fallback to choose bookie randomly from the cluster.
16:44:21.442 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:37963>, <Bookie:127.0.0.1:33783>, <Bookie:127.0.0.1:44445>], allBookies [<Bookie:127.0.0.1:44445>, <Bookie:127.0.0.1:37963>, <Bookie:127.0.0.1:33783>].
16:44:21.442 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:37963>, <Bookie:127.0.0.1:33783>, <Bookie:127.0.0.1:44445>], allBookies [<Bookie:127.0.0.1:37963>, <Bookie:127.0.0.1:44445>, <Bookie:127.0.0.1:33783>].
16:44:21.443 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:37963>, <Bookie:127.0.0.1:33783>, <Bookie:127.0.0.1:44445>], fallback to choose bookie randomly from the cluster.
16:44:21.443 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:37963>, <Bookie:127.0.0.1:33783>, <Bookie:127.0.0.1:44445>], allBookies [<Bookie:127.0.0.1:44445>, <Bookie:127.0.0.1:33783>, <Bookie:127.0.0.1:37963>].
16:44:21.443 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.MetadataUpdateLoop - UpdateLoop(ledgerId=0,loopId=326eef2c) Exception updating
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:780) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:698) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:587) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:206) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:547) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:227) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:475) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:120) ~[classes/:?]
	at org.apache.bookkeeper.client.BookieWatcherImpl.replaceBookie(BookieWatcherImpl.java:334) ~[classes/:?]
	at org.apache.bookkeeper.client.EnsembleUtils.replaceBookiesInEnsemble(EnsembleUtils.java:71) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.lambda$ensembleChangeLoop$2(LedgerHandle.java:1935) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.writeLoop(MetadataUpdateLoop.java:134) [classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.run(MetadataUpdateLoop.java:123) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.ensembleChangeLoop(LedgerHandle.java:1954) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.handleBookieFailure(LedgerHandle.java:1903) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:378) [classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.writeComplete(PerChannelBookieClient.java:2159) [classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.handleResponse(PerChannelBookieClient.java:2216) [classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.handleV3Response(PerChannelBookieClient.java:2205) [classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$3.safeRun(PerChannelBookieClient.java:1473) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:21.445 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:33783
16:44:21.445 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:33783
16:44:21.446 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:33783
16:44:21.446 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:33783
16:44:21.447 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.LedgerHandle - [EnsembleChange(ledger:0, change-id:0000000001)][attempt:1] Exception changing ensemble
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:780) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:698) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:587) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:206) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:547) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:227) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:475) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:120) ~[classes/:?]
	at org.apache.bookkeeper.client.BookieWatcherImpl.replaceBookie(BookieWatcherImpl.java:334) ~[classes/:?]
	at org.apache.bookkeeper.client.EnsembleUtils.replaceBookiesInEnsemble(EnsembleUtils.java:71) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.lambda$ensembleChangeLoop$2(LedgerHandle.java:1935) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.writeLoop(MetadataUpdateLoop.java:134) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.run(MetadataUpdateLoop.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.ensembleChangeLoop(LedgerHandle.java:1954) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.handleBookieFailure(LedgerHandle.java:1903) ~[classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:378) ~[classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.writeComplete(PerChannelBookieClient.java:2159) ~[classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.handleResponse(PerChannelBookieClient.java:2216) ~[classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.handleV3Response(PerChannelBookieClient.java:2205) ~[classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$3.safeRun(PerChannelBookieClient.java:1473) ~[classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:21.447 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.LedgerHandle - Closing ledger 0 due to NotEnoughBookiesException: Not enough non-faulty bookies available
16:44:21.453 [BookieStateManagerService-0] INFO  org.apache.bookkeeper.bookie.BookieStateManager - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
16:44:21.455 [bookkeeper-io-241-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:44445 [id: 0x418c4248, L:/127.0.0.1:57428 - R:127.0.0.1/127.0.0.1:44445]
16:44:21.455 [bookie-io-212-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:21.455 [bookkeeper-io-241-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x418c4248, L:/127.0.0.1:57428 - R:127.0.0.1/127.0.0.1:44445] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:21.455 [bookie-io-212-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x4c35e805, L:/127.0.0.1:44445 - R:/127.0.0.1:57428]
16:44:21.455 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L0 E0
16:44:21.456 [bookie-io-230-2] ERROR org.apache.bookkeeper.proto.WriteEntryProcessorV3 - Error writing entry:0 to ledger:0
java.io.IOException: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1419) ~[classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) ~[classes/:?]
	... 34 more
16:44:21.457 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Add for failed on bookie 127.0.0.1:37963 code EIO
16:44:21.457 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (0, 0): Write failed on bookie
16:44:21.458 [bookie-io-212-2] INFO  org.apache.bookkeeper.bookie.LedgerDirsManager - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/bookie8600652819046697801test/current]
16:44:21.458 [bookie-io-212-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:21.458 [bookie-io-212-2] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:21.459 [BookieStateManagerService-0] INFO  org.apache.bookkeeper.bookie.BookieStateManager - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
16:44:21.460 [bookie-io-212-2] ERROR org.apache.bookkeeper.proto.WriteEntryProcessorV3 - Error writing entry:0 to ledger:0
java.io.IOException: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1419) ~[classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) ~[classes/:?]
	... 34 more
16:44:21.461 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Add for failed on bookie 127.0.0.1:44445 code EIO
16:44:21.461 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (0, 0): Write failed on bookie
16:44:21.463 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:37963
16:44:21.463 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:33783
16:44:21.463 [bookkeeper-io-241-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xfcc5c8af, L:/127.0.0.1:59042 ! R:127.0.0.1/127.0.0.1:37963]
16:44:21.463 [bookkeeper-io-241-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xe779edd7, L:/127.0.0.1:49914 ! R:127.0.0.1/127.0.0.1:33783]
16:44:21.464 [bookie-io-221-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x4bbc7053, L:/127.0.0.1:33783 ! R:/127.0.0.1:49914]
16:44:21.464 [bookie-io-230-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x9d43d140, L:/127.0.0.1:37963 ! R:/127.0.0.1:59042]
16:44:21.464 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:44445
16:44:21.465 [bookkeeper-io-241-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x418c4248, L:/127.0.0.1:57428 ! R:127.0.0.1/127.0.0.1:44445]
16:44:21.466 [bookie-io-212-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x4c35e805, L:/127.0.0.1:44445 ! R:/127.0.0.1:57428]
16:44:21.466 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:37963
16:44:21.466 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:37963
16:44:21.466 [Time-limited test-EventThread] WARN  org.apache.bookkeeper.discover.ZKRegistrationClient - Failed to schedule watch bookies task
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@444f3f4c rejected from java.util.concurrent.ScheduledThreadPoolExecutor@14da9a1[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 10]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830) ~[?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326) ~[?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533) ~[?:1.8.0_292]
	at com.google.common.util.concurrent.MoreExecutors$ScheduledListeningDecorator.schedule(MoreExecutors.java:630) ~[guava-30.0-jre.jar:?]
	at org.apache.bookkeeper.common.util.BoundedScheduledExecutorService.schedule(BoundedScheduledExecutorService.java:63) ~[classes/:?]
	at org.apache.bookkeeper.common.util.OrderedScheduler$OrderedSchedulerDecoratedThread.schedule(OrderedScheduler.java:317) ~[classes/:?]
	at org.apache.bookkeeper.common.util.OrderedScheduler.schedule(OrderedScheduler.java:273) ~[classes/:?]
	at org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask.scheduleWatchTask(ZKRegistrationClient.java:115) [classes/:?]
	at org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask.process(ZKRegistrationClient.java:164) [classes/:?]
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:587) [zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:562) [zookeeper-3.6.2.jar:3.6.2]
16:44:21.467 [Time-limited test-EventThread] WARN  org.apache.bookkeeper.discover.ZKRegistrationClient - Failed to schedule watch bookies task
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@75af1b00 rejected from java.util.concurrent.ScheduledThreadPoolExecutor@14da9a1[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 10]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830) ~[?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326) ~[?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533) ~[?:1.8.0_292]
	at com.google.common.util.concurrent.MoreExecutors$ScheduledListeningDecorator.schedule(MoreExecutors.java:630) ~[guava-30.0-jre.jar:?]
	at org.apache.bookkeeper.common.util.BoundedScheduledExecutorService.schedule(BoundedScheduledExecutorService.java:63) ~[classes/:?]
	at org.apache.bookkeeper.common.util.OrderedScheduler$OrderedSchedulerDecoratedThread.schedule(OrderedScheduler.java:317) ~[classes/:?]
	at org.apache.bookkeeper.common.util.OrderedScheduler.schedule(OrderedScheduler.java:273) ~[classes/:?]
	at org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask.scheduleWatchTask(ZKRegistrationClient.java:115) [classes/:?]
	at org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask.process(ZKRegistrationClient.java:164) [classes/:?]
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:587) [zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:562) [zookeeper-3.6.2.jar:3.6.2]
16:44:21.468 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:37963
16:44:21.476 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:44445
16:44:21.476 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:44445
16:44:21.476 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (readonly bookie) 127.0.0.1:37963 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:37963, port=37963, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:21.476 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (readonly bookie) 127.0.0.1:33783 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:33783, port=33783, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:21.477 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:44445
16:44:21.478 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (readonly bookie) 127.0.0.1:37963 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:37963, port=37963, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:21.478 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (readonly bookie) 127.0.0.1:33783 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:33783, port=33783, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:21.478 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (readonly bookie) 127.0.0.1:44445 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:44445, port=44445, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:21.557 [GarbageCollectorThread-218-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Disk almost full, suspend major compaction to slow down filling disk.
16:44:21.557 [GarbageCollectorThread-218-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Disk full, suspend minor compaction to slow down filling disk.
16:44:21.577 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000672de30005 closed
16:44:21.577 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
16:44:21.578 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000672de30005
16:44:21.680 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000672de30001
16:44:21.680 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000672de30001 closed
16:44:21.681 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:21.681 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:21.682 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-44445 with exitCode 0
16:44:21.682 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:21.682 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:21.682 [SyncThread-217-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:21.682 [SyncThread-217-1] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:21.682 [SyncThread-217-1] ERROR org.apache.bookkeeper.bookie.SyncThread - Exception marking checkpoint as complete
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:21.688 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:21.688 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:21.688 [BookieJournal-44445] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:21.688 [BookieJournal-44445] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:21.688 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:21.688 [Bookie-44445] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:21.688 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:21.688 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:21.688 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:21.688 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:21.688 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:21.689 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:21.689 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:21.689 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:21.691 [Time-limited test-SendThread(localhost:39461)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000672de30002.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000672de30002, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:21.792 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000672de30002 closed
16:44:21.792 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:21.792 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:21.792 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000672de30002
16:44:21.794 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-33783 with exitCode 0
16:44:21.794 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:21.794 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:21.795 [SyncThread-226-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:21.795 [SyncThread-226-1] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:21.795 [SyncThread-226-1] ERROR org.apache.bookkeeper.bookie.SyncThread - Exception marking checkpoint as complete
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:21.795 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:21.796 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:21.796 [BookieJournal-33783] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:21.796 [BookieJournal-33783] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:21.796 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:21.796 [Bookie-33783] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:21.796 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:21.796 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:21.796 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:21.796 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:21.796 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:21.796 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:21.797 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:21.797 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:21.799 [Time-limited test-SendThread(localhost:39461)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000672de30003.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000672de30003, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:21.899 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000672de30003 closed
16:44:21.899 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:21.899 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:21.899 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000672de30003
16:44:21.907 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-37963 with exitCode 0
16:44:21.907 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:21.907 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:21.907 [SyncThread-235-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:21.907 [SyncThread-235-1] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:21.907 [SyncThread-235-1] ERROR org.apache.bookkeeper.bookie.SyncThread - Exception marking checkpoint as complete
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:21.908 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:21.908 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:21.908 [BookieJournal-37963] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:21.908 [BookieJournal-37963] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:21.908 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:21.908 [Bookie-37963] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:21.908 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:21.908 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:21.908 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:21.908 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:21.908 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:21.912 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:21.912 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:21.912 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:21.914 [Time-limited test-SendThread(localhost:39461)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000672de30004.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000672de30004, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:22.014 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000672de30004 closed
16:44:22.015 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000672de30004
16:44:22.017 [Time-limited test-SendThread(localhost:39461)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x10000672de30000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x10000672de30000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:22.117 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x10000672de30000 closed
16:44:22.117 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x10000672de30000
16:44:22.117 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
16:44:22.117 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
16:44:22.118 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
16:44:22.118 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
16:44:22.118 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
16:44:22.118 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
16:44:22.118 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
16:44:22.118 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
16:44:22.118 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
16:44:22.118 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
16:44:22.118 [ProcessThread(sid:0 cport:39461):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
16:44:22.118 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
16:44:22.119 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
16:44:22.119 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 39461
16:44:22.122 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testAddFailsWithReadOnlyBookie in 544 ms.
16:44:22.125 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
16:44:22.125 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper769189847576036562test/version-2 snapdir /tmp/zookeeper769189847576036562test/version-2
16:44:22.125 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
16:44:22.126 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
16:44:22.126 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
16:44:22.131 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper769189847576036562test/version-2/snapshot.0
16:44:22.131 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 0 ms, highest zxid is 0x0, digest is 1371985504
16:44:22.131 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper769189847576036562test/version-2/snapshot.0
16:44:22.131 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 0 ms
16:44:22.132 [ProcessThread(sid:0 cport:40923):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
16:44:22.132 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 40923
16:44:22.133 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:50324
16:44:22.133 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
16:44:22.133 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40923 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@47dae801
16:44:22.133 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:22.133 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:22.137 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40923.
16:44:22.137 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:22.137 [BookieDeathWatcher-37963] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:22.137 [BookieDeathWatcher-37963] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37963
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:22.137 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:50326, server: localhost/127.0.0.1:40923
16:44:22.137 [BookieDeathWatcher-37963] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:22.137 [BookieDeathWatcher-37963] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:22.138 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
16:44:22.140 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40923, session id = 0x1000067345a0000, negotiated timeout = 10000
16:44:22.140 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:22.149 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40923/ledgers : zkServers = localhost:40923, ledgersRootPath = /ledgers.
16:44:22.149 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40923 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@4b92ef22
16:44:22.150 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:22.150 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:22.150 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40923.
16:44:22.150 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:22.150 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:50328, server: localhost/127.0.0.1:40923
16:44:22.151 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40923, session id = 0x1000067345a0001, negotiated timeout = 10000
16:44:22.151 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:22.152 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:22.153 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
16:44:22.153 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
16:44:22.153 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
16:44:22.161 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:22.161 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie1279568970633229549test",
  "metadataServiceUri" : "zk://localhost:40923/ledgers",
  "journalDirectories" : "/tmp/bookie1279568970633229549test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:22.162 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:22.163 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40923/ledgers : zkServers = localhost:40923, ledgersRootPath = /ledgers.
16:44:22.163 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40923 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@42a6c655
16:44:22.163 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:22.163 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:22.168 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40923.
16:44:22.168 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:22.168 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:50330, server: localhost/127.0.0.1:40923
16:44:22.169 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40923, session id = 0x1000067345a0002, negotiated timeout = 10000
16:44:22.169 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:22.170 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:22.174 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie1279568970633229549test/current] [/tmp/bookie1279568970633229549test/current]
16:44:22.178 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:22.179 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie1279568970633229549test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:22.179 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:22.179 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:22.179 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:22.179 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:22.180 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:22.180 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:22.185 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:39919 to become writable
16:44:22.185 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
16:44:22.186 [SyncThread-256-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:22.187 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:22.187 [BookieJournal-39919] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie1279568970633229549test/current
16:44:22.190 [BookieJournal-39919] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie1279568970633229549test/current/17ce29c3bae.txn
16:44:22.193 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:22.197 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:39919 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:39919, port=39919, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:22.197 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:39919
16:44:22.446 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:39919' has been created.
16:44:22.447 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:22.447 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie2569594693678648166test",
  "metadataServiceUri" : "zk://localhost:40923/ledgers",
  "journalDirectories" : "/tmp/bookie2569594693678648166test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:22.449 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:22.450 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40923/ledgers : zkServers = localhost:40923, ledgersRootPath = /ledgers.
16:44:22.450 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40923 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@2487aa6b
16:44:22.450 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:22.450 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:22.452 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40923.
16:44:22.452 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:22.452 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:50332, server: localhost/127.0.0.1:40923
16:44:22.453 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40923, session id = 0x1000067345a0003, negotiated timeout = 10000
16:44:22.453 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:22.455 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:22.459 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie2569594693678648166test/current] [/tmp/bookie2569594693678648166test/current]
16:44:22.462 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:22.464 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie2569594693678648166test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:22.464 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:22.464 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:22.464 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:22.466 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:22.466 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:22.466 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:22.468 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:43903 to become writable
16:44:22.472 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
16:44:22.473 [SyncThread-265-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:22.474 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:22.475 [BookieJournal-43903] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie2569594693678648166test/current
16:44:22.476 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:22.477 [BookieJournal-43903] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie2569594693678648166test/current/17ce29c3ccd.txn
16:44:22.484 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:43903 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:43903, port=43903, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:22.484 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:43903
16:44:22.564 [BookieDeathWatcher-44445] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:22.564 [BookieDeathWatcher-44445] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-44445
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:22.565 [BookieDeathWatcher-44445] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:22.565 [BookieDeathWatcher-44445] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:22.733 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:43903' has been created.
16:44:22.734 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
16:44:22.735 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageThreshold" : "0.999",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie1146992688460898373test",
  "metadataServiceUri" : "zk://localhost:40923/ledgers",
  "journalDirectories" : "/tmp/bookie1146992688460898373test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "preserveMdcForTaskExecution" : "true",
  "numAddWorkerThreads" : "0"
}
16:44:22.736 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
16:44:22.737 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40923/ledgers : zkServers = localhost:40923, ledgersRootPath = /ledgers.
16:44:22.737 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40923 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@6cafd9
16:44:22.737 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:22.737 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:22.739 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40923.
16:44:22.739 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:22.739 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:50334, server: localhost/127.0.0.1:40923
16:44:22.741 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40923, session id = 0x1000067345a0004, negotiated timeout = 10000
16:44:22.741 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:22.743 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
16:44:22.746 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie1146992688460898373test/current] [/tmp/bookie1146992688460898373test/current]
16:44:22.751 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
16:44:22.751 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie1146992688460898373test/current/lastMark (this is okay if it is the first time starting this bookie
16:44:22.751 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
16:44:22.751 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
16:44:22.752 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
16:44:22.752 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
16:44:22.752 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
16:44:22.752 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
16:44:22.759 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:39287 to become writable
16:44:22.761 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 1 ms.
16:44:22.761 [SyncThread-274-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
16:44:22.762 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
16:44:22.765 [BookieJournal-39287] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie1146992688460898373test/current
16:44:22.769 [BookieJournal-39287] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie1146992688460898373test/current/17ce29c3dee.txn
16:44:22.773 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
16:44:22.781 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:39287 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:39287, port=39287, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:22.781 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:39287
16:44:22.853 [BookieDeathWatcher-33783] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:22.853 [BookieDeathWatcher-33783] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-33783
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:22.853 [BookieDeathWatcher-33783] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:22.853 [BookieDeathWatcher-33783] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:23.031 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:39287' has been created.
16:44:23.031 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testAddFailsDuplicateEntry @ metadata service zk://localhost:40923/ledgers in 906 ms.
16:44:23.037 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40923/ledgers : zkServers = localhost:40923, ledgersRootPath = /ledgers.
16:44:23.037 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40923 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@56dc3c81
16:44:23.037 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
16:44:23.037 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
16:44:23.038 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40923.
16:44:23.038 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
16:44:23.038 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:50336, server: localhost/127.0.0.1:40923
16:44:23.040 [Time-limited test-SendThread(localhost:40923)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40923, session id = 0x1000067345a0005, negotiated timeout = 10000
16:44:23.040 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
16:44:23.041 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:23.041 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
16:44:23.041 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
16:44:23.041 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
16:44:23.043 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:43903 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:43903, port=43903, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:23.043 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:39919 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:39919, port=39919, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:23.044 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:39287 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:39287, port=39287, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
16:44:23.045 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:43903
16:44:23.045 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:39919
16:44:23.045 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:39287
16:44:23.046 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
16:44:23.046 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:39287, 127.0.0.1:39919, 127.0.0.1:43903] is not adhering to Placement Policy. quarantinedBookies: []
16:44:23.058 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:39287, 127.0.0.1:39919, 127.0.0.1:43903] for ledger: 0
16:44:23.065 [bookkeeper-io-280-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:39287 [id: 0x2a7bf8be, L:/127.0.0.1:53672 - R:127.0.0.1/127.0.0.1:39287]
16:44:23.067 [bookie-io-269-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:23.069 [bookie-io-260-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:23.070 [bookie-io-269-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x30dc3290, L:/127.0.0.1:39287 - R:/127.0.0.1:53672]
16:44:23.073 [bookkeeper-io-280-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x2a7bf8be, L:/127.0.0.1:53672 - R:127.0.0.1/127.0.0.1:39287] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:23.073 [bookkeeper-io-280-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:43903 [id: 0xbd0093d8, L:/127.0.0.1:35060 - R:127.0.0.1/127.0.0.1:43903]
16:44:23.074 [bookkeeper-io-280-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xbd0093d8, L:/127.0.0.1:35060 - R:127.0.0.1/127.0.0.1:43903] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:23.074 [bookie-io-269-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:23.074 [bookie-io-260-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xcbb1c431, L:/127.0.0.1:43903 - R:/127.0.0.1:35060]
16:44:23.075 [bookie-io-269-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie1146992688460898373test/current/0.log for logId 0.
16:44:23.077 [bookie-io-251-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
16:44:23.077 [bookie-io-260-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:23.079 [bookie-io-260-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie2569594693678648166test/current/0.log for logId 0.
16:44:23.080 [bookkeeper-io-280-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:39919 [id: 0x760215d0, L:/127.0.0.1:33056 - R:127.0.0.1/127.0.0.1:39919]
16:44:23.081 [bookie-io-251-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xecf9f0c4, L:/127.0.0.1:39919 - R:/127.0.0.1:33056]
16:44:23.083 [bookkeeper-io-280-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x760215d0, L:/127.0.0.1:33056 - R:127.0.0.1/127.0.0.1:39919] authenticated as BookKeeperPrincipal{ANONYMOUS}
16:44:23.085 [bookie-io-251-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
16:44:23.086 [bookie-io-251-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie1279568970633229549test/current/0.log for logId 0.
16:44:23.095 [Time-limited test] ERROR org.apache.bookkeeper.client.LedgerHandleAdv - Trying to re-add duplicate entryid:0
16:44:23.095 [Time-limited test] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L0 E0
16:44:23.102 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:43903
16:44:23.102 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:39287
16:44:23.103 [bookkeeper-io-280-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xbd0093d8, L:/127.0.0.1:35060 ! R:127.0.0.1/127.0.0.1:43903]
16:44:23.103 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:39919
16:44:23.103 [bookkeeper-io-280-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x2a7bf8be, L:/127.0.0.1:53672 ! R:127.0.0.1/127.0.0.1:39287]
16:44:23.103 [bookkeeper-io-280-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x760215d0, L:/127.0.0.1:33056 ! R:127.0.0.1/127.0.0.1:39919]
16:44:23.103 [bookie-io-269-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x30dc3290, L:/127.0.0.1:39287 ! R:/127.0.0.1:53672]
16:44:23.104 [bookie-io-260-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xcbb1c431, L:/127.0.0.1:43903 ! R:/127.0.0.1:35060]
16:44:23.104 [bookie-io-251-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xecf9f0c4, L:/127.0.0.1:39919 ! R:/127.0.0.1:33056]
16:44:23.205 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x1000067345a0005 closed
16:44:23.206 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
16:44:23.206 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x1000067345a0005
16:44:23.208 [Time-limited test-SendThread(localhost:40923)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x1000067345a0001.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x1000067345a0001, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:23.308 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x1000067345a0001 closed
16:44:23.308 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:23.308 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:23.308 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x1000067345a0001
16:44:23.309 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-39919 with exitCode 0
16:44:23.309 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:23.309 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:23.321 [SyncThread-256-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635889462190 , logFileOffset - 1024]}.
16:44:23.329 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:23.330 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:23.330 [BookieJournal-39919] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:23.330 [BookieJournal-39919] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:23.330 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:23.330 [Bookie-39919] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:23.330 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:23.330 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:23.330 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:23.330 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:23.330 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:23.331 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:23.331 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:23.332 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:23.331 [pool-180-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-180-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:23.338 [Time-limited test-SendThread(localhost:40923)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x1000067345a0002.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x1000067345a0002, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:23.439 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x1000067345a0002 closed
16:44:23.439 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:23.439 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:23.439 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x1000067345a0002
16:44:23.441 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-43903 with exitCode 0
16:44:23.441 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:23.441 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:23.451 [SyncThread-265-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635889462477 , logFileOffset - 1024]}.
16:44:23.460 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:23.460 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:23.461 [BookieJournal-43903] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:23.461 [BookieJournal-43903] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:23.461 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:23.461 [Bookie-43903] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:23.461 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:23.461 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:23.461 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:23.461 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:23.461 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:23.461 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:23.462 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:23.462 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:23.463 [pool-186-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-186-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:23.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
16:44:23.569 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x1000067345a0003 closed
16:44:23.569 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:23.569 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:23.569 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x1000067345a0003
16:44:23.573 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-39287 with exitCode 0
16:44:23.573 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
16:44:23.573 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
16:44:23.584 [SyncThread-274-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635889462766 , logFileOffset - 1536]}.
16:44:23.593 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
16:44:23.593 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
16:44:23.593 [BookieJournal-39287] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
16:44:23.593 [BookieJournal-39287] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
16:44:23.593 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
16:44:23.593 [Bookie-39287] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
16:44:23.594 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
16:44:23.594 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
16:44:23.594 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
16:44:23.594 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
16:44:23.594 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
16:44:23.594 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
16:44:23.594 [pool-192-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-192-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
16:44:23.599 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
16:44:23.599 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
16:44:23.706 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x1000067345a0004 closed
16:44:23.706 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x1000067345a0004
16:44:23.708 [Time-limited test-SendThread(localhost:40923)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x1000067345a0000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x1000067345a0000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
16:44:23.781 [BookieDeathWatcher-39287] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
16:44:23.781 [BookieDeathWatcher-39287] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-39287
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
16:44:23.781 [BookieDeathWatcher-39287] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
16:44:23.781 [BookieDeathWatcher-39287] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
16:44:23.808 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x1000067345a0000 closed
16:44:23.808 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x1000067345a0000
16:44:23.808 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
16:44:23.809 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
16:44:23.809 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
16:44:23.809 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
16:44:23.809 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
16:44:23.809 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
16:44:23.809 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
16:44:23.809 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
16:44:23.809 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
16:44:23.809 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
16:44:23.809 [ProcessThread(sid:0 cport:40923):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
16:44:23.809 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
16:44:23.810 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
16:44:23.810 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 40923
16:44:23.812 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testAddFailsDuplicateEntry in 606 ms.
