21:32:34.481 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:34.952 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie6805902859182205938test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:35.359 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie3662667159757108343test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:35.664 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie5910132265289764163test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:35.954 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:36.769 [bookie-io-8-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:36.776 [bookie-io-26-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:36.779 [bookie-io-17-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:36.769 [bookkeeper-io-37-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:44717 [id: 0xa6efdca3, L:/127.0.0.1:44526 - R:127.0.0.1/127.0.0.1:44717]
21:32:36.780 [bookie-io-17-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x1ef25fd9, L:/127.0.0.1:45389 - R:/127.0.0.1:59714]
21:32:36.775 [bookkeeper-io-37-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:45389 [id: 0x98f2d32a, L:/127.0.0.1:59714 - R:127.0.0.1/127.0.0.1:45389]
21:32:36.772 [bookkeeper-io-37-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:46519 [id: 0xb7775583, L:/127.0.0.1:37346 - R:127.0.0.1/127.0.0.1:46519]
21:32:36.772 [bookie-io-8-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x4deb6983, L:/127.0.0.1:44717 - R:/127.0.0.1:44526]
21:32:36.777 [bookie-io-26-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xf6929f95, L:/127.0.0.1:46519 - R:/127.0.0.1:37346]
21:32:36.804 [bookkeeper-io-37-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xb7775583, L:/127.0.0.1:37346 - R:127.0.0.1/127.0.0.1:46519] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:36.809 [bookkeeper-io-37-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xa6efdca3, L:/127.0.0.1:44526 - R:127.0.0.1/127.0.0.1:44717] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:36.810 [bookkeeper-io-37-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x98f2d32a, L:/127.0.0.1:59714 - R:127.0.0.1/127.0.0.1:45389] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:36.828 [bookie-io-26-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:36.828 [bookie-io-17-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:36.829 [bookie-io-8-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:36.831 [bookie-io-26-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie5910132265289764163test/current/0.log for logId 0.
21:32:36.831 [bookie-io-8-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie6805902859182205938test/current/0.log for logId 0.
21:32:36.831 [bookie-io-17-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie3662667159757108343test/current/0.log for logId 0.
21:32:36.873 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:45389
21:32:36.877 [bookkeeper-io-37-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x98f2d32a, L:/127.0.0.1:59714 ! R:127.0.0.1/127.0.0.1:45389]
21:32:36.878 [bookie-io-17-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x1ef25fd9, L:/127.0.0.1:45389 ! R:/127.0.0.1:59714]
21:32:36.878 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:46519
21:32:36.879 [bookkeeper-io-37-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xb7775583, L:/127.0.0.1:37346 ! R:127.0.0.1/127.0.0.1:46519]
21:32:36.879 [bookie-io-26-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xf6929f95, L:/127.0.0.1:46519 ! R:/127.0.0.1:37346]
21:32:36.880 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:44717
21:32:36.880 [bookkeeper-io-37-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xa6efdca3, L:/127.0.0.1:44526 ! R:127.0.0.1/127.0.0.1:44717]
21:32:36.881 [bookie-io-8-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x4deb6983, L:/127.0.0.1:44717 ! R:/127.0.0.1:44526]
21:32:36.892 [Time-limited test-SendThread(localhost:43977)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f0f8c0005.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f0f8c0005, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:36.995 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f0f8c0005
21:32:36.997 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f0f8c0005 closed
21:32:36.999 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
21:32:37.103 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f0f8c0001 closed
21:32:37.103 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:37.103 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:37.104 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f0f8c0001
21:32:37.107 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-44717 with exitCode 0
21:32:37.108 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:37.108 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:37.119 [SyncThread-13-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635906755046 , logFileOffset - 1024]}.
21:32:37.128 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:37.128 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:37.129 [BookieJournal-44717] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:37.129 [BookieJournal-44717] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:37.129 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:37.129 [Bookie-44717] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:37.129 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:37.130 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:37.130 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:37.130 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:37.130 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:37.131 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:37.131 [pool-12-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-12-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:37.140 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:37.140 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:37.142 [Time-limited test-SendThread(localhost:43977)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f0f8c0002.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f0f8c0002, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:37.242 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f0f8c0002 closed
21:32:37.242 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f0f8c0002
21:32:37.243 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:37.243 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:37.244 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-45389 with exitCode 0
21:32:37.244 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:37.244 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:37.255 [SyncThread-22-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635906755381 , logFileOffset - 1024]}.
21:32:37.264 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:37.264 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:37.265 [BookieJournal-45389] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:37.265 [BookieJournal-45389] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:37.265 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:37.266 [Bookie-45389] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:37.266 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:37.266 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:37.266 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:37.266 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:37.266 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:37.267 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:37.270 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:37.270 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:37.270 [pool-18-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-18-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:37.273 [Time-limited test-SendThread(localhost:43977)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f0f8c0003.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f0f8c0003, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:37.374 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f0f8c0003 closed
21:32:37.374 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f0f8c0003
21:32:37.374 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:37.375 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:37.377 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-46519 with exitCode 0
21:32:37.377 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:37.377 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:37.388 [SyncThread-31-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635906755686 , logFileOffset - 1024]}.
21:32:37.388 [BookieDeathWatcher-45389] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:37.389 [BookieDeathWatcher-45389] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45389
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:37.389 [BookieDeathWatcher-45389] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:37.389 [BookieDeathWatcher-45389] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:37.397 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:37.397 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:37.397 [BookieJournal-46519] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:37.397 [BookieJournal-46519] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:37.398 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:37.398 [Bookie-46519] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:37.398 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:37.398 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:37.398 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:37.398 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:37.398 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:37.402 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:37.405 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:37.405 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:37.405 [pool-24-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-24-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:37.507 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f0f8c0004 closed
21:32:37.509 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f0f8c0004
21:32:37.611 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f0f8c0000 closed
21:32:37.611 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
21:32:37.612 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
21:32:37.612 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
21:32:37.612 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f0f8c0000
21:32:37.612 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
21:32:37.612 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
21:32:37.613 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
21:32:37.613 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
21:32:37.613 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
21:32:37.613 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
21:32:37.613 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
21:32:37.613 [ProcessThread(sid:0 cport:43977):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
21:32:37.613 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
21:32:37.614 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
21:32:37.615 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 43977
21:32:37.627 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testSimpleAdd in 627 ms.
21:32:37.629 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
21:32:37.630 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
21:32:37.630 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
21:32:37.631 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
21:32:37.631 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
21:32:37.631 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
21:32:37.631 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
21:32:37.631 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
21:32:37.631 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
21:32:37.631 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
21:32:37.631 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
21:32:37.631 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
21:32:37.631 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
21:32:37.631 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
21:32:37.631 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
21:32:37.631 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
21:32:37.631 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
21:32:37.631 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
21:32:37.632 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper84380239795198726test/version-2 snapdir /tmp/zookeeper84380239795198726test/version-2
21:32:37.632 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
21:32:37.632 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
21:32:37.632 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
21:32:37.634 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper84380239795198726test/version-2/snapshot.0
21:32:37.635 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 1 ms, highest zxid is 0x0, digest is 1371985504
21:32:37.635 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper84380239795198726test/version-2/snapshot.0
21:32:37.635 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 0 ms
21:32:37.636 [ProcessThread(sid:0 cport:42239):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
21:32:37.636 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 42239
21:32:37.638 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:42200
21:32:37.638 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
21:32:37.640 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42239 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@5e8c6683
21:32:37.640 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:37.640 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:37.641 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42239.
21:32:37.641 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:37.641 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:42202, server: localhost/127.0.0.1:42239
21:32:37.642 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
21:32:37.645 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42239, session id = 0x100016f1cea0000, negotiated timeout = 10000
21:32:37.645 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:37.656 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42239/ledgers : zkServers = localhost:42239, ledgersRootPath = /ledgers.
21:32:37.657 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42239 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@35f11ad1
21:32:37.657 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:37.657 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:37.658 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42239.
21:32:37.658 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:37.659 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:42204, server: localhost/127.0.0.1:42239
21:32:37.660 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42239, session id = 0x100016f1cea0001, negotiated timeout = 10000
21:32:37.661 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:37.662 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:37.663 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
21:32:37.663 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
21:32:37.663 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
21:32:37.669 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:37.669 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "gcWaitTime" : "1000",
  "readOnlyModeEnabled" : "true",
  "bookiePort" : "0",
  "ledgerDirectories" : "/tmp/bookie5945796780475795786test",
  "enableTaskExecutionStats" : "true",
  "allowEphemeralPorts" : "true",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie5945796780475795786test",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "diskUsageWarnThreshold" : "0.99",
  "entryLogFilePreallocationEnabled" : "false",
  "metadataServiceUri" : "zk://localhost:42239/ledgers",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "allowLoopback" : "true",
  "numAddWorkerThreads" : "0",
  "listeningInterface" : "lo",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "journalFormatVersionToWrite" : "5",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "preserveMdcForTaskExecution" : "true",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "numReadWorkerThreads" : "0",
  "diskUsageThreshold" : "0.999"
}
21:32:37.671 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:37.672 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42239/ledgers : zkServers = localhost:42239, ledgersRootPath = /ledgers.
21:32:37.672 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42239 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@1874e852
21:32:37.673 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:37.673 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:37.677 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42239.
21:32:37.677 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:37.677 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:42206, server: localhost/127.0.0.1:42239
21:32:37.680 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42239, session id = 0x100016f1cea0002, negotiated timeout = 10000
21:32:37.681 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:37.685 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:37.692 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie5945796780475795786test/current] [/tmp/bookie5945796780475795786test/current]
21:32:37.699 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:37.700 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie5945796780475795786test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:37.700 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:37.700 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:37.701 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:37.701 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:37.701 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:37.701 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:37.713 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:36871 to become writable
21:32:37.714 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:37.714 [SyncThread-52-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:37.716 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:37.721 [BookieJournal-36871] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie5945796780475795786test/current
21:32:37.721 [BookieJournal-36871] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie5945796780475795786test/current/17ce3a4245a.txn
21:32:37.723 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:37.725 [BookieDeathWatcher-46519] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:37.725 [BookieDeathWatcher-46519] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-46519
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:37.725 [BookieDeathWatcher-46519] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:37.725 [BookieDeathWatcher-46519] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:37.730 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:36871 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:36871, port=36871, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:37.731 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:36871
21:32:37.976 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:36871' has been created.
21:32:37.978 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:37.978 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "allowLoopback" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "bookiePort" : "0",
  "numReadWorkerThreads" : "0",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "enableTaskExecutionStats" : "true",
  "allowEphemeralPorts" : "true",
  "diskUsageWarnThreshold" : "0.99",
  "listeningInterface" : "lo",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "preserveMdcForTaskExecution" : "true",
  "journalFlushWhenQueueEmpty" : "true",
  "metadataServiceUri" : "zk://localhost:42239/ledgers",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "journalDirectories" : "/tmp/bookie4895054237603572593test",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "entryLogFilePreallocationEnabled" : "false",
  "numAddWorkerThreads" : "0",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "ledgerDirectories" : "/tmp/bookie4895054237603572593test",
  "journalFormatVersionToWrite" : "5",
  "diskUsageThreshold" : "0.999"
}
21:32:37.981 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:37.982 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42239/ledgers : zkServers = localhost:42239, ledgersRootPath = /ledgers.
21:32:37.982 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42239 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@307fa660
21:32:37.982 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:37.983 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:37.983 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42239.
21:32:37.983 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:37.984 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:42208, server: localhost/127.0.0.1:42239
21:32:37.992 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42239, session id = 0x100016f1cea0003, negotiated timeout = 10000
21:32:37.993 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:37.996 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:38.000 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie4895054237603572593test/current] [/tmp/bookie4895054237603572593test/current]
21:32:38.004 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:38.005 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie4895054237603572593test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:38.005 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:38.005 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:38.006 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:38.006 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:38.006 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:38.006 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:38.012 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:33753 to become writable
21:32:38.013 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:38.013 [SyncThread-61-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:38.015 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:38.017 [BookieJournal-33753] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie4895054237603572593test/current
21:32:38.021 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:38.021 [BookieJournal-33753] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie4895054237603572593test/current/17ce3a42586.txn
21:32:38.026 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:33753 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:33753, port=33753, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:38.026 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:33753
21:32:38.084 [BookieDeathWatcher-44717] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:38.084 [BookieDeathWatcher-44717] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-44717
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:38.085 [BookieDeathWatcher-44717] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:38.085 [BookieDeathWatcher-44717] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:38.278 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:33753' has been created.
21:32:38.279 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:38.279 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "journalDirectories" : "/tmp/bookie2263219301447782976test",
  "gcWaitTime" : "1000",
  "diskUsageThreshold" : "0.999",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "entryLogFilePreallocationEnabled" : "false",
  "bookiePort" : "0",
  "journalFormatVersionToWrite" : "5",
  "metadataServiceUri" : "zk://localhost:42239/ledgers",
  "enableTaskExecutionStats" : "true",
  "listeningInterface" : "lo",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "preserveMdcForTaskExecution" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "numReadWorkerThreads" : "0",
  "readOnlyModeEnabled" : "true",
  "diskUsageWarnThreshold" : "0.99",
  "allowLoopback" : "true",
  "ledgerDirectories" : "/tmp/bookie2263219301447782976test",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "numAddWorkerThreads" : "0",
  "allowEphemeralPorts" : "true",
  "journalFlushWhenQueueEmpty" : "true",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage"
}
21:32:38.281 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:38.283 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42239/ledgers : zkServers = localhost:42239, ledgersRootPath = /ledgers.
21:32:38.283 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42239 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@2b4b7025
21:32:38.284 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:38.284 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:38.288 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42239.
21:32:38.288 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:38.289 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:42210, server: localhost/127.0.0.1:42239
21:32:38.293 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42239, session id = 0x100016f1cea0004, negotiated timeout = 10000
21:32:38.293 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:38.299 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:38.303 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie2263219301447782976test/current] [/tmp/bookie2263219301447782976test/current]
21:32:38.312 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:38.314 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie2263219301447782976test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:38.314 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:38.314 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:38.314 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:38.317 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:38.318 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:38.318 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:38.329 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:33037 to become writable
21:32:38.329 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:38.330 [SyncThread-70-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:38.332 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:38.332 [BookieJournal-33037] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie2263219301447782976test/current
21:32:38.333 [BookieJournal-33037] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie2263219301447782976test/current/17ce3a426be.txn
21:32:38.334 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:38.342 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:33037 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:33037, port=33037, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:38.343 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:33037
21:32:38.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
21:32:38.592 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:33037' has been created.
21:32:38.593 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testAddWithEnsembleChange @ metadata service zk://localhost:42239/ledgers in 963 ms.
21:32:38.595 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42239/ledgers : zkServers = localhost:42239, ledgersRootPath = /ledgers.
21:32:38.595 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42239 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@1bcc511a
21:32:38.595 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:38.595 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:38.597 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42239.
21:32:38.597 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:38.597 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:42212, server: localhost/127.0.0.1:42239
21:32:38.599 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42239, session id = 0x100016f1cea0005, negotiated timeout = 10000
21:32:38.599 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:38.603 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:38.604 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
21:32:38.604 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
21:32:38.604 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
21:32:38.613 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:33753 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:33753, port=33753, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:38.613 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:33037 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:33037, port=33037, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:38.614 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:36871 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:36871, port=36871, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:38.614 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:33753
21:32:38.614 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:36871
21:32:38.614 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:33037
21:32:38.615 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
21:32:38.615 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:33037, 127.0.0.1:33753, 127.0.0.1:36871] is not adhering to Placement Policy. quarantinedBookies: []
21:32:38.627 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:33037, 127.0.0.1:33753, 127.0.0.1:36871] for ledger: 0
21:32:38.644 [bookkeeper-io-76-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:33753 [id: 0xa9eef7fe, L:/127.0.0.1:45730 - R:127.0.0.1/127.0.0.1:33753]
21:32:38.651 [bookkeeper-io-76-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:33037 [id: 0xd82a4cdf, L:/127.0.0.1:49350 - R:127.0.0.1/127.0.0.1:33037]
21:32:38.651 [bookkeeper-io-76-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xa9eef7fe, L:/127.0.0.1:45730 - R:127.0.0.1/127.0.0.1:33753] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:38.653 [bookie-io-65-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:38.654 [bookie-io-65-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x42c1db4f, L:/127.0.0.1:33037 - R:/127.0.0.1:49350]
21:32:38.657 [bookkeeper-io-76-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xd82a4cdf, L:/127.0.0.1:49350 - R:127.0.0.1/127.0.0.1:33037] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:38.658 [bookie-io-65-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:38.659 [bookie-io-65-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie2263219301447782976test/current/0.log for logId 0.
21:32:38.662 [bookie-io-56-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:38.663 [bookie-io-56-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xfe0c3781, L:/127.0.0.1:33753 - R:/127.0.0.1:45730]
21:32:38.663 [bookie-io-56-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:38.664 [bookie-io-56-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie4895054237603572593test/current/0.log for logId 0.
21:32:38.671 [bookkeeper-io-76-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:36871 [id: 0x9f768550, L:/127.0.0.1:60388 - R:127.0.0.1/127.0.0.1:36871]
21:32:38.677 [bookkeeper-io-76-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x9f768550, L:/127.0.0.1:60388 - R:127.0.0.1/127.0.0.1:36871] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:38.681 [bookie-io-47-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:38.681 [bookie-io-47-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x948af242, L:/127.0.0.1:36871 - R:/127.0.0.1:60388]
21:32:38.682 [bookie-io-47-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:38.684 [bookie-io-47-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie5945796780475795786test/current/0.log for logId 0.
21:32:38.693 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:38.693 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "diskUsageWarnThreshold" : "0.99",
  "allowEphemeralPorts" : "true",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "metadataServiceUri" : "zk://localhost:42239/ledgers",
  "ledgerDirectories" : "/tmp/bookie8311939623002310360test",
  "enableTaskExecutionStats" : "true",
  "diskUsageThreshold" : "0.999",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "numAddWorkerThreads" : "0",
  "entryLogFilePreallocationEnabled" : "false",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "readOnlyModeEnabled" : "true",
  "preserveMdcForTaskExecution" : "true",
  "journalFlushWhenQueueEmpty" : "true",
  "gcWaitTime" : "1000",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "journalDirectories" : "/tmp/bookie8311939623002310360test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "journalFormatVersionToWrite" : "5",
  "allowLoopback" : "true",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "bookiePort" : "0"
}
21:32:38.696 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:38.697 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42239/ledgers : zkServers = localhost:42239, ledgersRootPath = /ledgers.
21:32:38.698 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42239 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@60c437b8
21:32:38.698 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:38.698 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:38.704 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42239.
21:32:38.705 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:38.706 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:42220, server: localhost/127.0.0.1:42239
21:32:38.707 [Time-limited test-SendThread(localhost:42239)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42239, session id = 0x100016f1cea0006, negotiated timeout = 10000
21:32:38.708 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:38.710 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:38.713 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie8311939623002310360test/current] [/tmp/bookie8311939623002310360test/current]
21:32:38.718 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:38.719 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie8311939623002310360test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:38.720 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:38.720 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:38.721 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:38.724 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:38.725 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:38.725 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:38.737 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:43629 to become writable
21:32:38.738 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:38.739 [SyncThread-85-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:38.741 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:38.745 [BookieJournal-43629] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie8311939623002310360test/current
21:32:38.752 [BookieJournal-43629] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie8311939623002310360test/current/17ce3a42861.txn
21:32:38.753 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:38.759 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:43629 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:43629, port=43629, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:38.760 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:43629 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:43629, port=43629, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:38.761 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:43629
21:32:38.761 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:43629
21:32:39.008 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:43629' has been created.
21:32:39.009 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:39.009 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:39.011 [bookkeeper-io-76-3] WARN  org.apache.bookkeeper.proto.PerChannelBookieClient - Exception caught on:[id: 0x9f768550, L:/127.0.0.1:60388 - R:127.0.0.1/127.0.0.1:36871] cause: readAddress(..) failed: Connection reset by peer
21:32:39.012 [bookie-io-47-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x948af242, L:/127.0.0.1:36871 ! R:/127.0.0.1:60388]
21:32:39.013 [bookkeeper-io-76-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x9f768550, L:/127.0.0.1:60388 ! R:127.0.0.1/127.0.0.1:36871]
21:32:39.021 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-36871 with exitCode 0
21:32:39.021 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:39.022 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:39.033 [SyncThread-52-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635906757722 , logFileOffset - 1024]}.
21:32:39.042 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:39.043 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:39.043 [BookieJournal-36871] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:39.044 [BookieJournal-36871] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:39.044 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:39.044 [Bookie-36871] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:39.045 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:39.045 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:39.045 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:39.046 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:39.046 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:39.052 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:39.052 [pool-39-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-39-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:39.059 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:39.059 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:39.062 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:36871
21:32:39.062 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:36871
21:32:39.064 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:36871
21:32:39.065 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:36871
21:32:39.162 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f1cea0002 closed
21:32:39.163 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f1cea0002
21:32:39.164 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.DefaultBookieAddressResolver - Cannot resolve 127.0.0.1:36871, bookie is unknown org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
21:32:39.165 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Cannot connect to 127.0.0.1:36871 as endpoint resolution failed (probably bookie is down) err org.apache.bookkeeper.proto.BookieAddressResolver$BookieIdNotResolvedException: Cannot resolve bookieId 127.0.0.1:36871, bookie does not exist or it is not running
21:32:39.168 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Could not connect to bookie: null/127.0.0.1:36871, current state CONNECTING : 
org.apache.bookkeeper.proto.BookieAddressResolver$BookieIdNotResolvedException: Cannot resolve bookieId 127.0.0.1:36871, bookie does not exist or it is not running
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:63) ~[classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient.connect(PerChannelBookieClient.java:533) [classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient.connectIfNeededAndDoOp(PerChannelBookieClient.java:665) [classes/:?]
	at org.apache.bookkeeper.proto.DefaultPerChannelBookieClientPool.obtain(DefaultPerChannelBookieClientPool.java:121) [classes/:?]
	at org.apache.bookkeeper.proto.DefaultPerChannelBookieClientPool.obtain(DefaultPerChannelBookieClientPool.java:116) [classes/:?]
	at org.apache.bookkeeper.proto.BookieClientImpl.addEntry(BookieClientImpl.java:329) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.sendWriteRequest(PendingAddOp.java:152) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.safeRun(PendingAddOp.java:278) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
	at org.apache.bookkeeper.discover.ZKRegistrationClient.getBookieServiceInfo(ZKRegistrationClient.java:248) ~[classes/:?]
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:43) ~[classes/:?]
	... 13 more
21:32:39.169 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (0, 1): Bookie handle is not available
21:32:39.175 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.DefaultBookieAddressResolver - Cannot resolve 127.0.0.1:36871, bookie is unknown org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
21:32:39.176 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy - Cannot resolve bookieId 127.0.0.1:36871 to a network address, resolving as /default-region/default-rack
org.apache.bookkeeper.proto.BookieAddressResolver$BookieIdNotResolvedException: Cannot resolve bookieId 127.0.0.1:36871, bookie does not exist or it is not running
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:63) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.resolveNetworkLocation(TopologyAwareEnsemblePlacementPolicy.java:794) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.createBookieNode(TopologyAwareEnsemblePlacementPolicy.java:784) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:458) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:120) ~[classes/:?]
	at org.apache.bookkeeper.client.BookieWatcherImpl.replaceBookie(BookieWatcherImpl.java:317) ~[classes/:?]
	at org.apache.bookkeeper.client.EnsembleUtils.replaceBookiesInEnsemble(EnsembleUtils.java:71) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.lambda$ensembleChangeLoop$2(LedgerHandle.java:1935) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.writeLoop(MetadataUpdateLoop.java:134) [classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.run(MetadataUpdateLoop.java:123) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.ensembleChangeLoop(LedgerHandle.java:1954) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.handleBookieFailure(LedgerHandle.java:1903) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:378) [classes/:?]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:295) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
	at org.apache.bookkeeper.discover.ZKRegistrationClient.getBookieServiceInfo(ZKRegistrationClient.java:248) ~[classes/:?]
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:43) ~[classes/:?]
	... 19 more
21:32:39.176 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.DefaultBookieAddressResolver - Cannot resolve 127.0.0.1:36871, bookie is unknown org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
21:32:39.176 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy - Cannot resolve bookieId 127.0.0.1:36871 to a network address, resolving as /default-region/default-rack
org.apache.bookkeeper.proto.BookieAddressResolver$BookieIdNotResolvedException: Cannot resolve bookieId 127.0.0.1:36871, bookie does not exist or it is not running
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:63) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.resolveNetworkLocation(TopologyAwareEnsemblePlacementPolicy.java:794) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.createBookieNode(TopologyAwareEnsemblePlacementPolicy.java:784) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.convertBookiesToNodes(TopologyAwareEnsemblePlacementPolicy.java:807) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:461) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:120) ~[classes/:?]
	at org.apache.bookkeeper.client.BookieWatcherImpl.replaceBookie(BookieWatcherImpl.java:317) ~[classes/:?]
	at org.apache.bookkeeper.client.EnsembleUtils.replaceBookiesInEnsemble(EnsembleUtils.java:71) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.lambda$ensembleChangeLoop$2(LedgerHandle.java:1935) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.writeLoop(MetadataUpdateLoop.java:134) [classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.run(MetadataUpdateLoop.java:123) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.ensembleChangeLoop(LedgerHandle.java:1954) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.handleBookieFailure(LedgerHandle.java:1903) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:378) [classes/:?]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:295) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
	at org.apache.bookkeeper.discover.ZKRegistrationClient.getBookieServiceInfo(ZKRegistrationClient.java:248) ~[classes/:?]
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:43) ~[classes/:?]
	... 20 more
21:32:39.177 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.DefaultBookieAddressResolver - Cannot resolve 127.0.0.1:36871, bookie is unknown org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
21:32:39.177 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy - Cannot resolve bookieId 127.0.0.1:36871 to a network address, resolving as /default-region/default-rack
org.apache.bookkeeper.proto.BookieAddressResolver$BookieIdNotResolvedException: Cannot resolve bookieId 127.0.0.1:36871, bookie does not exist or it is not running
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:63) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.resolveNetworkLocation(TopologyAwareEnsemblePlacementPolicy.java:794) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.createBookieNode(TopologyAwareEnsemblePlacementPolicy.java:784) ~[classes/:?]
	at org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy.convertBookiesToNodes(TopologyAwareEnsemblePlacementPolicy.java:807) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:462) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:120) ~[classes/:?]
	at org.apache.bookkeeper.client.BookieWatcherImpl.replaceBookie(BookieWatcherImpl.java:317) ~[classes/:?]
	at org.apache.bookkeeper.client.EnsembleUtils.replaceBookiesInEnsemble(EnsembleUtils.java:71) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.lambda$ensembleChangeLoop$2(LedgerHandle.java:1935) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.writeLoop(MetadataUpdateLoop.java:134) [classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.run(MetadataUpdateLoop.java:123) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.ensembleChangeLoop(LedgerHandle.java:1954) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.handleBookieFailure(LedgerHandle.java:1903) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:378) [classes/:?]
	at org.apache.bookkeeper.proto.BookieClientImpl$1.safeRun(BookieClientImpl.java:295) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.client.BKException$BKBookieHandleNotAvailableException: Bookie handle is not available
	at org.apache.bookkeeper.discover.ZKRegistrationClient.getBookieServiceInfo(ZKRegistrationClient.java:248) ~[classes/:?]
	at org.apache.bookkeeper.client.DefaultBookieAddressResolver.resolve(DefaultBookieAddressResolver.java:43) ~[classes/:?]
	... 20 more
21:32:39.179 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:33753>, <Bookie:127.0.0.1:36871>, <Bookie:127.0.0.1:43629>, <Bookie:127.0.0.1:33037>], allBookies [<Bookie:127.0.0.1:33037>, <Bookie:127.0.0.1:43629>, <Bookie:127.0.0.1:33753>].
21:32:39.181 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:33753>, <Bookie:127.0.0.1:36871>, <Bookie:127.0.0.1:33037>], fallback to choose bookie randomly from the cluster.
21:32:39.185 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - replaceBookie for bookie: 127.0.0.1:36871 in ensemble: [127.0.0.1:33037, 127.0.0.1:33753, 127.0.0.1:36871] is not adhering to placement policy and chose 127.0.0.1:43629. excludedBookies [127.0.0.1:36871] and quarantinedBookies []
21:32:39.188 [BookKeeperClientWorker-OrderedExecutor-0-0] INFO  org.apache.bookkeeper.client.LedgerHandle - New Ensemble: [127.0.0.1:33037, 127.0.0.1:33753, 127.0.0.1:43629] for ledger: 0
21:32:39.192 [bookkeeper-io-76-4] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:43629 [id: 0xba3790ed, L:/127.0.0.1:47512 - R:127.0.0.1/127.0.0.1:43629]
21:32:39.193 [bookkeeper-io-76-4] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xba3790ed, L:/127.0.0.1:47512 - R:127.0.0.1/127.0.0.1:43629] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:39.196 [bookie-io-80-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:39.196 [bookie-io-80-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x02af8c0d, L:/127.0.0.1:43629 - R:/127.0.0.1:47512]
21:32:39.197 [bookie-io-80-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:39.197 [bookie-io-80-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie8311939623002310360test/current/0.log for logId 0.
21:32:39.210 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:33037
21:32:39.210 [bookkeeper-io-76-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xd82a4cdf, L:/127.0.0.1:49350 ! R:127.0.0.1/127.0.0.1:33037]
21:32:39.210 [bookie-io-65-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x42c1db4f, L:/127.0.0.1:33037 ! R:/127.0.0.1:49350]
21:32:39.211 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:33753
21:32:39.211 [bookkeeper-io-76-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xa9eef7fe, L:/127.0.0.1:45730 ! R:127.0.0.1/127.0.0.1:33753]
21:32:39.211 [bookie-io-56-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xfe0c3781, L:/127.0.0.1:33753 ! R:/127.0.0.1:45730]
21:32:39.212 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:36871
21:32:39.212 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:43629
21:32:39.213 [bookkeeper-io-76-4] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xba3790ed, L:/127.0.0.1:47512 ! R:127.0.0.1/127.0.0.1:43629]
21:32:39.213 [bookie-io-80-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x02af8c0d, L:/127.0.0.1:43629 ! R:/127.0.0.1:47512]
21:32:39.318 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f1cea0005
21:32:39.319 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f1cea0005 closed
21:32:39.320 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
21:32:39.422 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f1cea0001 closed
21:32:39.422 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:39.422 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:39.427 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f1cea0001
21:32:39.429 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-33753 with exitCode 0
21:32:39.429 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:39.429 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:39.440 [SyncThread-61-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635906758022 , logFileOffset - 1536]}.
21:32:39.449 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:39.449 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:39.449 [BookieJournal-33753] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:39.450 [BookieJournal-33753] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:39.450 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:39.451 [Bookie-33753] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:39.451 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:39.451 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:39.451 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:39.451 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:39.451 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:39.452 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:39.452 [pool-45-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-45-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:39.454 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:39.454 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:39.563 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f1cea0003 closed
21:32:39.564 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f1cea0003
21:32:39.564 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:39.564 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:39.571 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-33037 with exitCode 0
21:32:39.571 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:39.571 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:39.583 [SyncThread-70-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635906758334 , logFileOffset - 1536]}.
21:32:39.592 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:39.592 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:39.592 [BookieJournal-33037] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:39.592 [BookieJournal-33037] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:39.593 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:39.594 [Bookie-33037] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:39.594 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:39.594 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:39.594 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:39.594 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:39.594 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:39.595 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:39.595 [pool-51-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-51-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:39.600 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:39.600 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:39.703 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f1cea0004 closed
21:32:39.704 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f1cea0004
21:32:39.704 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:39.704 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:39.709 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-43629 with exitCode 0
21:32:39.709 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:39.709 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:39.720 [SyncThread-85-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635906758753 , logFileOffset - 1024]}.
21:32:39.726 [BookieDeathWatcher-36871] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:39.726 [BookieDeathWatcher-36871] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-36871
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:39.727 [BookieDeathWatcher-36871] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:39.727 [BookieDeathWatcher-36871] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:39.729 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:39.729 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:39.729 [BookieJournal-43629] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:39.729 [BookieJournal-43629] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:39.730 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:39.730 [Bookie-43629] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:39.730 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:39.730 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:39.730 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:39.730 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:39.730 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:39.730 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:39.730 [pool-60-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-60-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:39.732 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:39.732 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:39.838 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f1cea0006
21:32:39.839 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f1cea0006 closed
21:32:39.841 [Time-limited test-SendThread(localhost:42239)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f1cea0000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f1cea0000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:39.942 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f1cea0000 closed
21:32:39.942 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f1cea0000
21:32:39.942 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
21:32:39.945 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
21:32:39.945 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
21:32:39.946 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
21:32:39.946 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
21:32:39.946 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
21:32:39.946 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
21:32:39.946 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
21:32:39.946 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
21:32:39.946 [ProcessThread(sid:0 cport:42239):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
21:32:39.946 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
21:32:39.946 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
21:32:39.947 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
21:32:39.947 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 42239
21:32:39.950 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testAddWithEnsembleChange in 630 ms.
21:32:39.951 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
21:32:39.951 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
21:32:39.952 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
21:32:39.952 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
21:32:39.952 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
21:32:39.953 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
21:32:39.953 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
21:32:39.953 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
21:32:39.953 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
21:32:39.953 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
21:32:39.953 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
21:32:39.953 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
21:32:39.953 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
21:32:39.953 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
21:32:39.953 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
21:32:39.953 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
21:32:39.953 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
21:32:39.953 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
21:32:39.953 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper5106937539933945816test/version-2 snapdir /tmp/zookeeper5106937539933945816test/version-2
21:32:39.953 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
21:32:39.954 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
21:32:39.954 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
21:32:39.958 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper5106937539933945816test/version-2/snapshot.0
21:32:39.958 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 1 ms, highest zxid is 0x0, digest is 1371985504
21:32:39.959 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper5106937539933945816test/version-2/snapshot.0
21:32:39.959 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 0 ms
21:32:39.959 [ProcessThread(sid:0 cport:40285):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
21:32:39.960 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 40285
21:32:39.965 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:56646
21:32:39.965 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
21:32:39.965 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40285 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@309c1291
21:32:39.965 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:39.965 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:39.969 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40285.
21:32:39.969 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:39.969 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:56648, server: localhost/127.0.0.1:40285
21:32:39.972 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
21:32:39.975 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40285, session id = 0x100016f25fe0000, negotiated timeout = 10000
21:32:39.975 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:39.984 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40285/ledgers : zkServers = localhost:40285, ledgersRootPath = /ledgers.
21:32:39.984 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40285 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@46085094
21:32:39.985 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:39.985 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:39.989 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40285.
21:32:39.989 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:39.989 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:56650, server: localhost/127.0.0.1:40285
21:32:39.990 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40285, session id = 0x100016f25fe0001, negotiated timeout = 10000
21:32:39.991 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:39.992 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:39.993 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
21:32:39.993 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
21:32:39.993 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
21:32:39.999 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:40.000 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "numAddWorkerThreads" : "0",
  "allowLoopback" : "true",
  "numReadWorkerThreads" : "0",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerDirectories" : "/tmp/bookie6680049911380875341test",
  "readOnlyModeEnabled" : "true",
  "journalFormatVersionToWrite" : "5",
  "preserveMdcForTaskExecution" : "true",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "enableTaskExecutionStats" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "entryLogFilePreallocationEnabled" : "false",
  "listeningInterface" : "lo",
  "journalDirectories" : "/tmp/bookie6680049911380875341test",
  "diskUsageThreshold" : "0.999",
  "journalFlushWhenQueueEmpty" : "true",
  "bookiePort" : "0",
  "gcWaitTime" : "1000",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "metadataServiceUri" : "zk://localhost:40285/ledgers",
  "allowEphemeralPorts" : "true"
}
21:32:40.001 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:40.003 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40285/ledgers : zkServers = localhost:40285, ledgersRootPath = /ledgers.
21:32:40.003 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40285 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@6e56df64
21:32:40.004 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:40.004 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:40.008 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40285.
21:32:40.008 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:40.009 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:56652, server: localhost/127.0.0.1:40285
21:32:40.011 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40285, session id = 0x100016f25fe0002, negotiated timeout = 10000
21:32:40.011 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:40.012 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:40.016 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie6680049911380875341test/current] [/tmp/bookie6680049911380875341test/current]
21:32:40.020 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:40.021 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie6680049911380875341test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:40.021 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:40.021 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:40.021 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:40.022 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:40.022 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:40.022 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:40.026 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:44951 to become writable
21:32:40.027 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:40.027 [SyncThread-100-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:40.028 [BookieDeathWatcher-33753] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:40.028 [BookieDeathWatcher-33753] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-33753
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:40.028 [BookieDeathWatcher-33753] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:40.028 [BookieDeathWatcher-33753] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:40.028 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:40.029 [BookieJournal-44951] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie6680049911380875341test/current
21:32:40.029 [BookieJournal-44951] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie6680049911380875341test/current/17ce3a42d5e.txn
21:32:40.030 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:40.039 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:44951 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:44951, port=44951, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:40.039 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:44951
21:32:40.288 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:44951' has been created.
21:32:40.289 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:40.289 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "numReadWorkerThreads" : "0",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "journalFlushWhenQueueEmpty" : "true",
  "listeningInterface" : "lo",
  "readOnlyModeEnabled" : "true",
  "preserveMdcForTaskExecution" : "true",
  "allowEphemeralPorts" : "true",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "diskUsageThreshold" : "0.999",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "allowLoopback" : "true",
  "bookiePort" : "0",
  "numAddWorkerThreads" : "0",
  "journalDirectories" : "/tmp/bookie623939671073925076test",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "enableTaskExecutionStats" : "true",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "metadataServiceUri" : "zk://localhost:40285/ledgers",
  "gcWaitTime" : "1000",
  "ledgerDirectories" : "/tmp/bookie623939671073925076test",
  "entryLogFilePreallocationEnabled" : "false",
  "diskUsageWarnThreshold" : "0.99",
  "journalFormatVersionToWrite" : "5"
}
21:32:40.293 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:40.294 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40285/ledgers : zkServers = localhost:40285, ledgersRootPath = /ledgers.
21:32:40.294 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40285 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@196c491d
21:32:40.294 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:40.295 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:40.295 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40285.
21:32:40.295 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:40.296 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:56654, server: localhost/127.0.0.1:40285
21:32:40.297 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40285, session id = 0x100016f25fe0003, negotiated timeout = 10000
21:32:40.297 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:40.301 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:40.307 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie623939671073925076test/current] [/tmp/bookie623939671073925076test/current]
21:32:40.310 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:40.311 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie623939671073925076test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:40.311 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:40.312 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:40.312 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:40.313 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:40.314 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:40.314 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:40.318 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:39797 to become writable
21:32:40.319 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:40.319 [SyncThread-109-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:40.321 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:40.325 [BookieJournal-39797] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie623939671073925076test/current
21:32:40.326 [BookieJournal-39797] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie623939671073925076test/current/17ce3a42e87.txn
21:32:40.326 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:40.331 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:39797 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:39797, port=39797, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:40.332 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:39797
21:32:40.342 [BookieDeathWatcher-33037] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:40.342 [BookieDeathWatcher-33037] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-33037
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:40.344 [BookieDeathWatcher-33037] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:40.344 [BookieDeathWatcher-33037] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:40.580 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:39797' has been created.
21:32:40.582 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:40.582 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "allowEphemeralPorts" : "true",
  "journalFormatVersionToWrite" : "5",
  "journalDirectories" : "/tmp/bookie3958714061063816088test",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "metadataServiceUri" : "zk://localhost:40285/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "enableTaskExecutionStats" : "true",
  "diskUsageWarnThreshold" : "0.99",
  "bookiePort" : "0",
  "preserveMdcForTaskExecution" : "true",
  "entryLogFilePreallocationEnabled" : "false",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "gcWaitTime" : "1000",
  "allowLoopback" : "true",
  "diskUsageThreshold" : "0.999",
  "listeningInterface" : "lo",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie3958714061063816088test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "numAddWorkerThreads" : "0",
  "numReadWorkerThreads" : "0"
}
21:32:40.584 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:40.585 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40285/ledgers : zkServers = localhost:40285, ledgersRootPath = /ledgers.
21:32:40.585 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40285 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@6eff0135
21:32:40.585 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:40.586 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:40.586 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40285.
21:32:40.586 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:40.586 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:56656, server: localhost/127.0.0.1:40285
21:32:40.594 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40285, session id = 0x100016f25fe0004, negotiated timeout = 10000
21:32:40.599 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:40.601 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:40.605 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie3958714061063816088test/current] [/tmp/bookie3958714061063816088test/current]
21:32:40.608 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:40.609 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie3958714061063816088test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:40.609 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:40.609 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:40.610 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:40.610 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:40.610 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:40.610 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:40.613 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:35645 to become writable
21:32:40.613 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:40.614 [SyncThread-118-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:40.615 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:40.620 [BookieJournal-35645] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie3958714061063816088test/current
21:32:40.621 [BookieJournal-35645] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie3958714061063816088test/current/17ce3a42fad.txn
21:32:40.623 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:40.634 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:35645 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:35645, port=35645, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:40.635 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:35645
21:32:40.758 [BookieDeathWatcher-43629] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:40.758 [BookieDeathWatcher-43629] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-43629
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:40.758 [BookieDeathWatcher-43629] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:40.758 [BookieDeathWatcher-43629] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:40.883 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:35645' has been created.
21:32:40.884 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testReadEntryBeyondLac @ metadata service zk://localhost:40285/ledgers in 933 ms.
21:32:40.886 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40285/ledgers : zkServers = localhost:40285, ledgersRootPath = /ledgers.
21:32:40.886 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:40285 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@1c4995fa
21:32:40.886 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:40.886 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:40.889 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:40285.
21:32:40.889 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:40.889 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:56658, server: localhost/127.0.0.1:40285
21:32:40.891 [Time-limited test-SendThread(localhost:40285)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:40285, session id = 0x100016f25fe0005, negotiated timeout = 10000
21:32:40.891 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:40.894 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:40.894 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
21:32:40.894 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
21:32:40.894 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
21:32:40.899 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:44951 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:44951, port=44951, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:40.899 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:35645 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:35645, port=35645, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:40.900 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:39797 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:39797, port=39797, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:40.900 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:35645
21:32:40.901 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:44951
21:32:40.901 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:39797
21:32:40.902 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
21:32:40.902 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:44951, 127.0.0.1:39797, 127.0.0.1:35645] is not adhering to Placement Policy. quarantinedBookies: []
21:32:40.916 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:44951, 127.0.0.1:39797, 127.0.0.1:35645] for ledger: 0
21:32:40.921 [Time-limited test] ERROR org.apache.bookkeeper.client.LedgerHandle - ReadEntries exception on ledgerId:0 firstEntry:100 lastEntry:100 lastAddConfirmed:-1
21:32:41.032 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f25fe0005 closed
21:32:41.032 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f25fe0005
21:32:41.034 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
21:32:41.049 [Time-limited test-SendThread(localhost:40285)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f25fe0001.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f25fe0001, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:41.150 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f25fe0001 closed
21:32:41.150 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:41.150 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f25fe0001
21:32:41.150 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:41.157 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-44951 with exitCode 0
21:32:41.157 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:41.157 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:41.158 [SyncThread-100-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:41.160 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:41.160 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:41.160 [BookieJournal-44951] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:41.160 [BookieJournal-44951] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:41.160 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:41.161 [Bookie-44951] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:41.161 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:41.161 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:41.161 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:41.161 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:41.161 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:41.161 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:41.161 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:41.161 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:41.269 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f25fe0002 closed
21:32:41.269 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f25fe0002
21:32:41.270 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:41.270 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:41.279 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-39797 with exitCode 0
21:32:41.279 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:41.279 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:41.280 [SyncThread-109-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:41.281 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:41.281 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:41.281 [BookieJournal-39797] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:41.281 [BookieJournal-39797] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:41.281 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:41.281 [Bookie-39797] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:41.282 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:41.282 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:41.282 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:41.282 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:41.282 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:41.282 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:41.282 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:41.282 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:41.290 [Time-limited test-SendThread(localhost:40285)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f25fe0003.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f25fe0003, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:41.391 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f25fe0003 closed
21:32:41.391 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f25fe0003
21:32:41.391 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:41.392 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:41.398 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-35645 with exitCode 0
21:32:41.398 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:41.398 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:41.398 [SyncThread-118-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:41.400 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:41.400 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:41.400 [BookieJournal-35645] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:41.400 [BookieJournal-35645] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:41.400 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:41.400 [Bookie-35645] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:41.401 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:41.401 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:41.401 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:41.401 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:41.401 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:41.407 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:41.407 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:41.407 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:41.409 [Time-limited test-SendThread(localhost:40285)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f25fe0004.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f25fe0004, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:41.509 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f25fe0004 closed
21:32:41.509 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f25fe0004
21:32:41.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
21:32:41.612 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f25fe0000 closed
21:32:41.612 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f25fe0000
21:32:41.613 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
21:32:41.613 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
21:32:41.613 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
21:32:41.613 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
21:32:41.614 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
21:32:41.614 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
21:32:41.614 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
21:32:41.614 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
21:32:41.614 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
21:32:41.614 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
21:32:41.614 [ProcessThread(sid:0 cport:40285):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
21:32:41.614 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
21:32:41.614 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
21:32:41.615 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 40285
21:32:41.616 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testReadEntryBeyondLac in 582 ms.
21:32:41.618 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
21:32:41.618 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
21:32:41.618 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
21:32:41.618 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
21:32:41.618 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
21:32:41.618 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
21:32:41.618 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
21:32:41.618 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
21:32:41.618 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
21:32:41.618 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
21:32:41.618 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
21:32:41.618 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
21:32:41.618 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
21:32:41.618 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
21:32:41.618 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
21:32:41.618 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
21:32:41.619 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
21:32:41.619 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
21:32:41.619 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper6608431512241031835test/version-2 snapdir /tmp/zookeeper6608431512241031835test/version-2
21:32:41.619 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
21:32:41.619 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
21:32:41.619 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
21:32:41.621 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper6608431512241031835test/version-2/snapshot.0
21:32:41.622 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 1 ms, highest zxid is 0x0, digest is 1371985504
21:32:41.622 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper6608431512241031835test/version-2/snapshot.0
21:32:41.622 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 0 ms
21:32:41.634 [BookieDeathWatcher-35645] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:41.634 [BookieDeathWatcher-35645] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-35645
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:41.634 [ProcessThread(sid:0 cport:42073):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
21:32:41.635 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 42073
21:32:41.636 [BookieDeathWatcher-35645] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:41.637 [BookieDeathWatcher-35645] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:41.641 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:53844
21:32:41.641 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
21:32:41.642 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42073 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@79d05a10
21:32:41.642 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:41.642 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:41.644 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42073.
21:32:41.644 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:41.645 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:53846, server: localhost/127.0.0.1:42073
21:32:41.645 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
21:32:41.648 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42073, session id = 0x100016f2c7d0000, negotiated timeout = 10000
21:32:41.648 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:41.658 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42073/ledgers : zkServers = localhost:42073, ledgersRootPath = /ledgers.
21:32:41.658 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42073 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@6e4d7ddd
21:32:41.658 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:41.659 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:41.659 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42073.
21:32:41.659 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:41.659 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:53848, server: localhost/127.0.0.1:42073
21:32:41.661 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42073, session id = 0x100016f2c7d0001, negotiated timeout = 10000
21:32:41.661 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:41.663 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:41.663 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
21:32:41.663 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
21:32:41.663 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
21:32:41.670 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:41.670 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "allowEphemeralPorts" : "true",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "allowLoopback" : "true",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "bookiePort" : "0",
  "ledgerDirectories" : "/tmp/bookie8545688955120047859test",
  "numAddWorkerThreads" : "0",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "readOnlyModeEnabled" : "true",
  "entryLogFilePreallocationEnabled" : "false",
  "diskUsageThreshold" : "0.999",
  "listeningInterface" : "lo",
  "journalFormatVersionToWrite" : "5",
  "numReadWorkerThreads" : "0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "diskUsageWarnThreshold" : "0.99",
  "gcWaitTime" : "1000",
  "journalDirectories" : "/tmp/bookie8545688955120047859test",
  "metadataServiceUri" : "zk://localhost:42073/ledgers",
  "preserveMdcForTaskExecution" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807"
}
21:32:41.672 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:41.673 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42073/ledgers : zkServers = localhost:42073, ledgersRootPath = /ledgers.
21:32:41.673 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42073 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@8d2e853
21:32:41.673 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:41.674 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:41.675 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42073.
21:32:41.675 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:41.675 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:53850, server: localhost/127.0.0.1:42073
21:32:41.676 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42073, session id = 0x100016f2c7d0002, negotiated timeout = 10000
21:32:41.677 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:41.678 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:41.686 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie8545688955120047859test/current] [/tmp/bookie8545688955120047859test/current]
21:32:41.691 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:41.691 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie8545688955120047859test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:41.692 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:41.692 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:41.692 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:41.693 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:41.693 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:41.693 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:41.713 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:44207 to become writable
21:32:41.714 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:41.715 [SyncThread-139-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:41.716 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:41.721 [BookieJournal-44207] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie8545688955120047859test/current
21:32:41.721 [BookieJournal-44207] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie8545688955120047859test/current/17ce3a433fa.txn
21:32:41.721 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:41.729 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:44207 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:44207, port=44207, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:41.730 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:44207
21:32:41.977 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:44207' has been created.
21:32:41.978 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:41.978 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "journalFormatVersionToWrite" : "5",
  "numAddWorkerThreads" : "0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "preserveMdcForTaskExecution" : "true",
  "readOnlyModeEnabled" : "true",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "allowLoopback" : "true",
  "gcWaitTime" : "1000",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "diskUsageWarnThreshold" : "0.99",
  "bookiePort" : "0",
  "ledgerDirectories" : "/tmp/bookie5247798307224746808test",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "numReadWorkerThreads" : "0",
  "listeningInterface" : "lo",
  "journalDirectories" : "/tmp/bookie5247798307224746808test",
  "metadataServiceUri" : "zk://localhost:42073/ledgers",
  "dbStorage_readAheadCacheMaxSizeMb" : "4"
}
21:32:41.981 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:41.985 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42073/ledgers : zkServers = localhost:42073, ledgersRootPath = /ledgers.
21:32:41.985 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42073 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@72cc1e66
21:32:41.985 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:41.986 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:41.986 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42073.
21:32:41.986 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:41.986 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:53852, server: localhost/127.0.0.1:42073
21:32:41.988 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42073, session id = 0x100016f2c7d0003, negotiated timeout = 10000
21:32:41.988 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:41.990 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:41.994 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie5247798307224746808test/current] [/tmp/bookie5247798307224746808test/current]
21:32:42.000 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:42.001 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie5247798307224746808test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:42.001 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:42.001 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:42.001 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:42.002 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:42.002 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:42.002 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:42.007 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:44899 to become writable
21:32:42.008 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 1 ms.
21:32:42.008 [SyncThread-148-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:42.010 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:42.010 [BookieJournal-44899] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie5247798307224746808test/current
21:32:42.011 [BookieJournal-44899] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie5247798307224746808test/current/17ce3a4351c.txn
21:32:42.012 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:42.020 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:44899 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:44899, port=44899, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:42.021 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:44899
21:32:42.045 [BookieDeathWatcher-44951] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:42.045 [BookieDeathWatcher-44951] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-44951
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:42.046 [BookieDeathWatcher-44951] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:42.046 [BookieDeathWatcher-44951] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:42.269 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:44899' has been created.
21:32:42.270 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:42.271 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "numReadWorkerThreads" : "0",
  "journalFormatVersionToWrite" : "5",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "journalDirectories" : "/tmp/bookie3950962496380494615test",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "bookiePort" : "0",
  "allowLoopback" : "true",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "readOnlyModeEnabled" : "true",
  "listeningInterface" : "lo",
  "diskUsageWarnThreshold" : "0.99",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "preserveMdcForTaskExecution" : "true",
  "journalFlushWhenQueueEmpty" : "true",
  "entryLogFilePreallocationEnabled" : "false",
  "enableTaskExecutionStats" : "true",
  "metadataServiceUri" : "zk://localhost:42073/ledgers",
  "diskUsageThreshold" : "0.999",
  "ledgerDirectories" : "/tmp/bookie3950962496380494615test",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "allowEphemeralPorts" : "true",
  "gcWaitTime" : "1000",
  "numAddWorkerThreads" : "0"
}
21:32:42.273 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:42.275 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42073/ledgers : zkServers = localhost:42073, ledgersRootPath = /ledgers.
21:32:42.275 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42073 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@7f3a8399
21:32:42.275 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:42.275 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:42.277 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42073.
21:32:42.277 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:42.278 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:53854, server: localhost/127.0.0.1:42073
21:32:42.279 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42073, session id = 0x100016f2c7d0004, negotiated timeout = 10000
21:32:42.280 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:42.281 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:42.285 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie3950962496380494615test/current] [/tmp/bookie3950962496380494615test/current]
21:32:42.289 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:42.289 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie3950962496380494615test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:42.289 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:42.290 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:42.290 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:42.290 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:42.290 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:42.290 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:42.296 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:35897 to become writable
21:32:42.296 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:42.297 [SyncThread-157-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:42.298 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:42.299 [BookieJournal-35897] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie3950962496380494615test/current
21:32:42.300 [BookieJournal-35897] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie3950962496380494615test/current/17ce3a4363d.txn
21:32:42.300 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:42.308 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:35897 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:35897, port=35897, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:42.309 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:35897
21:32:42.330 [BookieDeathWatcher-39797] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:42.330 [BookieDeathWatcher-39797] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-39797
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:42.331 [BookieDeathWatcher-39797] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:42.331 [BookieDeathWatcher-39797] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:42.557 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:35897' has been created.
21:32:42.558 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testLedgerCreateFails @ metadata service zk://localhost:42073/ledgers in 940 ms.
21:32:42.559 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42073/ledgers : zkServers = localhost:42073, ledgersRootPath = /ledgers.
21:32:42.559 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42073 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@7ebf4570
21:32:42.560 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:42.560 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:42.565 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42073.
21:32:42.565 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:42.565 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:53856, server: localhost/127.0.0.1:42073
21:32:42.566 [Time-limited test-SendThread(localhost:42073)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42073, session id = 0x100016f2c7d0005, negotiated timeout = 10000
21:32:42.566 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:42.568 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:42.569 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
21:32:42.569 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
21:32:42.569 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
21:32:42.581 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:35897 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:35897, port=35897, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:42.581 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:44207 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:44207, port=44207, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:42.581 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:44899 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:44899, port=44899, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:42.581 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:44207
21:32:42.581 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:44899
21:32:42.581 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:35897
21:32:42.585 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
21:32:42.585 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:35897, 127.0.0.1:44899, 127.0.0.1:44207] is not adhering to Placement Policy. quarantinedBookies: []
21:32:42.594 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:35897, 127.0.0.1:44899, 127.0.0.1:44207] for ledger: 0
21:32:42.598 [Time-limited test] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 96 bookies : excludeBookies [<Bookie:127.0.0.1:44207>, <Bookie:127.0.0.1:44899>, <Bookie:127.0.0.1:35897>], allBookies [<Bookie:127.0.0.1:44207>, <Bookie:127.0.0.1:44899>, <Bookie:127.0.0.1:35897>].
21:32:42.598 [Time-limited test] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 96 bookies : excludeBookies [<Bookie:127.0.0.1:35897>, <Bookie:127.0.0.1:44899>, <Bookie:127.0.0.1:44207>], allBookies [<Bookie:127.0.0.1:44899>, <Bookie:127.0.0.1:35897>, <Bookie:127.0.0.1:44207>].
21:32:42.599 [Time-limited test] ERROR org.apache.bookkeeper.client.LedgerCreateOp - Not enough bookies to create ledger with ensembleSize=99, writeQuorumSize=3 and ackQuorumSize=2
21:32:42.623 [Time-limited test-SendThread(localhost:42073)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f2c7d0005.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f2c7d0005, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:42.725 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f2c7d0005
21:32:42.725 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f2c7d0005 closed
21:32:42.726 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
21:32:42.728 [Time-limited test-SendThread(localhost:42073)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f2c7d0001.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f2c7d0001, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:42.828 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f2c7d0001 closed
21:32:42.829 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:42.829 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:42.829 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f2c7d0001
21:32:42.832 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-44207 with exitCode 0
21:32:42.832 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:42.832 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:42.832 [SyncThread-139-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:42.833 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:42.834 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:42.834 [BookieJournal-44207] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:42.834 [BookieJournal-44207] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:42.834 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:42.834 [Bookie-44207] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:42.834 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:42.834 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:42.834 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:42.834 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:42.834 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:42.834 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:42.834 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:42.834 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:42.842 [Time-limited test-SendThread(localhost:42073)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f2c7d0002.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f2c7d0002, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:42.943 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f2c7d0002 closed
21:32:42.943 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:42.943 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:42.943 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f2c7d0002
21:32:42.944 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-44899 with exitCode 0
21:32:42.945 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:42.945 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:42.945 [SyncThread-148-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:42.946 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:42.946 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:42.946 [BookieJournal-44899] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:42.946 [BookieJournal-44899] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:42.946 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:42.946 [Bookie-44899] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:42.946 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:42.947 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:42.947 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:42.947 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:42.947 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:42.947 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:42.947 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:42.947 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:42.955 [Time-limited test-SendThread(localhost:42073)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f2c7d0003.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f2c7d0003, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:43.055 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f2c7d0003 closed
21:32:43.055 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f2c7d0003
21:32:43.056 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:43.056 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:43.059 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-35897 with exitCode 0
21:32:43.059 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:43.059 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:43.059 [SyncThread-157-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:43.060 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:43.060 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:43.060 [BookieJournal-35897] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:43.060 [BookieJournal-35897] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:43.061 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:43.061 [Bookie-35897] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:43.061 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:43.061 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:43.061 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:43.061 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:43.061 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:43.061 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:43.061 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:43.061 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:43.069 [Time-limited test-SendThread(localhost:42073)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f2c7d0004.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f2c7d0004, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:43.169 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f2c7d0004 closed
21:32:43.171 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f2c7d0004
21:32:43.172 [Time-limited test-SendThread(localhost:42073)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f2c7d0000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f2c7d0000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:43.273 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f2c7d0000 closed
21:32:43.273 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f2c7d0000
21:32:43.273 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
21:32:43.273 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
21:32:43.274 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
21:32:43.274 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
21:32:43.274 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
21:32:43.274 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
21:32:43.274 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
21:32:43.274 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
21:32:43.274 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
21:32:43.274 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
21:32:43.274 [ProcessThread(sid:0 cport:42073):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
21:32:43.274 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
21:32:43.275 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
21:32:43.275 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 42073
21:32:43.278 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testLedgerCreateFails in 552 ms.
21:32:43.284 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
21:32:43.284 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
21:32:43.284 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
21:32:43.284 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
21:32:43.284 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
21:32:43.284 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
21:32:43.284 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
21:32:43.284 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
21:32:43.284 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
21:32:43.284 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
21:32:43.284 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
21:32:43.284 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
21:32:43.284 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
21:32:43.285 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
21:32:43.285 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
21:32:43.285 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
21:32:43.285 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
21:32:43.285 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
21:32:43.285 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper3394129439113773008test/version-2 snapdir /tmp/zookeeper3394129439113773008test/version-2
21:32:43.285 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
21:32:43.285 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
21:32:43.285 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
21:32:43.285 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper3394129439113773008test/version-2/snapshot.0
21:32:43.286 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 1 ms, highest zxid is 0x0, digest is 1371985504
21:32:43.286 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper3394129439113773008test/version-2/snapshot.0
21:32:43.286 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 0 ms
21:32:43.287 [ProcessThread(sid:0 cport:39247):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
21:32:43.287 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 39247
21:32:43.288 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:57466
21:32:43.288 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
21:32:43.289 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39247 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@149fa9aa
21:32:43.289 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:43.289 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:43.293 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39247.
21:32:43.293 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:43.293 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:57468, server: localhost/127.0.0.1:39247
21:32:43.294 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
21:32:43.296 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39247, session id = 0x100016f32fd0000, negotiated timeout = 10000
21:32:43.296 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:43.307 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39247/ledgers : zkServers = localhost:39247, ledgersRootPath = /ledgers.
21:32:43.307 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39247 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@7b5015a0
21:32:43.307 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:43.307 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:43.307 [BookieDeathWatcher-35897] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:43.307 [BookieDeathWatcher-35897] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-35897
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:43.308 [BookieDeathWatcher-35897] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:43.308 [BookieDeathWatcher-35897] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:43.308 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39247.
21:32:43.308 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:43.308 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:57470, server: localhost/127.0.0.1:39247
21:32:43.309 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39247, session id = 0x100016f32fd0001, negotiated timeout = 10000
21:32:43.309 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:43.310 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:43.311 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
21:32:43.311 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
21:32:43.311 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
21:32:43.321 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:43.321 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "allowLoopback" : "true",
  "journalFlushWhenQueueEmpty" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "gcWaitTime" : "1000",
  "numAddWorkerThreads" : "0",
  "numReadWorkerThreads" : "0",
  "diskUsageWarnThreshold" : "0.99",
  "listeningInterface" : "lo",
  "bookiePort" : "0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "journalFormatVersionToWrite" : "5",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "journalDirectories" : "/tmp/bookie6460049384345168929test",
  "diskUsageThreshold" : "0.999",
  "preserveMdcForTaskExecution" : "true",
  "allowEphemeralPorts" : "true",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "enableTaskExecutionStats" : "true",
  "entryLogFilePreallocationEnabled" : "false",
  "metadataServiceUri" : "zk://localhost:39247/ledgers",
  "ledgerDirectories" : "/tmp/bookie6460049384345168929test",
  "readOnlyModeEnabled" : "true"
}
21:32:43.323 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:43.325 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39247/ledgers : zkServers = localhost:39247, ledgersRootPath = /ledgers.
21:32:43.325 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39247 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@5986ba3a
21:32:43.325 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:43.325 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:43.331 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39247.
21:32:43.331 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:43.331 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:57472, server: localhost/127.0.0.1:39247
21:32:43.332 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39247, session id = 0x100016f32fd0002, negotiated timeout = 10000
21:32:43.332 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:43.336 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:43.339 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie6460049384345168929test/current] [/tmp/bookie6460049384345168929test/current]
21:32:43.344 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:43.345 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie6460049384345168929test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:43.345 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:43.345 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:43.345 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:43.346 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:43.346 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:43.346 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:43.356 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:37191 to become writable
21:32:43.356 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:43.357 [SyncThread-178-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:43.359 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:43.362 [BookieJournal-37191] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie6460049384345168929test/current
21:32:43.365 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:43.365 [BookieJournal-37191] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie6460049384345168929test/current/17ce3a43a66.txn
21:32:43.368 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:37191 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:37191, port=37191, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:43.369 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:37191
21:32:43.618 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:37191' has been created.
21:32:43.619 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:43.620 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "bookiePort" : "0",
  "metadataServiceUri" : "zk://localhost:39247/ledgers",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "journalDirectories" : "/tmp/bookie3191668105363717289test",
  "listeningInterface" : "lo",
  "entryLogFilePreallocationEnabled" : "false",
  "preserveMdcForTaskExecution" : "true",
  "journalFormatVersionToWrite" : "5",
  "journalFlushWhenQueueEmpty" : "true",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true",
  "ledgerDirectories" : "/tmp/bookie3191668105363717289test",
  "diskUsageWarnThreshold" : "0.99",
  "enableTaskExecutionStats" : "true",
  "numReadWorkerThreads" : "0",
  "allowEphemeralPorts" : "true",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "numAddWorkerThreads" : "0",
  "diskUsageThreshold" : "0.999"
}
21:32:43.622 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:43.624 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39247/ledgers : zkServers = localhost:39247, ledgersRootPath = /ledgers.
21:32:43.624 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39247 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@204840e5
21:32:43.624 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:43.624 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:43.624 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39247.
21:32:43.624 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:43.625 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:57474, server: localhost/127.0.0.1:39247
21:32:43.626 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39247, session id = 0x100016f32fd0003, negotiated timeout = 10000
21:32:43.626 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:43.628 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:43.633 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie3191668105363717289test/current] [/tmp/bookie3191668105363717289test/current]
21:32:43.640 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:43.643 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie3191668105363717289test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:43.643 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:43.643 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:43.643 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:43.644 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:43.644 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:43.644 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:43.648 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:40241 to become writable
21:32:43.648 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:43.648 [SyncThread-187-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:43.650 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:43.653 [BookieJournal-40241] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie3191668105363717289test/current
21:32:43.653 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:43.653 [BookieJournal-40241] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie3191668105363717289test/current/17ce3a43b86.txn
21:32:43.660 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:40241 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:40241, port=40241, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:43.660 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:40241
21:32:43.727 [BookieDeathWatcher-44207] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:43.727 [BookieDeathWatcher-44207] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-44207
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:43.727 [BookieDeathWatcher-44207] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:43.727 [BookieDeathWatcher-44207] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:43.910 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:40241' has been created.
21:32:43.911 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:43.912 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "entryLogFilePreallocationEnabled" : "false",
  "numAddWorkerThreads" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "journalDirectories" : "/tmp/bookie5009591630493916321test",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "bookiePort" : "0",
  "allowLoopback" : "true",
  "metadataServiceUri" : "zk://localhost:39247/ledgers",
  "diskUsageThreshold" : "0.999",
  "numReadWorkerThreads" : "0",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageWarnThreshold" : "0.99",
  "enableTaskExecutionStats" : "true",
  "journalFormatVersionToWrite" : "5",
  "readOnlyModeEnabled" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "ledgerDirectories" : "/tmp/bookie5009591630493916321test",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "gcWaitTime" : "1000",
  "journalFlushWhenQueueEmpty" : "true",
  "preserveMdcForTaskExecution" : "true"
}
21:32:43.915 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:43.917 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39247/ledgers : zkServers = localhost:39247, ledgersRootPath = /ledgers.
21:32:43.917 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39247 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@122a7acd
21:32:43.917 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:43.917 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:43.919 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39247.
21:32:43.919 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:43.920 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:57476, server: localhost/127.0.0.1:39247
21:32:43.921 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39247, session id = 0x100016f32fd0004, negotiated timeout = 10000
21:32:43.921 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:43.923 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:43.927 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie5009591630493916321test/current] [/tmp/bookie5009591630493916321test/current]
21:32:43.931 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:43.932 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie5009591630493916321test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:43.932 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:43.932 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:43.932 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:43.933 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:43.933 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:43.933 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:43.937 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:44967 to become writable
21:32:43.937 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:43.938 [SyncThread-196-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:43.939 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:43.940 [BookieJournal-44967] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie5009591630493916321test/current
21:32:43.941 [BookieJournal-44967] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie5009591630493916321test/current/17ce3a43ca5.txn
21:32:43.942 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:43.949 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:44967 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:44967, port=44967, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:43.950 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:44967
21:32:44.019 [BookieDeathWatcher-44899] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:44.019 [BookieDeathWatcher-44899] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-44899
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:44.020 [BookieDeathWatcher-44899] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:44.020 [BookieDeathWatcher-44899] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:44.198 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:44967' has been created.
21:32:44.199 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testReadFromDeletedLedger @ metadata service zk://localhost:39247/ledgers in 915 ms.
21:32:44.203 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39247/ledgers : zkServers = localhost:39247, ledgersRootPath = /ledgers.
21:32:44.203 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:39247 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@50627af7
21:32:44.203 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:44.203 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:44.205 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:39247.
21:32:44.205 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:44.205 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:57478, server: localhost/127.0.0.1:39247
21:32:44.206 [Time-limited test-SendThread(localhost:39247)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:39247, session id = 0x100016f32fd0005, negotiated timeout = 10000
21:32:44.207 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:44.208 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:44.208 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
21:32:44.208 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
21:32:44.208 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
21:32:44.211 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:40241 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:40241, port=40241, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:44.211 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:44967 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:44967, port=44967, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:44.211 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:37191 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:37191, port=37191, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:44.211 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:44967
21:32:44.211 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:40241
21:32:44.212 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:37191
21:32:44.212 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
21:32:44.212 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:40241, 127.0.0.1:44967, 127.0.0.1:37191] is not adhering to Placement Policy. quarantinedBookies: []
21:32:44.222 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:40241, 127.0.0.1:44967, 127.0.0.1:37191] for ledger: 0
21:32:44.230 [bookkeeper-io-202-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:40241 [id: 0x5cd7b4f1, L:/127.0.0.1:59438 - R:127.0.0.1/127.0.0.1:40241]
21:32:44.237 [bookkeeper-io-202-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x5cd7b4f1, L:/127.0.0.1:59438 - R:127.0.0.1/127.0.0.1:40241] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:44.240 [bookie-io-182-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:44.243 [bookie-io-182-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x2cf771b1, L:/127.0.0.1:40241 - R:/127.0.0.1:59438]
21:32:44.244 [bookkeeper-io-202-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:44967 [id: 0x1e9cd456, L:/127.0.0.1:35794 - R:127.0.0.1/127.0.0.1:44967]
21:32:44.245 [bookkeeper-io-202-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x1e9cd456, L:/127.0.0.1:35794 - R:127.0.0.1/127.0.0.1:44967] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:44.245 [bookie-io-182-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:44.245 [bookie-io-182-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie3191668105363717289test/current/0.log for logId 0.
21:32:44.248 [bookkeeper-io-202-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:37191 [id: 0xf5450fcb, L:/127.0.0.1:34262 - R:127.0.0.1/127.0.0.1:37191]
21:32:44.252 [bookkeeper-io-202-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xf5450fcb, L:/127.0.0.1:34262 - R:127.0.0.1/127.0.0.1:37191] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:44.252 [bookie-io-173-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:44.253 [bookie-io-173-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x5ee6191e, L:/127.0.0.1:37191 - R:/127.0.0.1:34262]
21:32:44.257 [bookie-io-173-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:44.257 [bookie-io-173-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie6460049384345168929test/current/0.log for logId 0.
21:32:44.259 [bookie-io-191-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:44.259 [bookie-io-191-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xae25cfb5, L:/127.0.0.1:44967 - R:/127.0.0.1:35794]
21:32:44.260 [bookie-io-191-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:44.260 [bookie-io-191-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie5009591630493916321test/current/0.log for logId 0.
21:32:44.281 [Time-limited test] ERROR org.apache.bookkeeper.client.LedgerHandle - ReadEntries exception on ledgerId:0 firstEntry:100 lastEntry:100 lastAddConfirmed:0
21:32:44.282 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:40241
21:32:44.283 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:44967
21:32:44.283 [bookkeeper-io-202-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x5cd7b4f1, L:/127.0.0.1:59438 ! R:127.0.0.1/127.0.0.1:40241]
21:32:44.283 [bookie-io-182-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x2cf771b1, L:/127.0.0.1:40241 ! R:/127.0.0.1:59438]
21:32:44.283 [bookkeeper-io-202-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x1e9cd456, L:/127.0.0.1:35794 ! R:127.0.0.1/127.0.0.1:44967]
21:32:44.283 [bookie-io-191-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xae25cfb5, L:/127.0.0.1:44967 ! R:/127.0.0.1:35794]
21:32:44.284 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:37191
21:32:44.285 [bookkeeper-io-202-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xf5450fcb, L:/127.0.0.1:34262 ! R:127.0.0.1/127.0.0.1:37191]
21:32:44.286 [bookie-io-173-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x5ee6191e, L:/127.0.0.1:37191 ! R:/127.0.0.1:34262]
21:32:44.292 [Time-limited test-SendThread(localhost:39247)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f32fd0005.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f32fd0005, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:44.392 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f32fd0005 closed
21:32:44.393 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f32fd0005
21:32:44.393 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
21:32:44.496 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f32fd0001 closed
21:32:44.496 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f32fd0001
21:32:44.496 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:44.496 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:44.497 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-37191 with exitCode 0
21:32:44.498 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:44.498 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:44.501 [SyncThread-178-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635906763366 , logFileOffset - 1536]}.
21:32:44.510 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:44.510 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:44.510 [BookieJournal-37191] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:44.510 [BookieJournal-37191] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:44.510 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:44.510 [Bookie-37191] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:44.510 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:44.510 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:44.510 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:44.510 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:44.510 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:44.511 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:44.511 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:44.511 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:44.512 [pool-126-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-126-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:44.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
21:32:44.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
21:32:44.619 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f32fd0002 closed
21:32:44.619 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:44.619 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:44.619 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f32fd0002
21:32:44.623 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-40241 with exitCode 0
21:32:44.623 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:44.623 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:44.634 [SyncThread-187-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635906763654 , logFileOffset - 1024]}.
21:32:44.643 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:44.643 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:44.643 [BookieJournal-40241] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:44.643 [BookieJournal-40241] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:44.643 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:44.644 [Bookie-40241] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:44.644 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:44.644 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:44.644 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:44.644 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:44.644 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:44.644 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:44.645 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:44.645 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:44.646 [pool-132-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-132-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:44.652 [Time-limited test-SendThread(localhost:39247)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f32fd0003.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f32fd0003, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:44.752 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f32fd0003 closed
21:32:44.752 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:44.752 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:44.753 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f32fd0003
21:32:44.754 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-44967 with exitCode 0
21:32:44.754 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:44.754 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:44.765 [SyncThread-196-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635906763941 , logFileOffset - 1536]}.
21:32:44.774 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:44.774 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:44.774 [BookieJournal-44967] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:44.774 [BookieJournal-44967] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:44.774 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:44.775 [Bookie-44967] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:44.775 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:44.775 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:44.775 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:44.775 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:44.775 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:44.776 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:44.776 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:44.776 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:44.777 [pool-138-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-138-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:44.883 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f32fd0004 closed
21:32:44.883 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f32fd0004
21:32:44.948 [BookieDeathWatcher-44967] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:44.948 [BookieDeathWatcher-44967] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-44967
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:44.949 [BookieDeathWatcher-44967] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:44.949 [BookieDeathWatcher-44967] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:44.985 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f32fd0000 closed
21:32:44.985 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f32fd0000
21:32:44.986 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
21:32:44.986 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
21:32:44.986 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
21:32:44.987 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
21:32:44.987 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
21:32:44.987 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
21:32:44.987 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
21:32:44.987 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
21:32:44.987 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
21:32:44.987 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
21:32:44.987 [ProcessThread(sid:0 cport:39247):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
21:32:44.987 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
21:32:44.987 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
21:32:44.988 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 39247
21:32:44.990 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testReadFromDeletedLedger in 596 ms.
21:32:44.997 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
21:32:44.997 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
21:32:44.997 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
21:32:44.997 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
21:32:44.997 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
21:32:44.997 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
21:32:44.997 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
21:32:44.997 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
21:32:44.997 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
21:32:44.997 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
21:32:44.997 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
21:32:44.997 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
21:32:44.997 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
21:32:44.997 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
21:32:44.997 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
21:32:44.997 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
21:32:44.998 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
21:32:44.998 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
21:32:44.998 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper5593267282390713850test/version-2 snapdir /tmp/zookeeper5593267282390713850test/version-2
21:32:44.998 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
21:32:44.998 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
21:32:44.998 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
21:32:45.007 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper5593267282390713850test/version-2/snapshot.0
21:32:45.008 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 1 ms, highest zxid is 0x0, digest is 1371985504
21:32:45.008 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper5593267282390713850test/version-2/snapshot.0
21:32:45.008 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 0 ms
21:32:45.009 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 42043
21:32:45.013 [ProcessThread(sid:0 cport:42043):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
21:32:45.013 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:49516
21:32:45.013 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
21:32:45.014 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42043 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@7240c878
21:32:45.014 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:45.014 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:45.017 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42043.
21:32:45.017 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:45.017 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:49518, server: localhost/127.0.0.1:42043
21:32:45.019 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
21:32:45.022 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42043, session id = 0x100016f39b70000, negotiated timeout = 10000
21:32:45.022 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:45.031 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42043/ledgers : zkServers = localhost:42043, ledgersRootPath = /ledgers.
21:32:45.031 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42043 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@3649a9cc
21:32:45.031 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:45.031 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:45.033 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42043.
21:32:45.033 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:45.033 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:49520, server: localhost/127.0.0.1:42043
21:32:45.034 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42043, session id = 0x100016f39b70001, negotiated timeout = 10000
21:32:45.034 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:45.035 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:45.035 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
21:32:45.036 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
21:32:45.036 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
21:32:45.041 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:45.042 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "allowLoopback" : "true",
  "ledgerDirectories" : "/tmp/bookie2183439682623541810test",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "metadataServiceUri" : "zk://localhost:42043/ledgers",
  "gcWaitTime" : "1000",
  "enableTaskExecutionStats" : "true",
  "entryLogFilePreallocationEnabled" : "false",
  "numAddWorkerThreads" : "0",
  "journalDirectories" : "/tmp/bookie2183439682623541810test",
  "journalFlushWhenQueueEmpty" : "true",
  "allowEphemeralPorts" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "readOnlyModeEnabled" : "true",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "preserveMdcForTaskExecution" : "true",
  "diskUsageThreshold" : "0.999",
  "listeningInterface" : "lo",
  "numReadWorkerThreads" : "0",
  "journalFormatVersionToWrite" : "5",
  "diskUsageWarnThreshold" : "0.99"
}
21:32:45.043 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:45.045 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42043/ledgers : zkServers = localhost:42043, ledgersRootPath = /ledgers.
21:32:45.045 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42043 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@7980fa86
21:32:45.046 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:45.046 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:45.049 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42043.
21:32:45.049 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:45.049 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:49522, server: localhost/127.0.0.1:42043
21:32:45.051 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42043, session id = 0x100016f39b70002, negotiated timeout = 10000
21:32:45.053 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:45.055 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:45.058 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie2183439682623541810test/current] [/tmp/bookie2183439682623541810test/current]
21:32:45.067 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:45.068 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie2183439682623541810test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:45.068 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:45.068 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:45.068 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:45.069 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:45.069 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:45.069 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:45.076 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:42227 to become writable
21:32:45.077 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:45.077 [SyncThread-217-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:45.079 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:45.081 [BookieJournal-42227] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie2183439682623541810test/current
21:32:45.082 [BookieJournal-42227] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie2183439682623541810test/current/17ce3a4411b.txn
21:32:45.085 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:45.089 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:42227 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:42227, port=42227, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:45.089 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:42227
21:32:45.338 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:42227' has been created.
21:32:45.339 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:45.339 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "journalDirectories" : "/tmp/bookie9073703961323432916test",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "numReadWorkerThreads" : "0",
  "enableTaskExecutionStats" : "true",
  "diskUsageThreshold" : "0.999",
  "readOnlyModeEnabled" : "true",
  "allowEphemeralPorts" : "true",
  "journalFormatVersionToWrite" : "5",
  "preserveMdcForTaskExecution" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "bookiePort" : "0",
  "ledgerDirectories" : "/tmp/bookie9073703961323432916test",
  "journalFlushWhenQueueEmpty" : "true",
  "numAddWorkerThreads" : "0",
  "listeningInterface" : "lo",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "diskUsageWarnThreshold" : "0.99",
  "metadataServiceUri" : "zk://localhost:42043/ledgers",
  "allowLoopback" : "true",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4"
}
21:32:45.341 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:45.342 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42043/ledgers : zkServers = localhost:42043, ledgersRootPath = /ledgers.
21:32:45.342 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42043 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@30dd1b27
21:32:45.342 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:45.342 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:45.343 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42043.
21:32:45.343 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:45.343 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:49524, server: localhost/127.0.0.1:42043
21:32:45.345 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42043, session id = 0x100016f39b70003, negotiated timeout = 10000
21:32:45.345 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:45.347 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:45.351 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie9073703961323432916test/current] [/tmp/bookie9073703961323432916test/current]
21:32:45.354 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:45.360 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie9073703961323432916test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:45.360 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:45.361 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:45.361 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:45.361 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:45.362 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:45.362 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:45.365 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:36401 to become writable
21:32:45.365 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:45.366 [SyncThread-226-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:45.367 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:45.369 [BookieDeathWatcher-37191] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:45.369 [BookieDeathWatcher-37191] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37191
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:45.369 [BookieDeathWatcher-37191] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:45.369 [BookieDeathWatcher-37191] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:45.369 [BookieJournal-36401] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie9073703961323432916test/current
21:32:45.370 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:45.370 [BookieJournal-36401] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie9073703961323432916test/current/17ce3a4423b.txn
21:32:45.377 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:36401 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:36401, port=36401, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:45.378 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:36401
21:32:45.626 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:36401' has been created.
21:32:45.627 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:45.628 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "enableTaskExecutionStats" : "true",
  "diskUsageThreshold" : "0.999",
  "metadataServiceUri" : "zk://localhost:42043/ledgers",
  "journalFormatVersionToWrite" : "5",
  "journalDirectories" : "/tmp/bookie1202613049352987084test",
  "gcWaitTime" : "1000",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "preserveMdcForTaskExecution" : "true",
  "readOnlyModeEnabled" : "true",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "entryLogFilePreallocationEnabled" : "false",
  "bookiePort" : "0",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "allowEphemeralPorts" : "true",
  "diskUsageWarnThreshold" : "0.99",
  "numReadWorkerThreads" : "0",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "allowLoopback" : "true",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "numAddWorkerThreads" : "0",
  "listeningInterface" : "lo",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "ledgerDirectories" : "/tmp/bookie1202613049352987084test"
}
21:32:45.629 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:45.631 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42043/ledgers : zkServers = localhost:42043, ledgersRootPath = /ledgers.
21:32:45.631 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42043 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@4d5d33a1
21:32:45.631 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:45.631 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:45.632 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42043.
21:32:45.632 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:45.632 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:49526, server: localhost/127.0.0.1:42043
21:32:45.633 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42043, session id = 0x100016f39b70004, negotiated timeout = 10000
21:32:45.633 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:45.635 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:45.639 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie1202613049352987084test/current] [/tmp/bookie1202613049352987084test/current]
21:32:45.643 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:45.644 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie1202613049352987084test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:45.644 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:45.644 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:45.644 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:45.645 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:45.645 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:45.645 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:45.649 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:37013 to become writable
21:32:45.649 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:45.649 [SyncThread-235-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:45.651 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:45.657 [BookieJournal-37013] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie1202613049352987084test/current
21:32:45.657 [BookieJournal-37013] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie1202613049352987084test/current/17ce3a4435a.txn
21:32:45.658 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:45.661 [BookieDeathWatcher-40241] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:45.662 [BookieDeathWatcher-40241] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-40241
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:45.662 [BookieDeathWatcher-40241] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:45.662 [BookieDeathWatcher-40241] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:45.663 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:37013 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:37013, port=37013, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:45.664 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:37013
21:32:45.914 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:37013' has been created.
21:32:45.915 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testAddFailsWithReadOnlyBookie @ metadata service zk://localhost:42043/ledgers in 918 ms.
21:32:45.916 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42043/ledgers : zkServers = localhost:42043, ledgersRootPath = /ledgers.
21:32:45.916 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:42043 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@3300f64b
21:32:45.917 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:45.917 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:45.917 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:42043.
21:32:45.917 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:45.918 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:49528, server: localhost/127.0.0.1:42043
21:32:45.919 [Time-limited test-SendThread(localhost:42043)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:42043, session id = 0x100016f39b70005, negotiated timeout = 10000
21:32:45.919 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:45.920 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:45.921 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
21:32:45.921 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
21:32:45.921 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
21:32:45.922 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:42227 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:42227, port=42227, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:45.922 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:37013 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:37013, port=37013, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:45.922 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:36401 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:36401, port=36401, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:45.923 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:36401
21:32:45.923 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:42227
21:32:45.923 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:37013
21:32:45.923 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
21:32:45.924 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:36401, 127.0.0.1:42227, 127.0.0.1:37013] is not adhering to Placement Policy. quarantinedBookies: []
21:32:45.935 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:36401, 127.0.0.1:42227, 127.0.0.1:37013] for ledger: 0
21:32:45.938 [Time-limited test] WARN  org.apache.bookkeeper.bookie.LedgerDirsManager - /tmp/bookie2183439682623541810test/current is out of space. Adding it to filled dirs list
21:32:45.939 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Major Compaction triggered by thread: Time-limited test
21:32:45.939 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Minor Compaction triggered by thread: Time-limited test
21:32:45.939 [Time-limited test] WARN  org.apache.bookkeeper.bookie.LedgerDirsManager - /tmp/bookie9073703961323432916test/current is out of space. Adding it to filled dirs list
21:32:45.939 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Major Compaction triggered by thread: Time-limited test
21:32:45.939 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Minor Compaction triggered by thread: Time-limited test
21:32:45.939 [Time-limited test] WARN  org.apache.bookkeeper.bookie.LedgerDirsManager - /tmp/bookie1202613049352987084test/current is out of space. Adding it to filled dirs list
21:32:45.940 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Major Compaction triggered by thread: Time-limited test
21:32:45.940 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Suspend Minor Compaction triggered by thread: Time-limited test
21:32:45.945 [bookkeeper-io-241-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:36401 [id: 0x7f930244, L:/127.0.0.1:60178 - R:127.0.0.1/127.0.0.1:36401]
21:32:45.949 [bookkeeper-io-241-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:42227 [id: 0x6fd1ac7b, L:/127.0.0.1:34700 - R:127.0.0.1/127.0.0.1:42227]
21:32:45.950 [bookkeeper-io-241-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x6fd1ac7b, L:/127.0.0.1:34700 - R:127.0.0.1/127.0.0.1:42227] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:45.951 [bookkeeper-io-241-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x7f930244, L:/127.0.0.1:60178 - R:127.0.0.1/127.0.0.1:36401] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:45.953 [bookie-io-221-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:45.953 [bookkeeper-io-241-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:37013 [id: 0xcfea812e, L:/127.0.0.1:46336 - R:127.0.0.1/127.0.0.1:37013]
21:32:45.954 [bookie-io-221-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x7b64c096, L:/127.0.0.1:36401 - R:/127.0.0.1:60178]
21:32:45.956 [bookie-io-221-2] INFO  org.apache.bookkeeper.bookie.LedgerDirsManager - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/bookie9073703961323432916test/current]
21:32:45.961 [bookie-io-221-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:45.961 [bookie-io-221-2] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:45.964 [bookkeeper-io-241-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0xcfea812e, L:/127.0.0.1:46336 - R:127.0.0.1/127.0.0.1:37013] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:45.968 [BookieStateManagerService-0] INFO  org.apache.bookkeeper.bookie.BookieStateManager - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
21:32:45.970 [bookie-io-212-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:45.969 [bookie-io-221-2] ERROR org.apache.bookkeeper.proto.WriteEntryProcessorV3 - Error writing entry:0 to ledger:0
java.io.IOException: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1419) ~[classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) ~[classes/:?]
	... 34 more
21:32:45.970 [bookie-io-230-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:45.974 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Add for failed on bookie 127.0.0.1:36401 code EIO
21:32:45.979 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (0, 0): Write failed on bookie
21:32:45.980 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:37013>, <Bookie:127.0.0.1:36401>, <Bookie:127.0.0.1:42227>], allBookies [<Bookie:127.0.0.1:37013>, <Bookie:127.0.0.1:42227>, <Bookie:127.0.0.1:36401>].
21:32:45.981 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:37013>, <Bookie:127.0.0.1:42227>, <Bookie:127.0.0.1:36401>], fallback to choose bookie randomly from the cluster.
21:32:45.981 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:42227>, <Bookie:127.0.0.1:36401>, <Bookie:127.0.0.1:37013>], allBookies [<Bookie:127.0.0.1:36401>, <Bookie:127.0.0.1:42227>, <Bookie:127.0.0.1:37013>].
21:32:45.982 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:36401>, <Bookie:127.0.0.1:42227>, <Bookie:127.0.0.1:37013>], allBookies [<Bookie:127.0.0.1:42227>, <Bookie:127.0.0.1:37013>, <Bookie:127.0.0.1:36401>].
21:32:45.982 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:37013>, <Bookie:127.0.0.1:36401>, <Bookie:127.0.0.1:42227>], fallback to choose bookie randomly from the cluster.
21:32:45.982 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:37013>, <Bookie:127.0.0.1:36401>, <Bookie:127.0.0.1:42227>], allBookies [<Bookie:127.0.0.1:42227>, <Bookie:127.0.0.1:37013>, <Bookie:127.0.0.1:36401>].
21:32:45.983 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.MetadataUpdateLoop - UpdateLoop(ledgerId=0,loopId=60b93f53) Exception updating
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:780) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:698) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:587) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:206) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:547) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:227) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:475) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:120) ~[classes/:?]
	at org.apache.bookkeeper.client.BookieWatcherImpl.replaceBookie(BookieWatcherImpl.java:334) ~[classes/:?]
	at org.apache.bookkeeper.client.EnsembleUtils.replaceBookiesInEnsemble(EnsembleUtils.java:71) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.lambda$ensembleChangeLoop$2(LedgerHandle.java:1935) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.writeLoop(MetadataUpdateLoop.java:134) [classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.run(MetadataUpdateLoop.java:123) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.ensembleChangeLoop(LedgerHandle.java:1954) [classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.handleBookieFailure(LedgerHandle.java:1903) [classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:378) [classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.writeComplete(PerChannelBookieClient.java:2159) [classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.handleResponse(PerChannelBookieClient.java:2216) [classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.handleV3Response(PerChannelBookieClient.java:2205) [classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$3.safeRun(PerChannelBookieClient.java:1473) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:45.983 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.LedgerHandle - [EnsembleChange(ledger:0, change-id:0000000001)][attempt:1] Exception changing ensemble
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:780) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:698) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:587) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:206) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:547) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:227) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:475) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:120) ~[classes/:?]
	at org.apache.bookkeeper.client.BookieWatcherImpl.replaceBookie(BookieWatcherImpl.java:334) ~[classes/:?]
	at org.apache.bookkeeper.client.EnsembleUtils.replaceBookiesInEnsemble(EnsembleUtils.java:71) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.lambda$ensembleChangeLoop$2(LedgerHandle.java:1935) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.writeLoop(MetadataUpdateLoop.java:134) ~[classes/:?]
	at org.apache.bookkeeper.client.MetadataUpdateLoop.run(MetadataUpdateLoop.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.ensembleChangeLoop(LedgerHandle.java:1954) ~[classes/:?]
	at org.apache.bookkeeper.client.LedgerHandle.handleBookieFailure(LedgerHandle.java:1903) ~[classes/:?]
	at org.apache.bookkeeper.client.PendingAddOp.writeComplete(PendingAddOp.java:378) ~[classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.writeComplete(PerChannelBookieClient.java:2159) ~[classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.handleResponse(PerChannelBookieClient.java:2216) ~[classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$AddCompletion.handleV3Response(PerChannelBookieClient.java:2205) ~[classes/:?]
	at org.apache.bookkeeper.proto.PerChannelBookieClient$3.safeRun(PerChannelBookieClient.java:1473) ~[classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) ~[classes/:?]
	at org.apache.bookkeeper.common.util.OrderedExecutor$ContextPreservingRunnable.run(OrderedExecutor.java:260) [classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:45.984 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.LedgerHandle - Closing ledger 0 due to NotEnoughBookiesException: Not enough non-faulty bookies available
21:32:45.984 [bookie-io-230-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x53146459, L:/127.0.0.1:37013 - R:/127.0.0.1:46336]
21:32:45.973 [bookie-io-212-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x747bd558, L:/127.0.0.1:42227 - R:/127.0.0.1:34700]
21:32:45.973 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:36401
21:32:45.985 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L0 E0
21:32:45.973 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:36401
21:32:45.986 [bookie-io-230-2] INFO  org.apache.bookkeeper.bookie.LedgerDirsManager - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/bookie1202613049352987084test/current]
21:32:45.987 [bookie-io-212-2] INFO  org.apache.bookkeeper.bookie.LedgerDirsManager - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/bookie2183439682623541810test/current]
21:32:45.988 [bookie-io-230-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:45.988 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:36401
21:32:45.988 [bookie-io-212-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:45.988 [bookie-io-212-2] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:45.989 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:36401
21:32:45.989 [bookie-io-230-2] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) [classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) [classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) [classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) [classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:45.989 [BookieStateManagerService-0] INFO  org.apache.bookkeeper.bookie.BookieStateManager - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
21:32:45.989 [bookie-io-212-2] ERROR org.apache.bookkeeper.proto.WriteEntryProcessorV3 - Error writing entry:0 to ledger:0
java.io.IOException: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1419) ~[classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) ~[classes/:?]
	... 34 more
21:32:45.991 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Add for failed on bookie 127.0.0.1:42227 code EIO
21:32:45.991 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (0, 0): Write failed on bookie
21:32:45.991 [BookieStateManagerService-0] INFO  org.apache.bookkeeper.bookie.BookieStateManager - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
21:32:45.991 [bookie-io-230-2] ERROR org.apache.bookkeeper.proto.WriteEntryProcessorV3 - Error writing entry:0 to ledger:0
java.io.IOException: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1419) ~[classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.getAddResponse(WriteEntryProcessorV3.java:125) [classes/:?]
	at org.apache.bookkeeper.proto.WriteEntryProcessorV3.safeRun(WriteEntryProcessorV3.java:165) [classes/:?]
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processAddRequestV3(BookieRequestProcessor.java:434) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestProcessor.processRequest(BookieRequestProcessor.java:312) [classes/:?]
	at org.apache.bookkeeper.proto.BookieRequestHandler.channelRead(BookieRequestHandler.java:80) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:93) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.AuthHandler$ServerSideHandler.channelRead(AuthHandler.java:95) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at org.apache.bookkeeper.proto.BookieProtoEncoding$RequestDecoder.channelRead(BookieProtoEncoding.java:450) [classes/:?]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:324) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:296) [netty-codec-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919) [netty-transport-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:480) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:378) [netty-transport-native-epoll-4.1.68.Final-linux-x86_64.jar:4.1.68.Final]
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
Caused by: org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.selectDirForNextEntryLog(EntryLogManagerBase.java:175) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.createNewLog(EntryLogManagerBase.java:170) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.getCurrentLogForLedgerForAddEntry(EntryLogManagerForSingleEntryLog.java:95) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerBase.addEntry(EntryLogManagerBase.java:72) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogManagerForSingleEntryLog.addEntry(EntryLogManagerForSingleEntryLog.java:87) ~[classes/:?]
	at org.apache.bookkeeper.bookie.EntryLogger.addEntry(EntryLogger.java:626) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:534) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.processEntry(InterleavedLedgerStorage.java:521) ~[classes/:?]
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.addEntry(InterleavedLedgerStorage.java:375) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:156) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntryInternal(BookieImpl.java:1279) ~[classes/:?]
	at org.apache.bookkeeper.bookie.BookieImpl.addEntry(BookieImpl.java:1414) ~[classes/:?]
	... 34 more
21:32:45.993 [BookKeeperClientWorker-OrderedExecutor-0-0] ERROR org.apache.bookkeeper.proto.PerChannelBookieClient - Add for failed on bookie 127.0.0.1:37013 code EIO
21:32:45.993 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:37013
21:32:45.993 [BookKeeperClientWorker-OrderedExecutor-0-0] WARN  org.apache.bookkeeper.client.PendingAddOp - Failed to write entry (0, 0): Write failed on bookie
21:32:45.993 [bookkeeper-io-241-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0xcfea812e, L:/127.0.0.1:46336 ! R:127.0.0.1/127.0.0.1:37013]
21:32:45.997 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:42227
21:32:45.997 [bookkeeper-io-241-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x6fd1ac7b, L:/127.0.0.1:34700 ! R:127.0.0.1/127.0.0.1:42227]
21:32:45.997 [bookie-io-230-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x53146459, L:/127.0.0.1:37013 ! R:/127.0.0.1:46336]
21:32:46.000 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:36401
21:32:46.000 [bookie-io-212-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x747bd558, L:/127.0.0.1:42227 ! R:/127.0.0.1:34700]
21:32:46.001 [bookkeeper-io-241-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x7f930244, L:/127.0.0.1:60178 ! R:127.0.0.1/127.0.0.1:36401]
21:32:46.001 [bookie-io-221-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x7b64c096, L:/127.0.0.1:36401 ! R:/127.0.0.1:60178]
21:32:46.002 [Time-limited test-EventThread] WARN  org.apache.bookkeeper.discover.ZKRegistrationClient - Failed to schedule watch bookies task
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@37a9bed5 rejected from java.util.concurrent.ScheduledThreadPoolExecutor@72ab3644[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 9]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830) ~[?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326) ~[?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533) ~[?:1.8.0_292]
	at com.google.common.util.concurrent.MoreExecutors$ScheduledListeningDecorator.schedule(MoreExecutors.java:630) ~[guava-30.0-jre.jar:?]
	at org.apache.bookkeeper.common.util.BoundedScheduledExecutorService.schedule(BoundedScheduledExecutorService.java:63) ~[classes/:?]
	at org.apache.bookkeeper.common.util.OrderedScheduler$OrderedSchedulerDecoratedThread.schedule(OrderedScheduler.java:317) ~[classes/:?]
	at org.apache.bookkeeper.common.util.OrderedScheduler.schedule(OrderedScheduler.java:273) ~[classes/:?]
	at org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask.scheduleWatchTask(ZKRegistrationClient.java:115) [classes/:?]
	at org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask.process(ZKRegistrationClient.java:164) [classes/:?]
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:587) [zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:562) [zookeeper-3.6.2.jar:3.6.2]
21:32:46.006 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:42227
21:32:46.006 [Time-limited test-EventThread] WARN  org.apache.bookkeeper.discover.ZKRegistrationClient - Failed to schedule watch bookies task
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@41643949 rejected from java.util.concurrent.ScheduledThreadPoolExecutor@72ab3644[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 9]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2063) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:830) ~[?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326) ~[?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533) ~[?:1.8.0_292]
	at com.google.common.util.concurrent.MoreExecutors$ScheduledListeningDecorator.schedule(MoreExecutors.java:630) ~[guava-30.0-jre.jar:?]
	at org.apache.bookkeeper.common.util.BoundedScheduledExecutorService.schedule(BoundedScheduledExecutorService.java:63) ~[classes/:?]
	at org.apache.bookkeeper.common.util.OrderedScheduler$OrderedSchedulerDecoratedThread.schedule(OrderedScheduler.java:317) ~[classes/:?]
	at org.apache.bookkeeper.common.util.OrderedScheduler.schedule(OrderedScheduler.java:273) ~[classes/:?]
	at org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask.scheduleWatchTask(ZKRegistrationClient.java:115) [classes/:?]
	at org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask.process(ZKRegistrationClient.java:164) [classes/:?]
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:587) [zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:562) [zookeeper-3.6.2.jar:3.6.2]
21:32:46.006 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:42227
21:32:46.014 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:37013
21:32:46.014 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Invalidate cache for 127.0.0.1:37013
21:32:46.015 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:42227
21:32:46.016 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Removing a node: /default-rack/127.0.0.1:37013
21:32:46.016 [Time-limited test-SendThread(localhost:42043)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f39b70005.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f39b70005, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:46.016 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (readonly bookie) 127.0.0.1:36401 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:36401, port=36401, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:46.081 [GarbageCollectorThread-218-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Disk almost full, suspend major compaction to slow down filling disk.
21:32:46.082 [GarbageCollectorThread-218-1] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Disk full, suspend minor compaction to slow down filling disk.
21:32:46.116 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f39b70005 closed
21:32:46.117 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
21:32:46.117 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f39b70005
21:32:46.120 [Time-limited test-SendThread(localhost:42043)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f39b70001.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f39b70001, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:46.220 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f39b70001 closed
21:32:46.220 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f39b70001
21:32:46.220 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:46.220 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:46.221 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-42227 with exitCode 0
21:32:46.221 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:46.221 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:46.222 [SyncThread-217-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:46.222 [SyncThread-217-1] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:46.223 [SyncThread-217-1] ERROR org.apache.bookkeeper.bookie.SyncThread - Exception marking checkpoint as complete
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:46.227 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:46.227 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:46.227 [BookieJournal-42227] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:46.227 [BookieJournal-42227] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:46.227 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:46.227 [Bookie-42227] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:46.227 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:46.227 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:46.228 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:46.228 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:46.228 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:46.228 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:46.228 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:46.228 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:46.330 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f39b70002 closed
21:32:46.330 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:46.330 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:46.331 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f39b70002
21:32:46.335 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-36401 with exitCode 0
21:32:46.335 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:46.335 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:46.335 [SyncThread-226-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:46.336 [SyncThread-226-1] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:46.336 [SyncThread-226-1] ERROR org.apache.bookkeeper.bookie.SyncThread - Exception marking checkpoint as complete
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:46.336 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:46.336 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:46.336 [BookieJournal-36401] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:46.336 [BookieJournal-36401] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:46.338 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:46.338 [Bookie-36401] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:46.338 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:46.338 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:46.338 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:46.338 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:46.338 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:46.338 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:46.339 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:46.339 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:46.441 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f39b70003 closed
21:32:46.441 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:46.441 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:46.442 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f39b70003
21:32:46.444 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-37013 with exitCode 0
21:32:46.444 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:46.444 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:46.444 [SyncThread-235-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:46.444 [SyncThread-235-1] ERROR org.apache.bookkeeper.bookie.LedgerDirsManager - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:46.445 [SyncThread-235-1] ERROR org.apache.bookkeeper.bookie.SyncThread - Exception marking checkpoint as complete
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:203) ~[classes/:?]
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getWritableLedgerDirsForNewLog(LedgerDirsManager.java:179) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal$LastLogMark.rollLog(Journal.java:206) ~[classes/:?]
	at org.apache.bookkeeper.bookie.Journal.checkpointComplete(Journal.java:750) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.checkpointComplete(CheckpointSourceList.java:71) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList$CheckpointList.access$100(CheckpointSourceList.java:57) ~[classes/:?]
	at org.apache.bookkeeper.bookie.CheckpointSourceList.checkpointComplete(CheckpointSourceList.java:54) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.flush(SyncThread.java:137) ~[classes/:?]
	at org.apache.bookkeeper.bookie.SyncThread.lambda$requestFlush$1(SyncThread.java:111) ~[classes/:?]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_292]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180) [?:1.8.0_292]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_292]
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) [netty-common-4.1.68.Final.jar:4.1.68.Final]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:46.445 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:46.446 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:46.446 [BookieJournal-37013] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:46.446 [BookieJournal-37013] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:46.446 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:46.446 [Bookie-37013] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:46.447 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:46.447 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:46.447 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:46.447 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:46.447 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:46.447 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:46.447 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:46.447 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:46.450 [Time-limited test-SendThread(localhost:42043)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f39b70004.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f39b70004, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:46.550 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f39b70004 closed
21:32:46.551 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f39b70004
21:32:46.552 [Time-limited test-SendThread(localhost:42043)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f39b70000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f39b70000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:46.653 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f39b70000 closed
21:32:46.653 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f39b70000
21:32:46.653 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
21:32:46.654 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
21:32:46.654 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
21:32:46.654 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
21:32:46.654 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
21:32:46.654 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
21:32:46.654 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
21:32:46.655 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
21:32:46.655 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
21:32:46.655 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
21:32:46.655 [ProcessThread(sid:0 cport:42043):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
21:32:46.655 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
21:32:46.655 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
21:32:46.656 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 42043
21:32:46.657 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testAddFailsWithReadOnlyBookie in 540 ms.
21:32:46.659 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setting up test class org.apache.bookkeeper.client.MdcContextTest
21:32:46.659 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - zookeeper.snapshot.trust.empty : false
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.watch.WatchManagerFactory - Using org.apache.zookeeper.server.watch.WatchManager as watch manager
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.snapshotSizeFactor = 0.33
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - zookeeper.commitLogCount=500
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - minSessionTimeout set to 6000
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - maxSessionTimeout set to 60000
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.ResponseCache - Response cache size is initialized with value 400.
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotCapacity = 60
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.slotDuration = 15
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.maxDepth = 6
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.initialDelay = 5
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.delay = 5
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.util.RequestPathMetricsCollector - zookeeper.pathStats.enabled = false
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The max bytes for all large requests are set to 104857600
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - The large request threshold is set to -1
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 60000 clientPortListenBacklog -1 datadir /tmp/zookeeper4304741158263342346test/version-2 snapdir /tmp/zookeeper4304741158263342346test/version-2
21:32:46.660 [Time-limited test] WARN  org.apache.zookeeper.server.ServerCnxnFactory - maxCnxns is not configured, using default value 0.
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - Configuring NIO connection handler with 10s sessionless connection timeout, 1 selector thread(s), 4 worker threads, and 64 kB direct buffers.
21:32:46.660 [Time-limited test] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - binding to port /127.0.0.1:0
21:32:46.661 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper4304741158263342346test/version-2/snapshot.0
21:32:46.661 [Time-limited test] INFO  org.apache.zookeeper.server.ZKDatabase - Snapshot loaded in 1 ms, highest zxid is 0x0, digest is 1371985504
21:32:46.661 [Time-limited test] INFO  org.apache.zookeeper.server.persistence.FileTxnSnapLog - Snapshotting: 0x0 to /tmp/zookeeper4304741158263342346test/version-2/snapshot.0
21:32:46.661 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - Snapshot taken in 0 ms
21:32:46.665 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 36107
21:32:46.666 [ProcessThread(sid:0 cport:36107):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor (sid:0) started, reconfigEnabled=false
21:32:46.666 [BookieDeathWatcher-37013] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:46.666 [BookieDeathWatcher-37013] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37013
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:46.667 [BookieDeathWatcher-37013] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:46.667 [BookieDeathWatcher-37013] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:46.667 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.NIOServerCnxn - Processing stat command from /127.0.0.1:46642
21:32:46.667 [NIOWorkerThread-1] INFO  org.apache.zookeeper.server.command.AbstractFourLetterCommand - Stat command output
21:32:46.667 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:36107 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@2fd56f4
21:32:46.667 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:46.667 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:46.668 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:36107.
21:32:46.669 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:46.669 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:46644, server: localhost/127.0.0.1:36107
21:32:46.673 [SyncThread:0] INFO  org.apache.zookeeper.server.persistence.FileTxnLog - Creating new log file: log.1
21:32:46.676 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:36107, session id = 0x100016f402c0000, negotiated timeout = 10000
21:32:46.676 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:46.685 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36107/ledgers : zkServers = localhost:36107, ledgersRootPath = /ledgers.
21:32:46.685 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:36107 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@5f8fb66a
21:32:46.685 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:46.685 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:46.689 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:36107.
21:32:46.689 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:46.689 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:46646, server: localhost/127.0.0.1:36107
21:32:46.690 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:36107, session id = 0x100016f402c0001, negotiated timeout = 10000
21:32:46.690 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:46.691 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeperTestClient.<init>(BookKeeperTestClient.java:51) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.startBKCluster(BookKeeperClusterTestCase.java:247) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:160) [test-classes/:?]
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.setUp(BookKeeperClusterTestCase.java:145) [test-classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:104) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:46.691 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
21:32:46.691 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
21:32:46.691 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
21:32:46.694 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:46.694 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "numReadWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "allowEphemeralPorts" : "true",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "gcWaitTime" : "1000",
  "bookiePort" : "0",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "allowLoopback" : "true",
  "preserveMdcForTaskExecution" : "true",
  "ledgerDirectories" : "/tmp/bookie7182991116424320566test",
  "enableTaskExecutionStats" : "true",
  "numAddWorkerThreads" : "0",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "listeningInterface" : "lo",
  "journalDirectories" : "/tmp/bookie7182991116424320566test",
  "entryLogFilePreallocationEnabled" : "false",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "readOnlyModeEnabled" : "true",
  "diskUsageWarnThreshold" : "0.99",
  "metadataServiceUri" : "zk://localhost:36107/ledgers"
}
21:32:46.696 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:46.697 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36107/ledgers : zkServers = localhost:36107, ledgersRootPath = /ledgers.
21:32:46.697 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:36107 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@72006ef4
21:32:46.697 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:46.697 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:46.697 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:36107.
21:32:46.697 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:46.697 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:46648, server: localhost/127.0.0.1:36107
21:32:46.699 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:36107, session id = 0x100016f402c0002, negotiated timeout = 10000
21:32:46.699 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:46.700 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:46.703 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie7182991116424320566test/current] [/tmp/bookie7182991116424320566test/current]
21:32:46.708 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:46.708 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie7182991116424320566test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:46.708 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:46.709 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:46.709 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:46.709 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:46.709 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:46.709 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:46.717 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:33033 to become writable
21:32:46.717 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:46.717 [SyncThread-256-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:46.719 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:46.721 [BookieJournal-33033] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie7182991116424320566test/current
21:32:46.721 [BookieJournal-33033] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie7182991116424320566test/current/17ce3a44782.txn
21:32:46.722 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:46.728 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:33033 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:33033, port=33033, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:46.729 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:33033
21:32:46.978 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:33033' has been created.
21:32:46.979 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:46.980 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "listeningInterface" : "lo",
  "entryLogFilePreallocationEnabled" : "false",
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "numReadWorkerThreads" : "0",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "journalDirectories" : "/tmp/bookie5611298540014620053test",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "readOnlyModeEnabled" : "true",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie5611298540014620053test",
  "enableTaskExecutionStats" : "true",
  "allowLoopback" : "true",
  "diskUsageThreshold" : "0.999",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "journalFormatVersionToWrite" : "5",
  "gcWaitTime" : "1000",
  "journalFlushWhenQueueEmpty" : "true",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "bookiePort" : "0",
  "preserveMdcForTaskExecution" : "true",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "numAddWorkerThreads" : "0",
  "metadataServiceUri" : "zk://localhost:36107/ledgers"
}
21:32:46.981 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:46.982 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36107/ledgers : zkServers = localhost:36107, ledgersRootPath = /ledgers.
21:32:46.982 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:36107 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@7d53cd4b
21:32:46.982 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:46.982 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:46.984 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:36107.
21:32:46.984 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:46.985 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:46650, server: localhost/127.0.0.1:36107
21:32:46.986 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:36107, session id = 0x100016f402c0003, negotiated timeout = 10000
21:32:46.986 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:46.988 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:46.990 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie5611298540014620053test/current] [/tmp/bookie5611298540014620053test/current]
21:32:46.994 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:46.996 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie5611298540014620053test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:46.996 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:46.996 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:46.996 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:46.997 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:46.997 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:46.997 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:47.001 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:35093 to become writable
21:32:47.002 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:47.002 [SyncThread-265-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:47.004 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:47.008 [BookieJournal-35093] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie5611298540014620053test/current
21:32:47.009 [BookieJournal-35093] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie5611298540014620053test/current/17ce3a448a2.txn
21:32:47.009 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:47.023 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:35093 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:35093, port=35093, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:47.023 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:35093
21:32:47.089 [BookieDeathWatcher-42227] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:47.089 [BookieDeathWatcher-42227] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-42227
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:47.089 [BookieDeathWatcher-42227] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:47.089 [BookieDeathWatcher-42227] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:47.272 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:35093' has been created.
21:32:47.273 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Starting new bookie on port: 0
21:32:47.274 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - {
  "gcWaitTime" : "1000",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "entryLogFilePreallocationEnabled" : "false",
  "bookiePort" : "0",
  "listeningInterface" : "lo",
  "journalDirectories" : "/tmp/bookie5049736963559412619test",
  "diskUsageThreshold" : "0.999",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "allowLoopback" : "true",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "journalFormatVersionToWrite" : "5",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "preserveMdcForTaskExecution" : "true",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "9223372036854775807",
  "tlsEnabledProtocols" : "[TLSv1.2, TLSv1.1]",
  "ledgerDirectories" : "/tmp/bookie5049736963559412619test",
  "numAddWorkerThreads" : "0",
  "journalFlushWhenQueueEmpty" : "true",
  "diskUsageWarnThreshold" : "0.99",
  "metadataServiceUri" : "zk://localhost:36107/ledgers",
  "numReadWorkerThreads" : "0",
  "readOnlyModeEnabled" : "true",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "enableTaskExecutionStats" : "true"
}
21:32:47.276 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Binding bookie-rpc endpoint to /127.0.0.1:0
21:32:47.277 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36107/ledgers : zkServers = localhost:36107, ledgersRootPath = /ledgers.
21:32:47.277 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:36107 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@433d70fc
21:32:47.277 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:47.277 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:47.278 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:36107.
21:32:47.278 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:47.279 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:46652, server: localhost/127.0.0.1:36107
21:32:47.280 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:36107, session id = 0x100016f402c0004, negotiated timeout = 10000
21:32:47.281 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:47.282 [Time-limited test] INFO  org.apache.bookkeeper.discover.ZKRegistrationManager - INSTANCEID not exists in zookeeper. Not considering it for data verification
21:32:47.284 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Stamping new cookies on all dirs [/tmp/bookie5049736963559412619test/current] [/tmp/bookie5049736963559412619test/current]
21:32:47.287 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
21:32:47.288 [Time-limited test] ERROR org.apache.bookkeeper.bookie.Journal - Problems reading from /tmp/bookie5049736963559412619test/current/lastMark (this is okay if it is the first time starting this bookie
21:32:47.288 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
21:32:47.288 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexPersistenceMgr - openFileLimit = 20000
21:32:47.288 [Time-limited test] INFO  org.apache.bookkeeper.bookie.IndexInMemPageMgr - maxDirectMemory = 1908932608, pageSize = 8192, pageLimit = 77674
21:32:47.289 [Time-limited test] INFO  org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector - Over Replicated Ledger Deletion : enabled=true, interval=86400000
21:32:47.289 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
21:32:47.289 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
21:32:47.300 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeperTestClient - Wait for 127.0.0.1:32813 to become writable
21:32:47.300 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished replaying journal in 0 ms.
21:32:47.301 [SyncThread-274-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
21:32:47.302 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Finished reading journal, starting bookie
21:32:47.307 [BookieJournal-32813] INFO  org.apache.bookkeeper.bookie.Journal - Starting journal on /tmp/bookie5049736963559412619test/current
21:32:47.313 [BookieJournal-32813] INFO  org.apache.bookkeeper.bookie.JournalChannel - Opening journal /tmp/bookie5049736963559412619test/current/17ce3a449ce.txn
21:32:47.313 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite Thread started
21:32:47.324 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:32813 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:32813, port=32813, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:47.325 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:32813
21:32:47.376 [BookieDeathWatcher-36401] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:47.376 [BookieDeathWatcher-36401] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-36401
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:47.377 [BookieDeathWatcher-36401] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:47.377 [BookieDeathWatcher-36401] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:47.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
21:32:47.521 [SessionTracker] INFO  org.apache.zookeeper.server.SessionTrackerImpl - SessionTrackerImpl exited loop!
21:32:47.574 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - New bookie '127.0.0.1:32813' has been created.
21:32:47.574 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Setup testcase testAddFailsDuplicateEntry @ metadata service zk://localhost:36107/ledgers in 915 ms.
21:32:47.577 [Time-limited test] INFO  org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36107/ledgers : zkServers = localhost:36107, ledgersRootPath = /ledgers.
21:32:47.577 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:36107 sessionTimeout=10000 watcher=org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase@711f22ee
21:32:47.577 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes
21:32:47.577 [Time-limited test] INFO  org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false
21:32:47.581 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Opening socket connection to server localhost/127.0.0.1:36107.
21:32:47.581 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - SASL config status: Will not attempt to authenticate using SASL (unknown error)
21:32:47.581 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Socket connection established, initiating session, client: /127.0.0.1:46654, server: localhost/127.0.0.1:36107
21:32:47.583 [Time-limited test-SendThread(localhost:36107)] INFO  org.apache.zookeeper.ClientCnxn - Session establishment complete on server localhost/127.0.0.1:36107, session id = 0x100016f402c0005, negotiated timeout = 10000
21:32:47.583 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase - ZooKeeper client is connected now.
21:32:47.584 [Time-limited test] ERROR org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver 
java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
	at org.apache.bookkeeper.net.ScriptBasedMapping$RawScriptBasedMapping.validateConf(ScriptBasedMapping.java:163) ~[classes/:?]
	at org.apache.bookkeeper.net.AbstractDNSToSwitchMapping.setConf(AbstractDNSToSwitchMapping.java:81) ~[classes/:?]
	at org.apache.bookkeeper.net.ScriptBasedMapping.setConf(ScriptBasedMapping.java:123) ~[classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:265) [classes/:?]
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.initialize(RackawareEnsemblePlacementPolicyImpl.java:80) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.initializeEnsemblePlacementPolicy(BookKeeper.java:581) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:505) [classes/:?]
	at org.apache.bookkeeper.client.BookKeeper.<init>(BookKeeper.java:344) [classes/:?]
	at org.apache.bookkeeper.client.MdcContextTest.setUp(MdcContextTest.java:111) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_292]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_292]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_292]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_292]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.12.jar:4.12]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298) [junit-4.12.jar:4.12]
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292) [junit-4.12.jar:4.12]
	at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:47.585 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
21:32:47.585 [Time-limited test] INFO  org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl - Not weighted
21:32:47.585 [Time-limited test] INFO  org.apache.bookkeeper.client.BookKeeper - Weighted ledger placement is not enabled
21:32:47.590 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:33033 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:33033, port=33033, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:47.590 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:32813 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:32813, port=32813, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:47.590 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.discover.ZKRegistrationClient - Update BookieInfoCache (writable bookie) 127.0.0.1:35093 -> BookieServiceInfo{properties={}, endpoints=[EndpointInfo{id=127.0.0.1:35093, port=35093, host=127.0.0.1, protocol=bookie-rpc, auth=[], extensions=[]}]}
21:32:47.590 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:33033
21:32:47.590 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:35093
21:32:47.590 [BookKeeperClientScheduler-OrderedScheduler-0-0] INFO  org.apache.bookkeeper.net.NetworkTopologyImpl - Adding a new node: /default-rack/127.0.0.1:32813
21:32:47.591 [Time-limited test] INFO  org.apache.bookkeeper.client.MdcContextTest - creating ledger
21:32:47.591 [Time-limited test] WARN  org.apache.bookkeeper.client.BookieWatcherImpl - New ensemble: [127.0.0.1:32813, 127.0.0.1:33033, 127.0.0.1:35093] is not adhering to Placement Policy. quarantinedBookies: []
21:32:47.602 [Time-limited test-EventThread] INFO  org.apache.bookkeeper.client.LedgerCreateOp - Ensemble: [127.0.0.1:32813, 127.0.0.1:33033, 127.0.0.1:35093] for ledger: 0
21:32:47.610 [bookkeeper-io-280-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:32813 [id: 0x18e5be76, L:/127.0.0.1:41860 - R:127.0.0.1/127.0.0.1:32813]
21:32:47.613 [bookkeeper-io-280-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x18e5be76, L:/127.0.0.1:41860 - R:127.0.0.1/127.0.0.1:32813] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:47.615 [bookie-io-260-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:47.615 [bookie-io-269-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:47.617 [bookie-io-251-2] INFO  org.apache.bookkeeper.proto.AuthHandler - Authentication success on server side
21:32:47.621 [bookie-io-260-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xd6e3cd50, L:/127.0.0.1:35093 - R:/127.0.0.1:40334]
21:32:47.621 [bookkeeper-io-280-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:35093 [id: 0x38ef8f15, L:/127.0.0.1:40334 - R:127.0.0.1/127.0.0.1:35093]
21:32:47.622 [bookie-io-269-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0x662ad858, L:/127.0.0.1:32813 - R:/127.0.0.1:41860]
21:32:47.623 [bookie-io-251-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channel connected  [id: 0xc2c46ee0, L:/127.0.0.1:33033 - R:/127.0.0.1:48456]
21:32:47.625 [bookkeeper-io-280-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Successfully connected to bookie: 127.0.0.1:33033 [id: 0x979529d6, L:/127.0.0.1:48456 - R:127.0.0.1/127.0.0.1:33033]
21:32:47.626 [bookkeeper-io-280-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x979529d6, L:/127.0.0.1:48456 - R:127.0.0.1/127.0.0.1:33033] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:47.626 [bookie-io-269-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:47.626 [bookkeeper-io-280-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - connection [id: 0x38ef8f15, L:/127.0.0.1:40334 - R:127.0.0.1/127.0.0.1:35093] authenticated as BookKeeperPrincipal{ANONYMOUS}
21:32:47.627 [bookie-io-269-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie5049736963559412619test/current/0.log for logId 0.
21:32:47.627 [bookie-io-251-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:47.627 [bookie-io-260-2] INFO  org.apache.bookkeeper.bookie.EntryLogManagerBase - Creating a new entry log file because current active log channel has not initialized yet
21:32:47.628 [bookie-io-251-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie7182991116424320566test/current/0.log for logId 0.
21:32:47.628 [bookie-io-260-2] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Created new entry log file /tmp/bookie5611298540014620053test/current/0.log for logId 0.
21:32:47.648 [Time-limited test] ERROR org.apache.bookkeeper.client.LedgerHandleAdv - Trying to re-add duplicate entryid:0
21:32:47.648 [Time-limited test] ERROR org.apache.bookkeeper.client.PendingAddOp - Write of ledger entry to quorum failed: L0 E0
21:32:47.650 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:32813
21:32:47.651 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:33033
21:32:47.651 [bookkeeper-io-280-1] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x18e5be76, L:/127.0.0.1:41860 ! R:127.0.0.1/127.0.0.1:32813]
21:32:47.651 [bookie-io-269-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0x662ad858, L:/127.0.0.1:32813 ! R:/127.0.0.1:41860]
21:32:47.651 [bookkeeper-io-280-2] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x979529d6, L:/127.0.0.1:48456 ! R:127.0.0.1/127.0.0.1:33033]
21:32:47.651 [bookie-io-251-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xc2c46ee0, L:/127.0.0.1:33033 ! R:/127.0.0.1:48456]
21:32:47.651 [Time-limited test] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Closing the per channel bookie client for 127.0.0.1:35093
21:32:47.652 [bookkeeper-io-280-3] INFO  org.apache.bookkeeper.proto.PerChannelBookieClient - Disconnected from bookie channel [id: 0x38ef8f15, L:/127.0.0.1:40334 ! R:127.0.0.1/127.0.0.1:35093]
21:32:47.655 [bookie-io-260-2] INFO  org.apache.bookkeeper.proto.BookieRequestHandler - Channels disconnected: [id: 0xd6e3cd50, L:/127.0.0.1:35093 ! R:/127.0.0.1:40334]
21:32:47.757 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f402c0005 closed
21:32:47.758 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - TearDown
21:32:47.758 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f402c0005
21:32:47.760 [Time-limited test-SendThread(localhost:36107)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f402c0001.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f402c0001, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:47.861 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f402c0001 closed
21:32:47.861 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:47.861 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:47.861 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f402c0001
21:32:47.862 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-33033 with exitCode 0
21:32:47.862 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:47.862 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:47.874 [SyncThread-256-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635906766722 , logFileOffset - 1024]}.
21:32:47.883 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:47.883 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:47.883 [BookieJournal-33033] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:47.883 [BookieJournal-33033] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:47.883 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:47.884 [Bookie-33033] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:47.884 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:47.884 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:47.884 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:47.884 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:47.884 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:47.884 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:47.885 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:47.885 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:47.885 [pool-180-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-180-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:47.892 [Time-limited test-SendThread(localhost:36107)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f402c0002.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f402c0002, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:47.992 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f402c0002 closed
21:32:47.992 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f402c0002
21:32:47.992 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:47.992 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:47.994 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-35093 with exitCode 0
21:32:47.994 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:47.994 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:48.007 [SyncThread-265-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635906767010 , logFileOffset - 1536]}.
21:32:48.016 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:48.016 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:48.016 [BookieJournal-35093] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:48.017 [BookieJournal-35093] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:48.017 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:48.017 [Bookie-35093] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:48.017 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:48.017 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:48.017 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:48.017 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:48.017 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:48.017 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:48.018 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:48.018 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:48.018 [pool-186-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-186-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:48.125 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f402c0003 closed
21:32:48.125 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:48.125 [Time-limited test] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:48.126 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f402c0003
21:32:48.127 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Shutting down Bookie-32813 with exitCode 0
21:32:48.127 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Bookie - Turning bookie to read only during shut down
21:32:48.127 [Time-limited test] INFO  org.apache.bookkeeper.bookie.SyncThread - Shutting down SyncThread
21:32:48.138 [SyncThread-274-1] INFO  org.apache.bookkeeper.bookie.SyncThread - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1635906767310 , logFileOffset - 1024]}.
21:32:48.147 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Shutting down Journal
21:32:48.147 [ForceWriteThread] INFO  org.apache.bookkeeper.bookie.Journal - ForceWrite thread interrupted
21:32:48.147 [BookieJournal-32813] INFO  org.apache.bookkeeper.bookie.Journal - Journal exits when shutting down
21:32:48.147 [BookieJournal-32813] INFO  org.apache.bookkeeper.bookie.Journal - Journal exited loop!
21:32:48.147 [Time-limited test] INFO  org.apache.bookkeeper.bookie.Journal - Finished Shutting down Journal thread
21:32:48.147 [Bookie-32813] INFO  org.apache.bookkeeper.bookie.Bookie - Journal thread(s) quit.
21:32:48.148 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down InterleavedLedgerStorage
21:32:48.148 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down GC thread
21:32:48.148 [Time-limited test] INFO  org.apache.bookkeeper.bookie.GarbageCollectorThread - Shutting down GarbageCollectorThread
21:32:48.148 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Shutting down entry logger
21:32:48.148 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLogger - Stopping EntryLogger
21:32:48.148 [Time-limited test] INFO  org.apache.bookkeeper.bookie.EntryLoggerAllocator - Stopped entry logger preallocator.
21:32:48.149 [Time-limited test] INFO  org.apache.bookkeeper.bookie.InterleavedLedgerStorage - Complete shutting down Ledger Storage
21:32:48.149 [Time-limited test] INFO  org.apache.bookkeeper.bookie.LedgerDirsMonitor - Shutting down LedgerDirsMonitor
21:32:48.150 [pool-192-thread-1] ERROR org.apache.zookeeper.server.NIOServerCnxnFactory - Thread Thread[pool-192-thread-1,5,FailOnTimeoutGroup] died
java.lang.NullPointerException: null
	at org.apache.bookkeeper.bookie.EntryLoggerAllocator.closePreAllocateLog(EntryLoggerAllocator.java:191) ~[classes/:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_292]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_292]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_292]
21:32:48.156 [Time-limited test-SendThread(localhost:36107)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f402c0004.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f402c0004, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:48.256 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f402c0004 closed
21:32:48.257 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f402c0004
21:32:48.259 [Time-limited test-SendThread(localhost:36107)] WARN  org.apache.zookeeper.ClientCnxn - An exception was thrown while closing send thread for session 0x100016f402c0000.
org.apache.zookeeper.ClientCnxn$EndOfStreamException: Unable to read additional data from server sessionid 0x100016f402c0000, likely server has closed socket
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:77) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350) ~[zookeeper-3.6.2.jar:3.6.2]
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1275) [zookeeper-3.6.2.jar:3.6.2]
21:32:48.324 [BookieDeathWatcher-32813] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
21:32:48.324 [BookieDeathWatcher-32813] INFO  org.apache.bookkeeper.proto.BookieServer - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-32813
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:304) ~[classes/:?]
21:32:48.325 [BookieDeathWatcher-32813] INFO  org.apache.bookkeeper.proto.BookieServer - Shutting down BookieServer
21:32:48.325 [BookieDeathWatcher-32813] INFO  org.apache.bookkeeper.proto.BookieNettyServer - Shutting down BookieNettyServer
21:32:48.359 [Time-limited test] INFO  org.apache.zookeeper.ZooKeeper - Session: 0x100016f402c0000 closed
21:32:48.360 [Time-limited test-EventThread] INFO  org.apache.zookeeper.ClientCnxn - EventThread shut down for session: 0x100016f402c0000
21:32:48.360 [ConnnectionExpirer] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - ConnnectionExpirerThread interrupted
21:32:48.361 [NIOServerCxnFactory.SelectorThread-0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - selector thread exitted run method
21:32:48.361 [NIOServerCxnFactory.AcceptThread:/127.0.0.1:0] INFO  org.apache.zookeeper.server.NIOServerCnxnFactory - accept thread exitted run method
21:32:48.361 [Time-limited test] INFO  org.apache.zookeeper.server.ZooKeeperServer - shutting down
21:32:48.361 [Time-limited test] INFO  org.apache.zookeeper.server.RequestThrottler - Shutting down
21:32:48.361 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - Draining request throttler queue
21:32:48.361 [RequestThrottler] INFO  org.apache.zookeeper.server.RequestThrottler - RequestThrottler shutdown. Dropped 0 requests
21:32:48.361 [Time-limited test] INFO  org.apache.zookeeper.server.SessionTrackerImpl - Shutting down
21:32:48.361 [Time-limited test] INFO  org.apache.zookeeper.server.PrepRequestProcessor - Shutting down
21:32:48.361 [Time-limited test] INFO  org.apache.zookeeper.server.SyncRequestProcessor - Shutting down
21:32:48.361 [ProcessThread(sid:0 cport:36107):] INFO  org.apache.zookeeper.server.PrepRequestProcessor - PrepRequestProcessor exited loop!
21:32:48.361 [SyncThread:0] INFO  org.apache.zookeeper.server.SyncRequestProcessor - SyncRequestProcessor exited!
21:32:48.361 [Time-limited test] INFO  org.apache.zookeeper.server.FinalRequestProcessor - shutdown of request processor complete
21:32:48.362 [Time-limited test] INFO  org.apache.zookeeper.client.FourLetterWordMain - connecting to localhost 36107
21:32:48.364 [Time-limited test] INFO  org.apache.bookkeeper.test.BookKeeperClusterTestCase - Tearing down test testAddFailsDuplicateEntry in 606 ms.
